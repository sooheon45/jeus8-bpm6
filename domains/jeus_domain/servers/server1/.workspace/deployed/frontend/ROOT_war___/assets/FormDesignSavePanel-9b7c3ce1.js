import{_ as D,r as S,o as c,c as w,b as n,w as r,a as P,F as g,i as x,e as b,W as v,bl as p,E as V,V as C,D as k,aS as A,ao as E,d as h,t as T,Q as K,au as j,U as F,cX as J,c7 as G,bc as Q,bd as X,a_ as O,a$ as Z,j as Y,n as N,l as ee,p as H,bf as W,h as te,m as I,f as L,R as oe,a2 as ne,az as ie,s as ae,ay as q,cY as B,bb as le,X as z,bg as re,bh as se,b7 as de}from"./index-7b37f28a.js";import{V as U}from"./VSheet-beabeb52.js";import{C as ue,U as me,T as ce,B as pe,L as he,F as fe,R as ye,f as Te,S as ve,h as we}from"./DynamicForm-9e8c830e.js";const Ce={name:"FormDefinitionPanelItemTable",props:{modelValue:Array},data(){return{localModelValue:this.modelValue,keyToAdd:"",valueToAdd:"",itemIndexToEdit:-1,keyToEdit:"",valueToEdit:"",placeholder:{valueToAdd:"",valueToEdit:""},regexStr:/^[가-힣a-zA-Z0-9_\-. ]+$/,regexErrorMsg:"'{{propName}}'은 한글, 영문, 숫자, 공백, 밑줄(_), 대시(-), 점(.) 만 입력 가능합니다!"}},watch:{modelValue:{handler(){this.localModelValue=this.modelValue},deep:!0,immediate:!0},localModelValue:{handler(){this.$emit("update:modelValue",this.localModelValue)},deep:!0,immediate:!0}},methods:{addItem(){if(!this.keyToAdd||this.keyToAdd.length<=0){alert("Key is required"),this.$refs.inputKeyToAddItem.focus();return}if(!this.regexStr.test(this.keyToAdd)){alert(this.regexErrorMsg.replace("{{propName}}","Key")),this.$refs.inputKeyToAddItem.focus();return}if(this.localModelValue.some(e=>e.hasOwnProperty(this.keyToAdd))){alert("Key already exists"),this.$refs.inputKeyToAddItem.focus();return}if(this.valueToAdd&&this.valueToAdd.length>0&&!this.regexStr.test(this.valueToAdd)){alert(this.regexErrorMsg.replace("{{propName}}","Value")),this.$refs.inputValueToAddItem.focus();return}(!this.valueToAdd||this.valueToAdd.length<=0)&&(this.valueToAdd=this.keyToAdd),this.localModelValue.push({[this.keyToAdd]:this.valueToAdd}),this.keyToAdd="",this.valueToAdd="",this.placeholder.valueToAdd="",this.$nextTick(()=>{this.$refs.inputKeyToAddItem.focus()})},editItem(e){if(!this.keyToEdit||this.keyToEdit.length<=0){alert("Key is required"),this.$refs.inputKeyToEditItem[0].focus();return}if(!this.regexStr.test(this.keyToEdit)){alert(this.regexErrorMsg.replace("{{propName}}","Key")),this.$refs.inputKeyToEditItem[0].focus();return}if(!this.localModelValue[e].hasOwnProperty(this.keyToEdit)&&this.localModelValue.some(t=>t.hasOwnProperty(this.keyToEdit))){alert("Key already exists"),this.$refs.inputKeyToEditItem[0].focus();return}if(this.valueToEdit&&this.valueToEdit.length>0&&!this.regexStr.test(this.valueToEdit)){alert(this.regexErrorMsg.replace("{{propName}}","Value")),this.$refs.inputValueToEditItem[0].focus();return}(!this.valueToEdit||this.valueToEdit.length<=0)&&(this.valueToEdit=this.keyToEdit),this.localModelValue.splice(e,1,{[this.keyToEdit]:this.valueToEdit}),this.itemIndexToEdit=-1,this.keyToEdit="",this.valueToEdit="",this.placeholder.valueToEdit=""},deleteItem(e){this.localModelValue.splice(e,1)},onInputKeyToAdd(){this.placeholder.valueToAdd=this.keyToAdd},onInputKeyToEdit(){this.placeholder.valueToEdit=this.keyToEdit}}},be={style:{"max-height":"200px","overflow-y":"auto","overflow-x":"hidden"}},ge=h("mdi-close"),Se=h("mdi-plus");function Ve(e,t,l,s,o,i){const d=S("PencilIcon"),m=S("TrashIcon");return c(),w("div",null,[n(j,{class:"pa-0 ma-0"},{default:r(()=>[P("div",be,[(c(!0),w(g,null,x(o.localModelValue,(a,f)=>(c(),b(K,{key:f,class:"pa-0 ma-0"},{default:r(()=>[(c(!0),w(g,null,x(a,(u,_)=>(c(),w(g,{key:_},[f===o.itemIndexToEdit?(c(),w(g,{key:0},[n(v,{ref_for:!0,ref:"inputKeyToEditItem",class:"centered-input",label:"Key",modelValue:o.keyToEdit,"onUpdate:modelValue":t[0]||(t[0]=y=>o.keyToEdit=y),modelModifiers:{trim:!0},rules:[y=>!!y||"Key is required"],required:"",onKeyup:p(y=>i.editItem(f),["enter"]),onInput:i.onInputKeyToEdit,"persistent-placeholder":""},null,8,["modelValue","rules","onKeyup","onInput"]),n(v,{ref_for:!0,ref:"inputValueToEditItem",class:"centered-input",label:"Value",modelValue:o.valueToEdit,"onUpdate:modelValue":t[1]||(t[1]=y=>o.valueToEdit=y),modelModifiers:{trim:!0},onKeyup:p(y=>i.editItem(f),["enter"]),placeholder:o.placeholder.valueToEdit,"persistent-placeholder":""},null,8,["modelValue","onKeyup","placeholder"]),n(U,{class:"pb-5"},{default:r(()=>[n(V,{text:e.$t("uiDefinition.cancel")},{activator:r(({props:y})=>[n(C,k({icon:"",flat:"",onClick:t[2]||(t[2]=M=>o.itemIndexToEdit=-1)},y),{default:r(()=>[n(A,{style:{color:"red"}},{default:r(()=>[ge]),_:1})]),_:2},1040)]),_:1},8,["text"])]),_:1}),n(U,{class:"pb-5"},{default:r(()=>[n(V,{text:e.$t("uiDefinition.edit")},{activator:r(({props:y})=>[n(C,k({icon:"",flat:"",onClick:M=>i.editItem(f)},y),{default:r(()=>[n(d,{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])]),_:2},1024)],64)):(c(),w(g,{key:1},[n(E,{cols:"5",class:"d-flex align-center justify-center pa-0"},{default:r(()=>[h(T(_),1)]),_:2},1024),n(E,{cols:"5",class:"d-flex align-center justify-center pa-0"},{default:r(()=>[h(T(u),1)]),_:2},1024),n(E,{cols:"2",class:"d-flex align-center justify-center pa-0"},{default:r(()=>[n(U,null,{default:r(()=>[n(V,{text:e.$t("uiDefinition.edit")},{activator:r(({props:y})=>[n(C,k({icon:"",flat:"",onClick:M=>{o.itemIndexToEdit=f,o.keyToEdit=_,o.valueToEdit=u,o.placeholder.valueToEdit=_}},y),{default:r(()=>[n(d,{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])]),_:2},1024),n(U,null,{default:r(()=>[n(V,{text:e.$t("uiDefinition.delete")},{activator:r(({props:y})=>[n(C,k({icon:"",flat:"",onClick:M=>i.deleteItem(f)},y),{default:r(()=>[n(m,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])]),_:2},1024)]),_:2},1024)],64))],64))),128))]),_:2},1024))),128))]),n(K,{class:"ma-0 pa-0 mt-4"},{default:r(()=>[n(v,{ref:"inputKeyToAddItem",class:"centered-input",label:"Key",modelValue:o.keyToAdd,"onUpdate:modelValue":t[3]||(t[3]=a=>o.keyToAdd=a),modelModifiers:{trim:!0},onKeyup:p(i.addItem,["enter"]),onInput:i.onInputKeyToAdd,"persistent-placeholder":""},null,8,["modelValue","onKeyup","onInput"]),n(v,{ref:"inputValueToAddItem",class:"centered-input",label:"Value",modelValue:o.valueToAdd,"onUpdate:modelValue":t[4]||(t[4]=a=>o.valueToAdd=a),modelModifiers:{trim:!0},onKeyup:p(i.addItem,["enter"]),placeholder:o.placeholder.valueToAdd,"persistent-placeholder":""},null,8,["modelValue","onKeyup","placeholder"]),n(U,null,{default:r(()=>[n(V,{text:e.$t("uiDefinition.add")},{activator:r(({props:a})=>[n(C,k({icon:"",flat:"",onClick:i.addItem},a),{default:r(()=>[n(A,{size:"33"},{default:r(()=>[Se]),_:1})]),_:2},1040,["onClick"])]),_:1},8,["text"])]),_:1})]),_:1})]),_:1})])}const ke=D(Ce,[["render",Ve]]),Ue={name:"form-definition-panel",components:{FormDefinitionPanelItemTable:ke},emits:["onClose","onSave"],props:{componentRef:Object},data(){return{componentProps:{},tooltipContent:`
          <h3>- 예제 1: 입력된 폼 내용 출력</h3>
          <p>alert(this.formValues["email"])<br>// "email" Name 속성을 가진 값을 출력</p>
          <h3>- 예제 2: 폼 내용을 변경</h3>
          <p>this.formValues["email"] = "new email"<br>// "email" Name 속성을 가진 값을 변경</p>
          <h3>- 예제 3: 폼 내용 검사 후 에러메시지 반환</h3>
          <p>if(this.formValues["email"] === "") error = "email is required"<br>
            // "email" Name 속성을 가진 값이 비어있으면 에러 메시지 반환<br>
            // "Event Type"이 반드시 "validate"로 설정되어 있어야 함</p>
          <h3>- 예제 4: 여러 줄 입력</h3>
          <p>alert("line1");<br>alert("line2");<br>// 여러 줄 입력시 각 라인의 끝에 ";"를 붙여야 함</p>
        `}},methods:{save(){for(const e of this.componentRef.settingInfos){if(!e.validCheck)continue;const t=e.validCheck(this.componentProps[e.dataToUse],this.componentProps);if(t){alert(t),this.$refs[e.dataToUse]&&this.$refs[e.dataToUse][0].focus();return}}this.componentRef.settingInfos.forEach(e=>{e.addOns&&e.addOns.includes("encodedAsBase64")&&(this.componentProps[e.dataToUse]=btoa(encodeURIComponent(this.componentProps[e.dataToUse])))}),this.$emit("onSave",this.componentRef,this.componentProps)},isShowCheck(e){return e.isShowCheck?e.isShowCheck(this.componentProps):!0}},mounted(){this.componentProps=this.componentRef.settingInfos.reduce((e,t)=>(t.settingType==="items"?e[t.dataToUse]=JSON.parse(JSON.stringify(this.componentRef[t.dataToUse])):t.addOns&&t.addOns.includes("encodedAsBase64")?e[t.dataToUse]=decodeURIComponent(atob(this.componentRef[t.dataToUse])):e[t.dataToUse]=this.componentRef[t.dataToUse],e),{}),this.$nextTick(()=>{Object.keys(this.$refs).length>0&&this.$refs[Object.keys(this.$refs)[0]][0].focus()})}},Ee=h("mdi-help-circle"),Pe=["innerHTML"];function De(e,t,l,s,o,i){const d=S("Icons"),m=S("FormDefinitionPanelItemTable");return c(),b(L,{class:"mx-auto my-8 pb-10 form-definition-panel-box",elevation:"16","max-width":"600"},{default:r(()=>[n(K,{class:"ma-0 pa-2"},{default:r(()=>[n(E,{class:"ma-0 pa-0"},{default:r(()=>[n(F,{class:"pb-0"},{default:r(()=>[h(T(e.$t("FormDefinitionPanel.editForm")),1)]),_:1}),n(J,{style:{color:"#666E7A"}},{default:r(()=>[h(T(e.$t("FormDefinitionPanel.type"))+": "+T(l.componentRef.tagName),1)]),_:1})]),_:1}),n(C,{onClick:t[0]||(t[0]=a=>e.$emit("onClose")),icon:"",variant:"text",density:"comfortable"},{default:r(()=>[n(d,{icon:"close",size:16})]),_:1})]),_:1}),n(I,{style:{overflow:"auto"}},{default:r(()=>[(c(!0),w(g,null,x(l.componentRef.settingInfos,(a,f)=>(c(),w(g,{key:f},[a.settingType==="text"&&i.isShowCheck(a)?(c(),b(v,{key:0,ref_for:!0,ref:a.dataToUse,label:e.$t(a.settingLabel),modelValue:o.componentProps[a.dataToUse],"onUpdate:modelValue":u=>o.componentProps[a.dataToUse]=u,modelModifiers:{trim:!0},onKeyup:p(i.save,["enter"]),"persistent-placeholder":""},null,8,["label","modelValue","onUpdate:modelValue","onKeyup"])):a.settingType==="number"&&i.isShowCheck(a)?(c(),b(v,{key:1,type:"number",ref_for:!0,ref:a.dataToUse,label:a.settingLabel,modelValue:o.componentProps[a.dataToUse],"onUpdate:modelValue":u=>o.componentProps[a.dataToUse]=u,modelModifiers:{trim:!0},onKeyup:p(i.save,["enter"]),"persistent-placeholder":""},null,8,["label","modelValue","onUpdate:modelValue","onKeyup"])):a.settingType==="textarea_code"&&i.isShowCheck(a)?(c(),w(g,{key:2},[n(G,{class:"text-subtitle-1 font-weight-medium"},{default:r(()=>[h(T(a.settingLabel)+" ",1),n(V,null,{activator:r(({props:u})=>[n(A,Q(X(u)),{default:r(()=>[Ee]),_:2},1040)]),default:r(()=>[P("div",{innerHTML:o.tooltipContent},null,8,Pe)]),_:1})]),_:2},1024),n(O,{ref_for:!0,ref:a.dataToUse,modelValue:o.componentProps[a.dataToUse],"onUpdate:modelValue":u=>o.componentProps[a.dataToUse]=u,modelModifiers:{trim:!0},rows:a.rows??5,"persistent-placeholder":""},null,8,["modelValue","onUpdate:modelValue","rows"])],64)):a.settingType==="textarea"&&i.isShowCheck(a)?(c(),b(O,{key:3,ref_for:!0,ref:a.dataToUse,label:a.settingLabel,modelValue:o.componentProps[a.dataToUse],"onUpdate:modelValue":u=>o.componentProps[a.dataToUse]=u,modelModifiers:{trim:!0},rows:a.rows??5,"persistent-placeholder":""},null,8,["label","modelValue","onUpdate:modelValue","rows"])):a.settingType==="select"&&i.isShowCheck(a)?(c(),b(Z,{key:4,ref_for:!0,ref:a.dataToUse,label:e.$t(a.settingLabel),modelValue:o.componentProps[a.dataToUse],"onUpdate:modelValue":u=>o.componentProps[a.dataToUse]=u,items:a.settingValue,onKeyup:p(i.save,["enter"]),"persistent-placeholder":""},null,8,["label","modelValue","onUpdate:modelValue","items","onKeyup"])):a.settingType==="items"&&i.isShowCheck(a)?(c(),w(g,{key:5},[n(Y,{modelValue:o.componentProps.localIsDynamicLoad,"onUpdate:modelValue":t[1]||(t[1]=u=>o.componentProps.localIsDynamicLoad=u),color:"primary","fixed-tabs":""},{default:r(()=>[n(N,{value:!1},{default:r(()=>[h(T(e.$t("FormDefinitionPanel.fixed")),1)]),_:1}),n(N,{value:!0},{default:r(()=>[h(T(e.$t("FormDefinitionPanel.dataBinding")),1)]),_:1})]),_:1},8,["modelValue"]),n(ee,{modelValue:o.componentProps.localIsDynamicLoad,"onUpdate:modelValue":t[5]||(t[5]=u=>o.componentProps.localIsDynamicLoad=u),class:"fill-height"},{default:r(()=>[n(H,{value:!1,class:"fill-height",style:{"overflow-y":"auto",padding:"5px"}},{default:r(()=>[n(m,{modelValue:o.componentProps[a.dataToUse],"onUpdate:modelValue":u=>o.componentProps[a.dataToUse]=u},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),n(H,{value:!0,class:"fill-height pa-5",style:{"overflow-y":"auto"}},{default:r(()=>[n(v,{label:"URL",ref_for:!0,ref:"localDynamicLoadURL",modelValue:o.componentProps.localDynamicLoadURL,"onUpdate:modelValue":t[2]||(t[2]=u=>o.componentProps.localDynamicLoadURL=u),modelModifiers:{trim:!0},onKeyup:p(i.save,["enter"])},null,8,["modelValue","onKeyup"]),n(v,{label:"Key JSON Path",ref_for:!0,ref:"localDynamicLoadKeyJsonPath",modelValue:o.componentProps.localDynamicLoadKeyJsonPath,"onUpdate:modelValue":t[3]||(t[3]=u=>o.componentProps.localDynamicLoadKeyJsonPath=u),modelModifiers:{trim:!0},onKeyup:p(i.save,["enter"])},null,8,["modelValue","onKeyup"]),n(v,{label:"Value JSON Path",ref_for:!0,ref:"localDynamicLoadValueJsonPath",modelValue:o.componentProps.localDynamicLoadValueJsonPath,"onUpdate:modelValue":t[4]||(t[4]=u=>o.componentProps.localDynamicLoadValueJsonPath=u),modelModifiers:{trim:!0},onKeyup:p(i.save,["enter"])},null,8,["modelValue","onKeyup"])]),_:1})]),_:2},1032,["modelValue"])],64)):a.settingType==="checkbox"&&i.isShowCheck(a)?(c(),b(W,{key:6,ref_for:!0,ref:a.dataToUse,label:e.$t(a.settingLabel),modelValue:o.componentProps[a.dataToUse],"onUpdate:modelValue":u=>o.componentProps[a.dataToUse]=u,onKeyup:p(i.save,["enter"])},null,8,["label","modelValue","onUpdate:modelValue","onKeyup"])):te("",!0)],64))),128))]),_:1}),n(C,{onClick:i.save,color:"primary",rounded:"",class:"form-apply-btn"},{default:r(()=>[h(T(e.$t("FormDefinitionPanel.save")),1)]),_:1},8,["onClick"])]),_:1})}const _e=D(Ue,[["render",De]]),Ae={name:"container-setting-panel",emits:["onClose","onSave"],props:{sectionId:String,containerProps:Object},data:()=>({localContainerProps:null}),watch:{containerProps:{deep:!0,handler(e){this.localContainerProps={...e}}}},created(){this.localContainerProps={...this.containerProps}},methods:{save(){if(this.localContainerProps.isMultiDataMode&&(!this.localContainerProps.name||this.localContainerProps.name.length<=0)){alert("Name is required"),this.$refs.name.focus();return}this.$emit("onSave",this.sectionId,this.localContainerProps)}},mounted(){this.$nextTick(()=>{this.$refs.name.focus()})}};function Ke(e,t,l,s,o,i){const d=S("Icons");return c(),b(L,{class:"mx-auto my-8 container-setting-box",elevation:"16","max-width":"600"},{default:r(()=>[n(K,{class:"ma-0 pa-2"},{default:r(()=>[n(F,{class:"pb-0"},{default:r(()=>[h(T(e.$t("ContainerSettingPanel.title")),1)]),_:1}),n(oe),n(C,{onClick:t[0]||(t[0]=m=>e.$emit("onClose")),icon:"",variant:"text",density:"comfortable"},{default:r(()=>[n(d,{icon:"close",size:16})]),_:1})]),_:1}),n(I,null,{default:r(()=>[n(v,{ref:"name",label:e.$t("ContainerSettingPanel.id"),modelValue:e.localContainerProps.name,"onUpdate:modelValue":t[1]||(t[1]=m=>e.localContainerProps.name=m),modelModifiers:{trim:!0},onKeyup:p(i.save,["enter"]),"persistent-placeholder":""},null,8,["label","modelValue","onKeyup"]),n(v,{label:e.$t("ContainerSettingPanel.name"),modelValue:e.localContainerProps.alias,"onUpdate:modelValue":t[2]||(t[2]=m=>e.localContainerProps.alias=m),modelModifiers:{trim:!0},onKeyup:p(i.save,["enter"]),"persistent-placeholder":""},null,8,["label","modelValue","onKeyup"]),n(W,{label:e.$t("ContainerSettingPanel.multDataMode"),modelValue:e.localContainerProps.isMultiDataMode,"onUpdate:modelValue":t[3]||(t[3]=m=>e.localContainerProps.isMultiDataMode=m),onKeyup:p(i.save,["enter"])},null,8,["label","modelValue","onKeyup"])]),_:1}),n(C,{onClick:i.save,color:"primary",rounded:"",class:"form-apply-btn"},{default:r(()=>[h(T(e.$t("ContainerSettingPanel.save")),1)]),_:1},8,["onClick"])]),_:1})}const Me=D(Ae,[["render",Ke]]),R={props:{content:{type:String,default:""},vueRenderUUID:{type:String,default:""}},setup(){const e=ne(null);return{componentRef:e,createComponentWithRef:(s,o)=>ie(s,{...o,ref:i=>{i&&(e.value=i)}}),parseContentToProps:s=>{const i=new DOMParser().parseFromString(s,"text/html").body.firstChild,d={};return i&&Array.from(i.attributes).forEach(m=>{d[m.name]=m.value}),d}}},render(){const l=new DOMParser().parseFromString(this.content,"text/html").body.firstChild.tagName.toLowerCase();switch(l){case"text-field":return this.createComponentWithRef(we,{vueRenderUUID:this.vueRenderUUID,tagName:l,...this.parseContentToProps(this.content)});case"select-field":return this.createComponentWithRef(ve,{vueRenderUUID:this.vueRenderUUID,tagName:l,...this.parseContentToProps(this.content)});case"checkbox-field":return this.createComponentWithRef(Te,{vueRenderUUID:this.vueRenderUUID,tagName:l,...this.parseContentToProps(this.content)});case"radio-field":return this.createComponentWithRef(ye,{vueRenderUUID:this.vueRenderUUID,tagName:l,...this.parseContentToProps(this.content)});case"file-field":return this.createComponentWithRef(fe,{vueRenderUUID:this.vueRenderUUID,tagName:l,...this.parseContentToProps(this.content)});case"label-field":return this.createComponentWithRef(he,{vueRenderUUID:this.vueRenderUUID,tagName:l,...this.parseContentToProps(this.content)});case"boolean-field":return this.createComponentWithRef(pe,{vueRenderUUID:this.vueRenderUUID,tagName:l,...this.parseContentToProps(this.content)});case"textarea-field":return this.createComponentWithRef(ce,{vueRenderUUID:this.vueRenderUUID,tagName:l,...this.parseContentToProps(this.content)});case"user-select-field":return this.createComponentWithRef(me,{vueRenderUUID:this.vueRenderUUID,tagName:l,...this.parseContentToProps(this.content)});case"code-field":return this.createComponentWithRef(ue,{vueRenderUUID:this.vueRenderUUID,tagName:l,...this.parseContentToProps(this.content)});default:return console.error("유효하지 않은 렌더링 content:",this.content),""}}};const Re={name:"mash-up",mixins:[ae],components:{DynamicComponent:R,FormDefinitionPanel:_e,ContainerSettingPanel:Me},props:{modelValue:String},emits:["onChangeKEditorContent","onSaveFormDefinition","onInitKEditorContent"],expose:["getKEditorContentHtml","clearStat"],data:()=>({kEditor:null,kEditorContent:'<div id="kEditor1"></div>',componentRefForSetting:null,isOpenComponentSettingDialog:!1,isOpenContainerSettingDialog:!1,containerSectionId:"",containerProps:{name:"",alias:"",isMultiDataMode:!1}}),computed:{mode(){return window.$mode}},methods:{onchangeKEditor(e,t){window.mashup.kEditorContent=window.mashup.kEditor[0].children[0].innerHTML,console.log("[*] onchangeKEditor 이벤트 => ",t),window.mashup.$emit("onChangeKEditorContent",{kEditorContent:window.mashup.kEditorContent,html:window.mashup.kEditorContentToHtml(window.mashup.kEditor[0].children[0].innerHTML,!0)})},loadStylesForKEditor(){["/css/keditor.css"].forEach(t=>{const l=document.createElement("link");l.rel="stylesheet",l.href=t,l.classList.add("keditor-stylesheet"),document.head.appendChild(l)})},removeStylesForKEditor(){document.querySelectorAll(".keditor-stylesheet").forEach(e=>{document.head.removeChild(e)})},clearStat(){window.mashup.kEditor[0].children[0].innerHTML="",window.mashup.kEditorContent="",window.mashup.$emit("onChangeKEditorContent",{kEditorContent:"",html:""})},getKEditorContentHtml(){return window.mashup.kEditorContentToHtml(window.mashup.kEditor[0].children[0].innerHTML)},kEditorContentToHtml(e,t=!0){let s=new DOMParser().parseFromString(e,"text/html");s.querySelectorAll("div[id^='vuemount_']").forEach(d=>{const m=d.id,a=window.mashup.componentRefs[m],f=document.createElement(a.tagName);a.settingInfos.forEach(u=>{u.settingType==="items"?f.setAttribute(u.htmlAttribute,JSON.stringify(a[u.dataToUse])):u.addOns&&u.addOns.includes("savedAsInnerText")?u.addOns.includes("encodedAsBase64")?f.innerText=decodeURIComponent(atob(a[u.dataToUse])):f.innerText=a[u.dataToUse]:f.setAttribute(u.htmlAttribute,a[u.dataToUse])}),d.innerHTML=f.outerHTML}),s.querySelectorAll("div.keditor-toolbar").forEach(d=>{d.remove()});const o=d=>{const m=d.parentElement;for(;d.firstChild;)m.insertBefore(d.firstChild,d);m.removeChild(d)},i=d=>{s.querySelectorAll(d).forEach(m=>{o(m)})};return i('[id^="vuemount_"]'),i("section.keditor-component-content"),i("section.keditor-initialized-component"),i("section.keditor-initializing-component"),i("section.keditor-container-inner:not(.keditor-container)"),s.querySelectorAll("section.keditor-initialized-container").forEach(d=>{d.removeAttribute("class"),d.removeAttribute("id")}),s.querySelectorAll('[class^="col-sm-"]').forEach(d=>{d.setAttribute("class",d.getAttribute("class").split(" ").filter(m=>m.includes("col-sm-")).join(" ")),d.removeAttribute("id"),d.removeAttribute("data-type")}),t?s.body.innerHTML.replace(/&quot;/g,"'").replace("<br>",`
`):s.body.firstChild.innerHTML.replace(/&quot;/g,"'").replace("<br>",`
`)},editFormDefinition(e,t){e.settingInfos.forEach(l=>{e[l.dataToUse]=t[l.dataToUse]}),window.mashup.isOpenComponentSettingDialog=!1},editContainerDefinition(e,t){console.log("[*] editContainerDefinition  : ",e,t);const l=$(`section#${e} .row`)[0];l.setAttribute("name",t.name),l.setAttribute("alias",t.alias),l.setAttribute("is_multidata_mode",String(t.isMultiDataMode)),window.mashup.isOpenContainerSettingDialog=!1},completeClearKEditor(){$("body").off("click",".btn-container-setting"),$("body").off("click",".btn-container-duplicate"),$("body").off("click",".btn-container-delete"),$("body").off("click",".btn-component-setting"),$("body").off("click",".btn-component-duplicate"),$("body").off("click",".btn-component-delete"),$("body").off("dblclick",".keditor-component"),document.body.classList.remove("initialized-click-event-handlers"),document.body.classList.remove("initialized-snippets-list"),$(".keditor-content-area").remove(),$(".keditor-ui").remove(),$("#kEditor1").data("keditor",null)},renderWithDynamicComponent(e,t,l=!1){const s=new DOMParser().parseFromString(e,"text/html");if(l)s.body.querySelectorAll("[name]").forEach(i=>i.setAttribute("name",i.getAttribute("name")+"-copy"));else{const i=Object.values(window.mashup.componentRefs).filter(d=>d.localName).length+1;s.body.querySelectorAll("[name]").forEach(d=>d.setAttribute("name",d.getAttribute("name")+`-${i}`))}const o=q(R,{content:s.body.innerHTML,vueRenderUUID:t}).use(B).mount("#"+t);window.mashup.componentRefs[t]=o.componentRef},getUserInputableComponentNames(){return Object.values(window.mashup.componentRefs).filter(e=>e.tagName.toLowerCase()!=="code-field"&&e.localName!==void 0&&e.localAlias!==void 0).map(e=>e.localName)}},mounted(){if(window.mashup=this,window.mashup.completeClearKEditor(),window.mashup.loadStylesForKEditor(),window.mashup.kEditor=$("#kEditor1"),window.mashup.modelValue&&($(window.mashup.kEditor)[0].innerHTML=window.mashup.modelValue),window.mashup.kEditor.keditor({tabContainersText:'<i class="fa fa-th-list"></i>',tabComponentsText:'<i class="fa fa-file"></i>',extraTabs:{setting:{text:'<i class="fa fa-cogs"></i>',title:"Settings",content:'<div class="form-horizontal">   <button class="btn btn-primary btn-lg" style="width:100%" id="clearBtn">Clear</button></div>'}},niceScrollEnabled:!1,tabTooltipEnabled:!1,snippetsTooltipEnabled:!1,containerSettingEnabled:!0,onInitSidebar:function(e){const t={"Content-type":"html; charset=UTF-8",Accept:"*/*"};le.get(`${window.location.origin}/snippets/default/snippets.html`,{headers:t}).then(function(l){console.log("axios result",l),e.renderSnippets(l.data),e.initSnippets(),e.initTabs(),e.initTabsSwitcher(),e.initSettingPanel(),e.options.snippetsFilterEnabled&&(e.initSnippetsFilter("Container"),e.initSnippetsFilter("Component")),(e.options.snippetsTooltipEnabled||e.options.tabTooltipEnabled)&&e.body.find("#"+e.options.snippetsListId).find('[data-toggle="tooltip"]').tooltip()})},containerSettingInitFunction:function(e,t){$("#clearBtn").on("click",function(l){window.mashup.clearStat()}),console.log("containerSettingInitFunction  : ",e,t),e.append('<div class="form-horizontal">   <h3>Here is Setting Container Panel!</h3></div>')},onContentChanged:function(e,t,l){$("#initGuide").css("opacity","0"),t&&l&&l.includes("vuemount_")&&window.mashup.renderWithDynamicComponent(t,l,!1),window.mashup.onchangeKEditor(e,"onContentChanged")},componentSettingShowFunction:function(e,t,l){console.log("componentSettingShowFunction : ",e,t,l);try{const s=new DOMParser().parseFromString(t[0].innerHTML,"text/html").querySelectorAll("div[id^='vuemount_']");if(s.length==0){alert("선택된 입력 요소가 없습니다.");return}const o=window.mashup.componentRefs[s[0].id];if(!o.settingInfos||o.settingInfos.length<=0){alert("해당 입력 요소에 대해서 추가적으로 세팅할 수 있는 항목이 없습니다.");return}o.settingInfos.forEach(i=>{i.addOns&&i.addOns.includes("inputableNameItems")&&(i.settingValue=window.mashup.getUserInputableComponentNames())}),window.mashup.componentRefForSetting=o,window.mashup.isOpenComponentSettingDialog=!0}catch(s){console.error(s)}},onInitComponent:function(e){const t=()=>{const l=()=>Math.floor((1+Math.random())*65536).toString(16).substring(1);return l()+l()+"-"+l()+"-"+l()+"-"+l()+l()+l()};if(window.mashup.onchangeKEditor(e,"onInitComponent"),e.hasClass("keditor-container"))e&&e.length>0&&e[0].setAttribute("id",`keditor-container-${new Date().getTime()}`);else if(e&&e.length>0&&e[0].querySelectorAll("div[id^='vuemount_']").length>0){const l=e[0].querySelectorAll("div[id^='vuemount_']")[0].getAttribute("id");if(l){const s=window.mashup.kEditor[0].children[0].querySelectorAll(`div[id='${l}']`);if(s.length==2){let o=window.mashup.kEditorContentToHtml(s[0].outerHTML,s[0].tagName.toLowerCase()!=="section");o=`<div id="${s[0].getAttribute("id")}" data-v-app>${o}</div>`;const i=`vuemount_${t()}`;o=o.replace(l,i),e[0].querySelector(".keditor-component-content").innerHTML=o,window.mashup.renderWithDynamicComponent(new DOMParser().parseFromString(o,"text/html").body.firstChild.innerHTML,i,!0)}}}},onComponentChanged:function(e){window.mashup.onchangeKEditor(e,"onComponentChanged")},initContentAreas:function(e,t){console.log("initContentAreas",e,t)},componentSettingHideFunction:function(e,t){console.log("componentSettingHideFunction : ",e,t)},containerSettingShowFunction:function(e,t,l){console.log("containerSettingShowFunction : ",e,t,l);const s=new DOMParser().parseFromString(t[0].outerHTML,"text/html");window.mashup.containerSectionId=s.querySelector("section").id;const o=s.querySelector(".row");window.mashup.containerProps={name:o&&o.getAttribute("name")||"",alias:o&&o.getAttribute("alias")||"",isMultiDataMode:o?o.getAttribute("is_multidata_mode")==="true":!1},window.mashup.isOpenContainerSettingDialog=!0},containerSettingHideFunction:function(e,t){console.log("containerSettingHideFunction : ",e,t)},onReady:function(){$("#keditor-setting-panel").remove()}}),window.mashup.componentRefs={},window.mashup.modelValue){$("#initGuide").css("opacity","0");const t=new DOMParser().parseFromString(window.mashup.modelValue,"text/html");t.querySelectorAll("code-field").forEach(s=>{const o=s.innerText,i=btoa(encodeURIComponent(o));s.setAttribute("encoded_code",i),s.innerText=""}),t.querySelectorAll("div[id^='vuemount_']").forEach(s=>{try{const o=s.id,i=q(R,{content:s.innerHTML,vueRenderUUID:o}).use(B).mount("#"+o);window.mashup.componentRefs[o]=i.componentRef}catch(o){console.log("### KEditor에서 Vue 컴포넌트 렌더링시에 오류 발생 ! ###"),console.log("window.mashup.modelValue: ",window.mashup.modelValue),console.log("vueRenderElement: ",s),console.error(o)}})}window.mashup.kEditorContent=window.mashup.kEditor[0].children[0].innerHTML,window.mashup.$emit("onInitKEditorContent",window.mashup.getKEditorContentHtml())},beforeUnmount(){window.mashup.removeStylesForKEditor(),window.mashup.completeClearKEditor()}},xe=e=>(re("data-v-da3b748f"),e=e(),se(),e),Fe={id:"initGuide"},Ie={style:{"font-size":"18px","font-weight":"bold"}},Le=xe(()=>P("div",{id:"kEditor1",class:"mashup-hover"},null,-1));function $e(e,t,l,s,o,i){const d=S("form-definition-panel"),m=S("container-setting-panel");return c(),w("div",null,[P("div",Fe,[P("span",Ie,T(e.$t("Mashup.hoverText")),1)]),Le,n(z,{modelValue:e.isOpenComponentSettingDialog,"onUpdate:modelValue":t[1]||(t[1]=a=>e.isOpenComponentSettingDialog=a)},{default:r(()=>[n(d,{componentRef:e.componentRefForSetting,onOnSave:i.editFormDefinition,onOnClose:t[0]||(t[0]=a=>e.isOpenComponentSettingDialog=!1)},null,8,["componentRef","onOnSave"])]),_:1},8,["modelValue"]),n(z,{modelValue:e.isOpenContainerSettingDialog,"onUpdate:modelValue":t[3]||(t[3]=a=>e.isOpenContainerSettingDialog=a)},{default:r(()=>[n(m,{sectionId:e.containerSectionId,containerProps:e.containerProps,onOnSave:i.editContainerDefinition,onOnClose:t[2]||(t[2]=a=>e.isOpenContainerSettingDialog=!1)},null,8,["sectionId","containerProps","onOnSave"])]),_:1},8,["modelValue"])])}const je=D(Re,[["render",$e],["__scopeId","data-v-da3b748f"]]),Oe={name:"FormDesignSavePanel",emits:["onClose","onSave"],props:{savedId:String,formNameByUrl:String},data:()=>({infoToSave:{id:""},placeholder:{id:""},default:{id:`untitled/${Date.now()}`},regexStr:/^[가-힣a-zA-Z0-9_\-. \/]+$/,regexErrorMsg:"'{{propName}}'은 한글, 영문, 숫자, 공백, 밑줄(_), 대시(-), 점(.), 슬래시(/)만 입력 가능합니다!"}),methods:{save(){if((!this.infoToSave.id||this.infoToSave.id.length<=0)&&(this.infoToSave.id=this.default.id),!this.regexStr.test(this.infoToSave.id)){alert(this.regexErrorMsg.replace("{{propName}}","ID")),this.$refs.inputId.focus();return}this.$emit("onSave",this.infoToSave)}},created(){this.placeholder.id=this.default.id,this.savedId&&(this.infoToSave.id=this.savedId),this.formNameByUrl&&this.formNameByUrl.length>0&&(this.infoToSave.id=this.formNameByUrl)},mounted(){this.savedId?this.$nextTick(()=>{this.$refs.saveButton.$el.focus()}):this.$nextTick(()=>{this.$refs.inputId.focus()})}},Ne=h("mdi-close"),He=h(" SAVE ");function qe(e,t,l,s,o,i){return c(),b(L,{class:"mx-auto my-8 form-save-box",elevation:"16","max-width":"400"},{default:r(()=>[n(F,{class:"ma-0 pa-0",style:{padding:"15px 0px 0px 25px !important"}},{default:r(()=>[h(T(l.savedId?"UpdateForm":"NewForm"),1)]),_:1}),n(A,{onClick:t[0]||(t[0]=d=>e.$emit("onClose")),class:"form-dialog-close-btn"},{default:r(()=>[Ne]),_:1}),n(I,null,{default:r(()=>[n(E,null,{default:r(()=>[n(v,{ref:"inputId",modelValue:e.infoToSave.id,"onUpdate:modelValue":t[1]||(t[1]=d=>e.infoToSave.id=d),modelModifiers:{trim:!0},label:"ID",onKeyup:p(i.save,["enter"]),placeholder:e.placeholder.id,"persistent-placeholder":"",disabled:!!l.savedId},null,8,["modelValue","onKeyup","placeholder","disabled"])]),_:1})]),_:1}),n(de,{style:{"justify-content":"right"}},{default:r(()=>[n(C,{ref:"saveButton",onClick:i.save,onKeyup:p(i.save,["enter"])},{default:r(()=>[He]),_:1},8,["onClick","onKeyup"])]),_:1})]),_:1})}const Je=D(Oe,[["render",qe]]);export{Je as F,je as M};
