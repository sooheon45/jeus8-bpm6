import{P as c}from"./ProcessDefinition-8367c465.js";import{B as p,c as m}from"./index-5e2cd834.js";import{B as u,_ as f,r as i,o as n,c as a,a as h,e as o,w as y,d as l}from"./index-7b37f28a.js";const s=u.createBackend(),w={components:{ProcessDefinition:c,BpmnUengineViewer:p},props:{instance:Object},data:()=>({bpmn:null,currentActivities:[],updatedKey:0,updatedDefKey:0,taskStatus:null,options:{additionalModules:[m]}}),created(){this.init(),this.EventBus.on("process-definition-updated",async()=>{this.bpmn=await s.getRawDefinition(this.instance.defId,{type:"bpmn",version:this.instance.defVer}),this.updatedDefKey++})},mounted(){let t=this;t.$try({action:async()=>{if(t.$route.params&&t.$route.params.instId){const e=window.$mode=="ProcessGPT"?atob(t.$route.params.instId):t.$route.params.instId;t.taskStatus=await s.getActivitiesStatus(e)}}})},computed:{mode(){return window.$mode},id(){return atob(this.$route.params.instId)}},watch:{instance:{deep:!0,async handler(t,e){t.instanceId!==e.instanceId&&await this.init()}}},methods:{init(){var t=this;t.$try({context:t,action:async()=>{t.instance&&(t.bpmn=await s.getRawDefinition(t.instance.defId,{type:"bpmn",version:this.instance.defVer}),t.workListByInstId=await s.getWorkListByInstId(t.instance.instanceId),t.mode=="ProcessGPT"?t.currentActivities=t.instance.current_activity_ids:t.currentActivities=t.workListByInstId.map(e=>e.tracingTag),t.updatedDefKey++)}})}}},_={style:{height:"100%"}},I={style:{overflow:"auto",height:"100%"}},k={key:0,style:{height:"100%"}},B=l(" No BPMN found ");function b(t,e,g,v,$,P){const r=i("BpmnUengineViewer"),d=i("dif");return n(),a("div",_,[h("div",I,[t.bpmn?(n(),a("div",k,[(n(),o(r,{ref:"bpmnVue",key:t.updatedDefKey,bpmn:t.bpmn,options:t.options,taskStatus:t.taskStatus,style:{height:"100%"}},null,8,["bpmn","options","taskStatus"]))])):(n(),o(d,{key:1,class:"no-bpmn-found-text"},{default:y(()=>[B]),_:1}))])])}const K=f(w,[["render",b]]);export{K as I};
