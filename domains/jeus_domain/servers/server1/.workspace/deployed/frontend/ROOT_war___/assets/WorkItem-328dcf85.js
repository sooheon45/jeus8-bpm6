import{_ as v,o as r,c as u,e as m,w as n,a as f,t as y,cc as z,h as p,bb as ee,r as g,b as c,bf as G,a_ as te,B as D,R as F,V as b,Q as M,F as S,i as W,M as N,d as I,ao as L,aS as se,cf as ie,E as U,D as j,aw as V,P as oe,b9 as q,s as ae,bg as re,bh as ne,g as ce,K as T,q as P,j as le,n as E,l as de,p as x,f as B,A as ue}from"./index-7b37f28a.js";import{D as J}from"./DefaultForm-027b9cf9.js";import{R as me,C as he}from"./Chat-127d4b0d.js";import{_ as Z}from"./DynamicForm-9e8c830e.js";import{V as Q}from"./VSheet-beabeb52.js";import{B as pe,c as fe}from"./index-5e2cd834.js";import{d as H}from"./index-8f33dbb8.js";const ke={props:{workItem:{type:Object,default:function(){return{}}}},data:()=>({instruction:null}),watch:{workItem(e){e&&e.activity&&e.activity.instruction&&(this.instruction=e.activity.instruction)}},created(){this.workItem&&this.workItem.activity.instruction&&(this.instruction=this.workItem.activity.instruction)}},ge={class:"mb-4"},Ie={style:{"font-size":"14px"}};function ye(e,t,s,i,a,o){return r(),u("div",ge,[e.instruction?(r(),m(z,{key:0,title:"Instruction",type:"info",variant:"outlined",density:"compact"},{text:n(()=>[f("span",Ie,y(e.instruction),1)]),_:1})):p("",!0)])}const X=v(ke,[["render",ye]]),we={components:{Record:me},props:{modelValue:{type:String,default:""},workItem:{type:Object,default:null}},data(){return{useTextAudio:!1,newMessage:"",recordingDialog:!1,mediaRecorder:null,audioChunks:[],isRecording:!1,chatRoomId:"",isMicRecording:!1,micRecorder:null,micAudioChunks:[],isMicRecorderLoading:!1}},watch:{modelValue(e){this.newMessage=e},newMessage(e){this.$emit("update:modelValue",e)}},created(){if(this.newMessage=this.modelValue,this.workItem){if(this.workItem.worklist&&this.workItem.worklist.instId)this.chatRoomId=this.workItem.worklist.instId;else if(this.workItem.worklist&&!this.workItem.worklist.instId){const e=this.uuid();this.chatRoomId=`${this.workItem.worklist.defId}.${e}`}}},methods:{uuid(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},onChangeRecordingDialog(){this.recordingDialog=!this.recordingDialog,this.recordingDialog||this.$emit("close")},async startRecording(){if(this.isRecording=!0,!navigator.mediaDevices){alert("getUserMedia를 지원하지 않는 브라우저입니다.");return}const e=await navigator.mediaDevices.getUserMedia({audio:!0});this.mediaRecorder=new MediaRecorder(e),this.audioChunks=[],this.mediaRecorder.ondataavailable=t=>{this.audioChunks.push(t.data)},this.mediaRecorder.start()},stopRecording(){this.isRecording=!1,this.mediaRecorder&&this.mediaRecorder.state==="recording"&&(this.mediaRecorder.stop(),this.mediaRecorder.onstop=async()=>{const e=new Blob(this.audioChunks,{type:"audio/wav"});this.uploadAudio(e)})},onClickMic(){this.isMicRecording?this.stopVoiceRecording():this.startVoiceRecording()},async startVoiceRecording(){if(this.isMicRecording=!0,!navigator.mediaDevices){alert("getUserMedia를 지원하지 않는 브라우저입니다.");return}const e=await navigator.mediaDevices.getUserMedia({audio:!0});this.micRecorder=new MediaRecorder(e),this.micAudioChunks=[],this.micRecorder.ondataavailable=t=>{this.micAudioChunks.push(t.data)},this.micRecorder.start()},stopVoiceRecording(){this.isMicRecording=!1,this.micRecorder&&this.micRecorder.state==="recording"&&(this.micRecorder.stop(),this.micRecorder.onstop=async()=>{const e=new Blob(this.micAudioChunks,{type:"audio/wav"});await this.uploadAudio(e)})},async uploadAudio(e){this.isMicRecorderLoading=!0;const t=new FormData;t.append("audio",e);try{const i=(await ee.post("/execution/upload",t)).data;this.newMessage=i.transcript}catch(s){console.error("Error:",s)}finally{this.isMicRecorderLoading=!1}}}},ve={class:"mb-4"},_e={class:"d-flex align-self-end cursor-pointer"};function be(e,t,s,i,a,o){const l=g("Icons"),h=g("Record");return r(),u("div",ve,[c(G,{modelValue:a.useTextAudio,"onUpdate:modelValue":t[0]||(t[0]=d=>a.useTextAudio=d),label:"자유롭게 결과 입력","hide-details":"",density:"compact"},null,8,["modelValue"]),a.useTextAudio?(r(),m(te,{key:0,modelValue:a.newMessage,"onUpdate:modelValue":t[3]||(t[3]=d=>a.newMessage=d),"hide-details":"",density:"compact",rows:"3","no-resize":""},{"append-inner":n(()=>[f("div",_e,[f("div",{onClick:t[1]||(t[1]=(...d)=>o.onChangeRecordingDialog&&o.onChangeRecordingDialog(...d)),class:"mr-1"},[c(l,{icon:"round-headset"})]),f("div",{onClick:t[2]||(t[2]=(...d)=>o.onClickMic&&o.onClickMic(...d))},[!a.isMicRecording&&!a.isMicRecorderLoading?(r(),m(l,{key:0,icon:"sharp-mic"})):a.isMicRecorderLoading?a.isMicRecorderLoading?(r(),m(l,{key:2,icon:"bubble-loading"})):p("",!0):(r(),m(l,{key:1,icon:"stop",size:"20"}))])])]),_:1},8,["modelValue"])):p("",!0),c(h,{onClose:o.onChangeRecordingDialog,onStart:o.startRecording,onStop:o.stopRecording,audioResponse:a.newMessage,chatRoomId:a.chatRoomId,recordingMode:a.recordingDialog},null,8,["onClose","onStart","onStop","audioResponse","chatRoomId","recordingMode"])])}const Y=v(we,[["render",be]]),O=D.createBackend(),De={components:{DefaultForm:J,Instruction:X,AudioTextarea:Y},props:{definitionId:String,workItem:{type:Object,default:function(){return null}},workItemStatus:{type:String,default:function(){return null}},isDryRun:Boolean,dryRunWorkItem:Object,currentActivities:{type:Array,default:function(){return[]}},isSimulate:{type:String,default:"false"}},data:()=>({inputItems:null,outputItems:null,newMessage:""}),computed:{simulate(){return this.isSimulate==="true"||this.isSimulate==="false"?this.isSimulate==="true":this.isSimulate},isCompleted(){return this.workItemStatus=="COMPLETED"||this.workItemStatus=="DONE"},mode(){return window.$mode},inputKeys(){const e=this.workItem&&this.workItem.activity&&this.workItem.activity.parameters?this.workItem.activity.parameters:[];return e.length>0?e.filter(s=>s.direction.includes("IN")).map(s=>s.argument.text):[]},outputKeys(){const e=this.workItem&&this.workItem.activity&&this.workItem.activity.parameters?this.workItem.activity.parameters:[];return e.length>0?e.filter(s=>s.direction.includes("OUT")).map(s=>s.argument.text):[]}},watch:{"$route.params.taskId":{handler(e,t){e&&e!=t&&this.init()}}},created(){this.init()},methods:{close(){this.$emit("close")},init(){var e=this;let s=e.workItem.parameterValues;e.isCompleted?e.outputItems=s?Object.entries(s).map(([i,a])=>({name:i,key:i,value:a})):[]:(e.inputItems=s?Object.entries(s).map(([i,a])=>({name:i,key:i,value:a})):[],e.inputKeys.length>0&&(e.inputItems=e.inputItems.filter(i=>e.inputKeys.includes(i.key))),e.outputKeys.length>0&&(e.outputItems=s?Object.entries(s).map(([i,a])=>({name:i,key:i,value:a})):[],e.outputItems=e.outputItems.filter(i=>e.outputKeys.includes(i.key))))},completeTask(e){var t=this;t.$try({context:t,action:async()=>{if(t.isDryRun){let s=t.dryRunWorkItem;s.execScope&&(e.execScope=s.execScope);let i={processDefinitionId:t.definitionId};await O.startAndComplete({processExecutionCommand:i,workItem:e},t.isSimulate),t.close()}else{t.workItem.execScope&&(e.execScope=t.workItem.execScope),await O.putWorkItemComplete(t.$route.params.taskId,e,!0);const s=window.$mode=="ProcessGPT"?btoa(t.workItem.worklist.instId):t.workItem.worklist.instId;t.$router.push(`/instancelist/${s}`)}},successMsg:this.$t("successMsg.workCompleted")})},executeProcess(){let e={parameterValues:{}},t=this.inputItems.reduce((s,i)=>({...s,[i.key]:i.value}),{});t&&(e.parameterValues=t),this.newMessage&&this.newMessage.length>0&&(e.parameterValues.user_input_text=this.newMessage),this.isDryRun&&this.mode=="ProcessGPT"||this.simulate?this.$emit("executeProcess",e):this.completeTask(e)},intermediateSave(){var e=this;e.$try({context:e,action:()=>{e.inputItems&&e.inputItems.length>0&&e.inputItems.forEach(async t=>{await O.setVariable(e.workItem.worklist.instId,t.name,t.value)})},successMsg:this.$t("successMsg.intermediate")})}}},Me=I("중간 저장"),Se=I("완료"),Ce={class:"pa-4",style:{height:"100%"}},Re={class:"d-flex flex-column overflow-y-auto",style:{height:"100%"}},$e={key:0},Ae={key:1};function Ve(e,t,s,i,a,o){const l=g("DefaultForm");return r(),u(S,null,[o.isCompleted?p("",!0):(r(),m(M,{key:0,class:"ma-0 pa-0 task-btn",style:{right:"10px"}},{default:n(()=>[c(F),s.isDryRun?p("",!0):(r(),m(b,{key:0,onClick:o.intermediateSave,color:"primary",rounded:"",class:"mr-1"},{default:n(()=>[Me]),_:1},8,["onClick"])),c(b,{onClick:o.executeProcess,color:"primary",rounded:""},{default:n(()=>[Se]),_:1},8,["onClick"])]),_:1})),f("div",Ce,[f("div",Re,[e.outputItems&&e.outputItems.length>0?(r(),u("div",$e,[(r(!0),u(S,null,W(e.outputItems,h=>(r(),m(M,{class:"w-100",key:h.name},{default:n(()=>[c(L,{cols:"5"},{default:n(()=>[c(N,null,{default:n(()=>[I(y(h.key),1)]),_:2},1024)]),_:2},1024),c(L,{cols:"7"},{default:n(()=>[c(N,null,{default:n(()=>[I(y(h.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))])):p("",!0),o.isCompleted?p("",!0):(r(),u("div",Ae,[e.inputItems&&e.inputItems.length>0?(r(),m(l,{key:0,inputItems:e.inputItems},null,8,["inputItems"])):p("",!0)]))])])],64)}const Te=v(De,[["render",Ve]]),Le={props:{workItem:{type:Object,default:function(){return{}}}},data:()=>({checkpoints:null,snackbar:!1}),computed:{checkedCount(){return this.checkpoints?this.checkpoints.filter(e=>e.checked).length:0},allChecked(){return this.checkpoints.every(e=>e.checked)},readOnly(){return this.workItem.worklist.status==="COMPLETED"||this.workItem.worklist.status==="DONE"}},watch:{workItem(e){e&&e.activity&&e.activity.checkpoints&&(this.readOnly?this.checkpoints=e.activity.checkpoints.map(t=>({name:t,checked:!0})):this.checkpoints=e.activity.checkpoints.map(t=>({name:t,checked:!1})))}},created(){this.workItem&&this.workItem.activity.checkpoints&&(this.readOnly?this.checkpoints=this.workItem.activity.checkpoints.map(e=>({name:e,checked:!0})):this.checkpoints=this.workItem.activity.checkpoints.map(e=>({name:e,checked:!1})))}},Pe={class:"text-success font-weight-semibold"},Ee=I("$success"),xe={class:"text-body-1",style:{"line-height":"1.3"}},Be=I(" 체크포인트를 확인해주세요. "),Oe=I("x ");function Fe(e,t,s,i,a,o){return r(),u(S,null,[e.checkpoints?(r(),m(Q,{key:0,class:"mt-auto pa-3 border border-success rounded"},{default:n(()=>[f("div",Pe,[c(se,{class:"mr-2"},{default:n(()=>[Ee]),_:1}),I(" Checkpoints ("+y(o.checkedCount)+"/"+y(e.checkpoints?e.checkpoints.length:0)+") ",1)]),(r(!0),u(S,null,W(e.checkpoints,(l,h)=>(r(),u("div",{key:h,class:"mt-2"},[c(G,{modelValue:l.checked,"onUpdate:modelValue":d=>l.checked=d,"hide-details":"",density:"compact",color:"success",disabled:o.readOnly},{label:n(()=>[f("span",xe,y(l.name),1)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]))),128))]),_:1})):p("",!0),c(ie,{modelValue:e.snackbar,"onUpdate:modelValue":t[1]||(t[1]=l=>e.snackbar=l),class:"custom-snackbar",timeout:"3000",color:"warning",elevation:"24",location:"top"},{actions:n(()=>[c(b,{variant:"text",onClick:t[0]||(t[0]=l=>e.snackbar=!1)},{default:n(()=>[Oe]),_:1})]),default:n(()=>[Be]),_:1},8,["modelValue"])],64)}const We=v(Le,[["render",Fe]]);const _=D.createBackend(),Ne={components:{DynamicForm:Z,Instruction:X,AudioTextarea:Y,Checkpoints:We},props:{definitionId:String,workItem:{type:Object,default:function(){return null}},workItemStatus:{type:String,default:function(){return null}},isDryRun:Boolean,dryRunWorkItem:Object,currentActivities:{type:Array,default:function(){return[]}},isSimulate:{type:String,default:"false"}},data:()=>({html:null,formDefId:null,formData:{},newMessage:""}),computed:{simulate(){return this.isSimulate==="true"||this.isSimulate==="false"?this.isSimulate==="true":this.isSimulate},isCompleted(){return this.workItemStatus=="COMPLETED"||this.workItemStatus=="DONE"}},watch:{html(){this.isCompleted&&(this.html=this.disableFormHTML(this.html)),this.EventBus.emit("html-updated",this.html)},formData(){this.formData&&this.EventBus.emit("formData-updated",this.formData)}},mounted(){this.init()},methods:{async init(){var e=this;if(e.isDryRun?e.formDefId=e.dryRunWorkItem.activity.tool.split(":")[1]:e.formDefId=e.workItem.worklist.tool.split(":")[1],!e.formDefId)if($mode=="ProcessGPT")e.formDefId=`${e.workItem.worklist.defId}_${e.workItem.activity.tracingTag}_form`;else return;e.html=await _.getRawDefinition(e.formDefId,{type:"form"}),e.isDryRun||e.loadForm(),e.EventBus.on("form-values-updated",t=>{t&&Object.keys(t).forEach(function(s){e.formData[s]=t[s]})})},async loadForm(){var i;var e=this;if(!e.workItem||!e.workItem.activity||!e.workItem.activity.variableForHtmlFormContext)return;let t=e.workItem.activity.variableForHtmlFormContext.name||e.formDefId,s=await _.getVariableWithTaskId(e.workItem.worklist.instId,e.$route.params.taskId,t);if(s&&s.valueMap&&(e.formData=s.valueMap),(i=e.workItem)!=null&&i.parameterValues){const a=e.workItem.parameterValues[t];a&&a.valueMap&&(e.formData=a.valueMap)}},async saveTask(){var e=this;e.$try({context:e,action:async()=>{await e.saveForm(),await _.putWorkItem(e.$route.params.taskId,{parameterValues:{}},e.isSimulate)},successMsg:this.$t("successMsg.intermediate")})},async saveForm(e){let t=this,s=t.workItem.activity.variableForHtmlFormContext.name,i={};t.isDryRun||(i=await _.getVariableWithTaskId(t.workItem.worklist.instId,t.$route.params.taskId,s)),i._type="org.uengine.contexts.HtmlFormContext",i.valueMap=t.formData,Object.keys(i.valueMap).forEach(a=>{var o;if(Array.isArray(i.valueMap[a])){if(!i.valueMap[a])return;(o=i.valueMap[a])==null||o.forEach(l=>{l&&l._type&&(l._type="java.util.HashMap")})}}),i.valueMap._type="java.util.HashMap",t.isDryRun?(e||(e={}),i.formDefId=t.formDefId,i.filePath=`${t.formDefId}.form`,e[s]=JSON.stringify(i)):await _.setVariableWithTaskId(t.workItem.worklist.instId,t.$route.params.taskId,s,i)},async completeTask(){let e=this;e.$try({context:e,action:async()=>{let t={parameterValues:{}},s={};$mode=="uEngine"&&await e.saveForm(s),$mode=="ProcessGPT"&&(t.parameterValues=e.formData);const i=e.$refs.dynamicForm?e.$refs.dynamicForm.validate():null;if(i&&i.length>0){alert(`※ 폼에 정의된 유효성 검사에 실패했습니다 !
> `+i);return}if(e.workItem.execScope&&(t.execScope=e.workItem.execScope),e.isDryRun){let a={processDefinitionId:e.definitionId};await _.startAndComplete({processExecutionCommand:a,workItem:t,variables:s}),e.close()}else{this.newMessage&&this.newMessage.length>0&&(t.user_input_text=this.newMessage),await _.putWorkItemComplete(e.$route.params.taskId,t,e.isSimulate);let a="";$mode=="ProcessGPT"?a=btoa(e.workItem.worklist.instId):a=e.workItem.worklist.instId,e.$router.push(`/instancelist/${a}`)}}})},disableFormHTML(e){const s=new DOMParser().parseFromString(e,"text/html");return s.querySelectorAll('[disabled="false"]').forEach(a=>{a.setAttribute("disabled","true")}),s.body.innerHTML},close(){this.$emit("close")},fail(e){this.$emit("fail",e)},executeProcess(){if($mode=="ProcessGPT"&&!this.$refs.checkpoints.allChecked){this.$refs.checkpoints.snackbar=!0;return}let e={};if(this.newMessage&&this.newMessage.length>0&&(e.user_input_text=this.newMessage),this.isDryRun&&$mode=="ProcessGPT"||this.simulate){const t=this.formDefId.replace(/\s+/g,"_").toLowerCase();e[t]=this.formData,this.$emit("executeProcess",e)}else this.completeTask()}}},Ue={key:0,class:"from-work-item-pc"},je=I("중간 저장"),He=I("제출 완료"),Ke={key:1,class:"form-work-item-mobile"},ze={class:"pa-4"};function Ge(e,t,s,i,a,o){const l=g("Icons"),h=g("DynamicForm"),d=g("AudioTextarea"),k=g("Checkpoints");return r(),u(S,null,[c(M,{class:"ma-0 pa-0 task-btn",style:{right:"50px",top:"12px"}},{default:n(()=>[c(F),o.isCompleted?p("",!0):(r(),u("div",Ue,[s.isDryRun?p("",!0):(r(),m(b,{key:0,onClick:o.saveTask,color:"primary",class:"mr-2",rounded:""},{default:n(()=>[je]),_:1},8,["onClick"])),c(b,{onClick:o.executeProcess,color:"primary",rounded:""},{default:n(()=>[He]),_:1},8,["onClick"])])),o.isCompleted?p("",!0):(r(),u("div",Ke,[c(U,{text:"중간 저장"},{activator:n(({props:w})=>[c(b,j({onClick:o.saveTask,icon:""},w,{density:"comfortable"}),{default:n(()=>[c(l,{icon:"save",width:32,height:32})]),_:2},1040,["onClick"])]),_:1}),c(U,{text:"제출 완료"},{activator:n(({props:w})=>[c(b,j({onClick:o.executeProcess,icon:""},w,{density:"comfortable"}),{default:n(()=>[c(l,{icon:"submit-document",width:28,height:28})]),_:2},1040,["onClick"])]),_:1})]))]),_:1}),f("div",ze,[e.html?(r(),m(h,{key:0,ref:"dynamicForm",formHTML:e.html,modelValue:e.formData,"onUpdate:modelValue":t[0]||(t[0]=w=>e.formData=w),class:"dynamic-form"},null,8,["formHTML","modelValue"])):p("",!0),o.isCompleted?p("",!0):(r(),m(d,{key:1,modelValue:e.newMessage,"onUpdate:modelValue":t[1]||(t[1]=w=>e.newMessage=w),workItem:s.workItem,onClose:o.close},null,8,["modelValue","workItem","onClose"])),c(k,{ref:"checkpoints",workItem:s.workItem,onUpdateCheckpoints:e.updateCheckpoints},null,8,["workItem","onUpdateCheckpoints"])])],64)}const qe=v(Ne,[["render",Ge]]),Je={props:{url:{type:String,default:function(){return null}}}},Ze={key:0,class:"input-group",style:{width:"100%"}},Qe=["src"],Xe={key:1},Ye={class:"d-flex justify-center"},et=I("No input url available");function tt(e,t,s,i,a,o){const l=g("v-subheader");return s.url?(r(),u("div",Ze,[f("iframe",{id:"url-iframe",src:s.url,style:{width:"100%",height:"calc(75vh)"}},null,8,Qe)])):(r(),u("div",Xe,[f("div",Ye,[c(l,{class:"text-center"},{default:n(()=>[et]),_:1})])]))}const st=v(Je,[["render",tt]]),it={props:{workItem:{type:Object,default:function(){return null}},workItemStatus:{type:String,default:function(){return null}},isDryRun:Boolean,dryRunWorkItem:{type:Object,default:function(){return{}}},currentActivities:{type:Array,default:function(){return[]}}},components:{URLForm:st},computed:{url(){var e=this;return e.isDryRun?e.dryRunWorkItem.activity.tool.replace("urlHandler:",""):e.workItem.worklist.tool.replace("urlHandler:","")},origin(){return this.url?new URL(this.url).origin:null}},mounted(){var e=this;const t=D.createBackend();window.addEventListener("message",async function(s){if(origin&&s.origin===e.origin){let i=s.data,a=null;if(e.isDryRun?a=e.dryRunWorkItem.activity.eventSynchronization:a=e.workItem.activity.eventSynchronization,!a)return;if(a.eventType==i.eventType){let o=await t.getCurrentWorkItemByCorrKey(i.id);if(o){let l=e.currentActivities.concat(o.activity.tracingTag);e.$emit("updateCurrentActivities",l)}}}})},methods:{close(){this.$emit("close")}}},ot={style:{height:"calc(100vh - 255px)",padding:"20px"}};function at(e,t,s,i,a,o){const l=g("URLForm");return r(),u("div",ot,[c(l,{url:o.url},null,8,["url"])])}const rt=v(it,[["render",at]]);const C=D.createBackend(),nt={props:{messages:Array},data(){return{filterMessages:[],defaultProfile:"@/assets/images/profile/1.jpg"}},components:{DynamicForm:Z,DefaultForm:J},created(){this.init()},methods:{init(){this.filterMessages=this.messages.map(e=>(e.open=!1,e.html=null,e.formData=null,e))},toolFormat(e){return e._item?e._item.tool.includes("formHandler")?"formHandler":e._item.tool:null},async openDescription(e){var t=this;t.$try({context:t,action:async()=>{const s=t.filterMessages[e]._item;if(t.filterMessages[e].open){t.filterMessages[e].open=!1;return}if(s.tool.includes("formHandler")){if(t.filterMessages[e].html&&t.filterMessages[e].formData){t.filterMessages[e].open=!0;return}let a=(await C.getWorkItem(s.taskId)).activity.variableForHtmlFormContext.name,o=s.tool.split(":")[1];t.filterMessages[e].html=await C.getRawDefinition(o,{type:"form"});let l=await C.getVariable(s.instId,a);t.filterMessages[e].formData=l?l.valueMap:{}}else{const i=await C.getWorkItem(s.taskId);let a=[];if(i.activity.parameters)for(const o of i.activity.parameters){let l=await C.getVariable(s.instId,o.variable.name);a.push({name:o.variable.name,value:l})}t.filterMessages[e].formData=a}t.filterMessages[e].open=!0}})},clickContent(e){this.$emit("clickMessage",e)},formatTime(e){var t=new Date(e),s=t.toString(),i=s.split(" ")[4].substring(0,5);return i}}},ct={class:"w-100"},lt=["src"],dt=["src"],ut={key:0,style:{"font-size":"12px","padding-top":"20px"}},mt={class:"w-100 pb-5"},ht=["innerHTML","onClick"],pt={key:0,style:{"margin-top":"20px"}},ft={key:0},kt={key:1},gt={key:2},It=["innerHTML"];function yt(e,t,s,i,a,o){const l=g("Icons"),h=g("DynamicForm"),d=g("DefaultForm");return r(),u("div",ct,[V(e.$slots,"contents",{},()=>[(r(!0),u(S,null,W(a.filterMessages,(k,w)=>(r(),u("div",{key:w,class:"w-100 pa-4"},[V(e.$slots,"messageProfile",{},()=>[c(M,{class:"ma-0 pa-0",style:{"margin-bottom":"10px !important"}},{default:n(()=>[c(oe,{class:"pr-2",size:"40"},{default:n(()=>[k.profile?(r(),u("img",{key:1,src:k.profile,alt:"pro",width:"50"},null,8,dt)):(r(),u("img",{key:0,src:a.defaultProfile,alt:"pro",width:"50"},null,8,lt))]),_:2},1024),k.timeStamp?(r(),u("div",ut,y(k.roleName)+" "+y(o.formatTime(k.timeStamp)),1)):p("",!0)]),_:2},1024)]),V(e.$slots,"messageContent",{},()=>[f("div",mt,[c(Q,{class:"bg-lightsecondary rounded-md px-3 py-2 w-100"},{default:n(()=>[c(M,{class:"pa-0 ma-0"},{default:n(()=>[f("div",{innerHTML:k.content,onClick:A=>o.clickContent(k)},null,8,ht),c(F),a.filterMessages[w].open?(r(),m(l,{key:0,onClick:A=>o.openDescription(w),icon:"arrow-up-2",style:{cursor:"pointer"}},null,8,["onClick"])):(r(),m(l,{key:1,onClick:A=>o.openDescription(w),icon:"arrow-down-2",style:{cursor:"pointer"}},null,8,["onClick"]))]),_:2},1024),k.open?(r(),u("div",pt,[o.toolFormat(k).includes("formHandler")?(r(),u("div",ft,[k.open?(r(),m(h,{key:0,class:"message-layout-dyna",formHTML:k.html,modelValue:k.formData,"onUpdate:modelValue":A=>k.formData=A},null,8,["formHTML","modelValue","onUpdate:modelValue"])):p("",!0)])):o.toolFormat(k)=="defaultHandler"?(r(),u("div",kt,[c(d,{inputItems:k.formData},null,8,["inputItems"])])):(r(),u("div",gt,[f("div",{innerHTML:k.description},null,8,It)]))])):p("",!0)]),_:2},1024)])])]))),128))]),V(e.$slots,"input")])}const wt=v(nt,[["render",yt]]),vt=D.createBackend();class _t extends q{constructor(t,s){super(t,s),this.previousMessages=[],this.input={answer:"",process_instance_id:"",process_definition_id:"",image:null}}beforeGenerate(t,s){if(t&&(t.text&&(this.input.answer=t.text),t.image&&(this.input.image=t.image)),s)this.client.processDefinition&&(this.input.process_definition_id=this.client.processDefinition),this.input.process_instance_id="new";else{var i=this.client.processInstance;this.input.activity_id=i.current_activity_ids[0],this.input.process_instance_id=i.proc_inst_id}}async generate(){const t=await vt.start(this.input);this.client.onGenerationFinished(t)}}class K extends q{constructor(t,s){super(t,s),this.model="gpt-4o",this.previousMessages=[{role:"user",content:`너는 주어진 답변 양식에 알맞는 답변 예시를 생성해주는 llm 이야.
            제공해준 "이전 작업 리스트" 정보를 참고하여 "생성해야할 답변 형식"에 맞는 적절한 예시값을 답변으로 생성해야한다.
            만약 "이전 작업 리스트" 정보가 존재하지 않는다면, "생성해야할 답변 형식"에 가장 적절한 예시를 생성해야한다.
            "현재 작업 입력 양식" 의 용도는 생성될 예시들의 데이터 경로 파악하기 위함이다. 
            "현재 작업 입력 양식" 이 아닌 "생성해야할 답변 형식" 에 존재하는 키의 예시값들만 생성해야한다. 그 이외의 키에 대한 예시 생성은 기능에 치명적인 오류 발생을 야기하기때문에 절대 생성해선 안된다.
            예를 들어 "생성해야할 답변 형식" 이 
            {
                applicant_name: "...",
                end_date: "...", 
                reason: "...", 
                start_date: "..."
            }
            이렇게 되어있다면 위 4개의 key 에 대해서만 예시를 생성해야한다.
            결과 예시: {
                formValues: {
                    applicant_name: "생성된 예시값",
                    end_date: "생성된 예시값", 
                    reason: "생성된 예시값", 
                    start_date: "생성된 예시값"
                }
            }

            만약 "첨부된 이미지에 대한 설명" 정보가 존재한다면 해당 설명을 최대한 참고하여 예시값을 생성해야한다.
            생성될 답변은 적절한 예시 값으로 생성해야하는데, "첨부된 이미지에 대한 설명" 에 대한 내용이 존재하고 이미 기존 값이 채워져있는 내용과 유사하다고 판단될 경우 해당 기존 값을 참고하되 최대한 존중하여 개선 또는 기존 값에 덧붙여서 생성하여야한다.
            "첨부된 이미지에 대한 설명" 에 대한 내용이 존재하지만 이미 기존 값이 채워져있는 내용과 유사하지않다고 판단될 경우 기존 채워져있는 값을 무시하고 "첨부된 이미지에 대한 설명" 에 대한 내용에 맞게끔 예시값을 생성하여야한다.
            "첨부된 이미지에 대한 설명" 에 대한 내용이 없고 기존 값이 채워져있는 경우에는 해당 기존 값을 참고하여 개선 또는 기존 값에 덧붙여서 생성하여야한다.
            예시 내용을 최대한 구체적으로 길게 생성해주는게 좋다.

            만약 담당자 지정과 같이 "유저 목록", "회사 조직도" 정보가 필요한 경우 제공해준 "유저목록" 및 "회사 조직도" 정보를 이용해야한다.
            예를 들어 개발팀 팀장이 담당자가 되어야하는 경우 "회사 조직도" 내 개발팀 팀장을 찾아 담당자로 지정해야한다.
            만약 "회사 조직도" 정보가 존재하지 않는다면 "이전 작업 리스트"중 동일한 문제를 해결한 적이 있거나, 담당자에 가장 적합해 보이는 유저를 "유저목록"에서 등록해야한다. 
            유저 목록에 존재하는 해당 유저의 "유저명"을 표시해야하며 담당자 지정 사유도 같이 설명해주면 좋다.

            생성할 답변의 형식은 아래와 같이 생성되어야한다.
            e.g. "현재 작업 입력 양식"의 html 내용을 파악하고 해당 html 에 존재하는 v-model 에 들어갈 값을 생성하되 그 경로는 v-model 에 매핑된 경로에 맞게끔 Object 를 생성하여야한다. 
            반드시 "현재 작업 입력 양식"의 html 내용중 v-model 에 매핑된 경로에 맞게 생성해야한다. 그렇지 않은 경우 생성된 답변을 사용자가 볼 수 없고 시스템상 오류를 야기시키기 때문에 이점을 유의하여 생성해야한다.
            생성된 결과는 반드시 답변 형식은 제공해준 "생성해야할 답변 형식"대로 해당 형식에 맞는 JSON 형식으로 생성되어야한다. "formValues"는 반드시 포함되어야한다.
            아래의 예시대로 JSON 만 생성하고 이외의 다른 결과는 어떠한것도 생성하면 안된다. 생성한 결과를 JSON.parse 해서 사용할 예정이기때문에 parse 시에 문제가 없도록 JSON 결과를 생성해야한다.
            예시: 
            {
                formValues: {
                    "제공된 답변 형식의 키": 제공된 형식에 맞는 결과값
                }
            }`}]}}const R=D.createBackend(),bt={mixins:[ae],components:{Chat:he},props:{isComplete:Boolean,isAgentMode:Boolean,html:String,formData:Object},data:()=>({processDefinition:null,processInstance:null,path:"proc_inst",organizationChart:[],chatInfo:null,imgKeyList:[],onLoad:!1,bpmn:null,currentActivities:null,isRunningId:null}),computed:{chatName(){return this.processInstance&&this.processInstance.proc_inst_name?this.processInstance.proc_inst_name:""}},async created(){await this.init(),this.generator=new _t(this,{isStream:!0,preferredLanguage:"Korean"}),this.isAgentMode?(this.chatInfo={title:"processExecution.cardTitle",text:"processExecution.agent"},this.generator=new K(this,{isStream:!0,preferredLanguage:"Korean"}),this.handleDraftResponse()):this.chatInfo={title:"processExecution.cardTitle",text:"processExecution.processDefinitionExplanation"}},watch:{$route:{deep:!0,async handler(e,t){e.params.taskId&&e.params.taskId!==t.params.taskId?(e.params.taskId||(this.messages=[]),await this.init()):e.params.instId&&e.params.instId!==t.params.instId&&(this.messages=[],await this.init())}}},methods:{async resizeBase64Image(e,t,s){return new Promise(i=>{const a=new Image;a.src=e,a.onload=()=>{const o=document.createElement("canvas"),l=o.getContext("2d");let h=a.width,d=a.height;h>d?h>t&&(d*=t/h,h=t):d>s&&(h*=s/d,d=s),o.width=h,o.height=d,l.drawImage(a,0,0,h,d),i(o.toDataURL())}})},reGenerateAgentAI(){this.messages=[],this.handleDraftResponse()},async handleDraftResponse(){if(this.messages.push({role:"system",content:"...",isLoading:!0}),this.isVisionMode=!1,this.imgKeyList=[],this.formData&&typeof this.formData=="object"){for(const e of Object.keys(this.formData))if(this.formData[e]&&this.formData[e].includes("data:image/")){this.imgKeyList.push(e),this.isVisionMode=!0,this.generator.previousMessages=[];const t=await this.resizeBase64Image(this.formData[e],512,512);this.generator.previousMessages.push({content:[{type:"text",text:"해당 이미지를 분석하고 이미지 분석 내용을 자세하게 한글로 설명해. 이미지에 표시된 날짜, 글자 위주로 집중 분석한 결과를 설명해. 결과는 최대한 정확하고 자세하지만 최대한 요약해서 생성해주면 좋아."},{type:"image_url",image_url:{url:t}}],role:"user"}),this.generator.model="gpt-4-vision-preview"}}this.isVisionMode?this.generator.generate():this.generateAgentAI()},async generateAgentAI(e){var t=this;if(this.isVisionMode=!1,this.generator=new K(this,{isStream:!0,preferredLanguage:"Korean"}),this.generator.model="gpt-4o",e&&this.generator.previousMessages.push({content:"첨부된 이미지에 대한 설명: "+e,role:"user"}),this.processInstance&&this.processInstance.proc_inst_id){const l={match:{id:this.processInstance.proc_inst_id}},h=await this.storage.list("proc_inst",l);this.generator.previousMessages.push({content:"이전 작업 내역 리스트: "+JSON.stringify(h),role:"user"})}else this.generator.previousMessages.push({content:"이전 작업 내역 리스트: null",role:"user"});this.generator.previousMessages.push({content:"현재 작업 입력 양식: "+this.html,role:"user"});let s=JSON.parse(JSON.stringify(t.formData));this.imgKeyList.length>0&&(this.imgKeyList.forEach(function(l){delete s[l]}),t.imgKeyList=[]);let i={formValues:s};this.generator.previousMessages.push({content:"생성해야할 답변 형식: "+JSON.stringify(i),role:"user"});let a=await this.storage.list("users");this.generator.previousMessages.push({content:"유저 목록: "+JSON.stringify(a),role:"user"});const o=await this.getData("configuration/organization",{key:"key"});this.generator.previousMessages.push({content:"회사 조직도: "+JSON.stringify(o.value),role:"user"}),this.generator.generate()},requestDraftAgent(e){var t=this;t.$try({context:t,action(){e&&(t.agentInfo.draftPrompt=e),t.messages.push(t.createMessageObj(e)),t.agentInfo.draftPrompt&&(t.agentInfo.isRunning=!0,t.requestAgent(t.agentInfo.draftPrompt))}})},async loadProcess(){this.onLoad=!1;let e,t;this.processInstance&&this.processInstance.current_activity_ids?(this.currentActivities=this.processInstance.current_activity_ids,e=this.processInstance.proc_inst_id,t=e.split(".")[0]):(e=this.$route.params.taskId,t=e.split(".")[0],this.processInstance=await R.getInstance(e),this.processInstance&&(this.currentActivities=this.processInstance.current_activity_ids));var s=await R.getRawDefinition(t,{type:"bpmn"});s&&(this.bpmn=s),this.onLoad=!0},async loadData(e){const t=this;t.processInstance=null,t.bpmn=null;let s;if(t.$route.params.taskId){const i=t.$route.params.taskId,a=await R.getWorkItem(i);a&&(s=a.worklist.instId)}else t.$route.params.instId&&(s=atob(t.$route.params.instId),this.chatRoomId=s);if(s){const i=await R.getInstance(s);i&&(t.processInstance=i,t.checkDisableChat()),await t.loadProcess(),this.isAgentMode?t.processInstanceId=i.proc_inst_id:await t.getChatList(s)}},checkDisableChat(){(this.isComplete||this.isAgentMode)&&(this.disableChat=!0),this.processInstance&&this.processInstance.current_user_ids&&this.processInstance.current_user_ids.length>0&&!this.processInstance.current_user_ids.includes(this.userInfo.email)&&(this.disableChat=!0)},async beforeSendMessage(e){e&&e.text!=""&&(this.chatRoomId?(this.putMessage(this.createMessageObj(e)),await this.generator.beforeGenerate(e,!1)):await this.generator.beforeGenerate(e,!0),this.sendMessage(e))},beforeSendEditedMessage(e){e>0&&(this.generator.beforeGenerate(this.messages[e-1].content,!1),this.sendEditedMessage(e))},async putMessage(e){const t=this.uuid(),s={messages:e,id:this.chatRoomId,uuid:t};this.putObject(`chats/${t}`,s)},afterModelCreated(e){},async afterGenerationFinished(e){var t=this;let s=t.messages[t.messages.length-1];s.jsonContent=e;const i=e;i&&(i.instanceId&&(t.processInstance=await R.getInstance(i.instanceId)),i.nextActivities&&i.nextActivities.length>0&&(s.content=i.nextActivities.map(a=>a.messageToUser).join(`

`))),t.checkDisableChat(),t.EventBus.emit("instances-updated"),t.EventBus.emit("process-definition-updated")},afterModelStopped(e){let t;if(this.$route.params.taskId?t=this.$route.params.taskId:this.processInstance&&this.processInstance.proc_inst_id&&(t=this.processInstance.proc_inst_id),t!=""){let s={messages:this.messages};this.putObject(`proc_inst/${t}`,s,{key:"id"})}},async saveDefinitionToVectorDB(){const e=await this.storage.list("proc_def");if(e&&e.length>0){const t=new H.VectorStorage({openAIApiKey:this.openaiToken});e.forEach(async s=>{if(s.definition){const i=JSON.stringify(s.definition);await t.addText(i,{category:s.definition.processDefinitionId})}})}},async queryFromVectorDB(e){const s=await new H.VectorStorage({openAIApiKey:this.openaiToken}).similaritySearch({query:e});return s.similarItems.length>0?s.similarItems.map(a=>a.text):(await this.saveDefinitionToVectorDB(),this.queryFromVectorDB(e))}}},Dt=e=>(re("data-v-7e4a548a"),e=e(),ne(),e),Mt={style:{"background-color":"rgba(255, 255, 255, 0)",width:"100%"}},St=Dt(()=>f("div",null,null,-1));function Ct(e,t,s,i,a,o){const l=g("Chat");return r(),u("div",Mt,[c(l,{messages:e.messages,agentInfo:e.agentInfo,isAgentMode:s.isAgentMode,userInfo:e.userInfo,disableChat:e.disableChat,type:"instances",name:o.chatName,chatRoomId:e.chatRoomId,onRequestDraftAgent:o.requestDraftAgent,onSendMessage:o.beforeSendMessage,onSendEditedMessage:o.beforeSendEditedMessage,onStopMessage:e.stopMessage,onReGenerateAgentAI:o.reGenerateAgentAI},{"custom-title":n(()=>[St]),_:1},8,["messages","agentInfo","isAgentMode","userInfo","disableChat","name","chatRoomId","onRequestDraftAgent","onSendMessage","onSendEditedMessage","onStopMessage","onReGenerateAgentAI"])])}const Rt=v(bt,[["render",Ct],["__scopeId","data-v-7e4a548a"]]),$=D.createBackend(),$t={props:{definitionId:{type:String,required:!0},taskId:String,isDryRun:{type:Boolean,default:!1},dryRunWorkItem:Object,isSimulate:{type:Boolean,default:!1}},components:{DefaultWorkItem:Te,FormWorkItem:qe,URLWorkItem:rt,"work-history-uEngine":wt,"work-history-ProcessGPT":Rt,BpmnUengineViewer:pe},data:()=>({workItem:null,workListByInstId:null,windowWidth:window.innerWidth,bpmn:null,options:{propertiesPanel:{},additionalModules:[fe]},currentComponent:null,currentActivities:[],taskStatus:null,updatedKey:0,updatedDefKey:0,selectedTab:"progress",eventList:[],html:null,formData:null,taskStatus:{}}),created(){this.init(),this.EventBus.on("process-definition-updated",async()=>{this.updatedDefKey++}),this.EventBus.on("html-updated",e=>{this.html=e}),this.EventBus.on("formData-updated",e=>{this.formData=e}),window.addEventListener("resize",this.handleResize)},beforeDestroy(){window.removeEventListener("resize",this.handleResize)},computed:{mode(){return window.$mode},currentTaskId(){return this.taskId?this.taskId:this.$route.params.taskId},messages(){return this.workListByInstId?this.workListByInstId.map(e=>({profile:"https://avatars0.githubusercontent.com/u/9064066?v=4&s=460",roleName:e.task.roleName,_item:e,content:e.title,description:e.description,timeStamp:e.startDate})):[]},activityName(){return this.workItem?this.workItem.activity.name:null},workItemStatus(){return this.workItem?this.isDryRun?"NEW":this.workItem.worklist.status:null},isCompleted(){return this.workItemStatus=="COMPLETED"||this.workItemStatus=="DONE"},isMobile(){return this.windowWidth<=700}},watch:{windowWidth(e){e<=700?this.isMobile=!0:this.isMobile=!1},$route:{handler(e,t){e.params.taskId&&e.params.taskId!=t.params.taskId&&this.init()},deep:!0}},methods:{init(){var e=this;e.$try({context:e,action:async()=>{var t,s;if(e.isDryRun)e.bpmn=await $.getRawDefinition(e.definitionId,{type:"bpmn"}),e.workItem=e.dryRunWorkItem,e.currentActivities=[e.workItem.activity.tracingTag];else{e.workItem=await $.getWorkItem(e.currentTaskId),e.bpmn=await $.getRawDefinition(e.workItem.worklist.defId,{type:"bpmn",version:e.workItem.worklist.defVerId}),e.workItem.worklist.execScope&&(e.workItem.execScope=e.workItem.worklist.execScope),e.workListByInstId=await $.getWorkListByInstId(e.workItem.worklist.instId);let i={};i[(s=(t=e.workItem)==null?void 0:t.activity)==null?void 0:s.tracingTag]="Running",e.taskStatus=i,e.workItem.worklist.currentActivities?e.currentActivities=e.workItem.worklist.currentActivities:(e.currentActivities=e.workListByInstId.map(a=>a.tracingTag),console.log(e.workListByInstId.map(a=>a.tracingTag)))}e.workItem.worklist&&e.workItem.worklist.instId&&(e.taskStatus=await $.getActivitiesStatus(e.workItem.worklist.instId)),e.mode=="ProcessGPT"?e.currentComponent="FormWorkItem":e.currentComponent=e.workItem.activity.tool.includes("urlHandler")?"URLWorkItem":e.workItem.activity.tool.includes("formHandler")?"FormWorkItem":"DefaultWorkItem",e.updatedDefKey++},errorMsg:"워크아이템을 찾을 수 없습니다."})},handleResize(){this.windowWidth=window.innerWidth},updateCurrentActivities(e){e||(e=[]),this.currentActivities=e,this.updatedDefKey++},close(){this.$emit("close")},navigateToWorkItemByTaskId(e){var t=this;t.$router.push(`/todolist/${e._item.taskId}`),this.$nextTick(()=>{t.delay(500).then(()=>{t.init(),t.updatedKey++})})},delay(e){return new Promise(t=>setTimeout(t,e))},executeProcess(e){this.$emit("executeProcess",e)}}},At={class:"px-3 py-3 pb-4 align-center"},Vt={class:"d-flex"},Tt={class:"text-h5 font-weight-semibold"},Lt={key:0,class:"work-itme-current-component",style:{height:"100%"}},Pt={key:0,style:{height:"100%"}},Et={key:1,class:"no-bpmn-found-text"};function xt(e,t,s,i,a,o){const l=g("BpmnUengineViewer"),h=g("perfect-scrollbar");return e.currentComponent?(r(),m(B,{elevation:"10",key:e.updatedKey},{default:n(()=>[f("div",At,[f("div",Vt,[f("h5",Tt,y(o.activityName),1),o.workItemStatus?(r(),m(ce,{key:0,size:"x-small",variant:"outlined",style:{margin:"2px 0px 0px 5px !important",display:"flex","align-items":"center"}},{default:n(()=>[I(y(o.workItemStatus),1)]),_:1})):p("",!0)])]),c(M,{class:ue(o.isMobile?"ma-0 pa-2 mt-2":"ma-0 pa-2")},{default:n(()=>[c(L,{class:"pa-0",cols:o.isMobile?12:4,style:T(o.isMobile?"overflow: auto":e.$globalState.state.isZoomed?"height: calc(100vh - 70px); overflow: auto":"height: calc(100vh - 215px); overflow: auto")},{default:n(()=>[e.currentComponent?(r(),u("div",Lt,[(r(),m(P(e.currentComponent),{definitionId:s.definitionId,"work-item":e.workItem,workItemStatus:o.workItemStatus,isDryRun:s.isDryRun,dryRunWorkItem:s.dryRunWorkItem,currentActivities:e.currentActivities,onUpdateCurrentActivities:o.updateCurrentActivities,onClose:o.close,onExecuteProcess:o.executeProcess,"is-simulate":s.isSimulate},null,8,["definitionId","work-item","workItemStatus","isDryRun","dryRunWorkItem","currentActivities","onUpdateCurrentActivities","onClose","onExecuteProcess","is-simulate"]))])):p("",!0)]),_:1},8,["cols","style"]),c(L,{class:"pa-0",cols:o.isMobile?12:8},{default:n(()=>[c(z,{class:"pa-0 mt-4",color:"#2196F3",variant:"outlined"},{default:n(()=>[c(le,{modelValue:e.selectedTab,"onUpdate:modelValue":t[0]||(t[0]=d=>e.selectedTab=d)},{default:n(()=>[c(E,{value:"progress"},{default:n(()=>[I(y(e.$t("WorkItem.progress")),1)]),_:1}),o.messages&&o.messages.length>0?(r(),m(E,{key:0,value:"history"},{default:n(()=>[I(y(e.$t("WorkItem.history")),1)]),_:1})):p("",!0),o.messages?(r(),m(E,{key:1,value:"agent"},{default:n(()=>[I(y(e.$t("WorkItem.agent")),1)]),_:1})):p("",!0)]),_:1},8,["modelValue"]),c(de,{modelValue:e.selectedTab,"onUpdate:modelValue":t[5]||(t[5]=d=>e.selectedTab=d)},{default:n(()=>[c(x,{value:"progress"},{default:n(()=>[f("div",{class:"pa-2",style:T(e.$globalState.state.isZoomed?"height: calc(100vh - 130px);":"height: calc(100vh - 280px); color: black; overflow: auto")},[(r(),u("div",{class:"pa-0 pl-2",style:{height:"100%"},key:e.updatedDefKey},[e.bpmn?(r(),u("div",Pt,[c(l,{ref:"bpmnVue",bpmn:e.bpmn,options:e.options,currentActivities:e.currentActivities,"task-status":e.taskStatus,onError:e.handleError,onShown:e.handleShown,onOpenDefinition:t[1]||(t[1]=d=>e.openSubProcess(d)),onLoading:e.handleLoading,onOpenPanel:t[2]||(t[2]=d=>e.openPanel(d)),onUpdateXml:t[3]||(t[3]=d=>e.$emit("update-xml",d)),onDefinition:t[4]||(t[4]=d=>e.definitions=d),onAddShape:e.onAddShape,onDone:e.setDefinition,onChangeSequence:e.onChangeSequence,onRemoveShape:e.onRemoveShape,onChangeShape:e.onChangeShape,style:{height:"100%"}},null,8,["bpmn","options","currentActivities","task-status","onError","onShown","onLoading","onAddShape","onDone","onChangeSequence","onRemoveShape","onChangeShape"])])):(r(),u("div",Et,"No BPMN found"))]))],4)]),_:1}),c(x,{value:"history",class:"pa-2"},{default:n(()=>[c(B,{elevation:"10",class:"pa-4"},{default:n(()=>[o.messages.length>0?(r(),m(h,{key:0,class:"h-100",ref:"scrollContainer",onScroll:e.handleScroll},{default:n(()=>[f("div",{class:"d-flex w-100",style:T([{overflow:"auto"},e.workHistoryHeight])},[(r(),m(P("work-history-"+o.mode),{messages:o.messages,isCompleted:o.isCompleted,onClickMessage:o.navigateToWorkItemByTaskId},null,8,["messages","isCompleted","onClickMessage"]))],4)]),_:1},8,["onScroll"])):p("",!0)]),_:1})]),_:1}),c(x,{value:"agent",class:"pa-2"},{default:n(()=>[c(B,{elevation:"10",class:"pa-4"},{default:n(()=>[o.messages?(r(),m(h,{key:0,class:"h-100",ref:"scrollContainer",onScroll:e.handleScroll},{default:n(()=>[f("div",{class:"d-flex w-100",style:T([{overflow:"auto"},e.workHistoryHeight])},[(r(),m(P("work-history-"+o.mode),{messages:[],html:e.html,formData:e.formData,isAgentMode:!0},null,8,["html","formData"]))],4)]),_:1},8,["onScroll"])):p("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["cols"])]),_:1},8,["class"])]),_:1})):p("",!0)}const Bt=v($t,[["render",xt]]),Kt=Object.freeze(Object.defineProperty({__proto__:null,default:Bt},Symbol.toStringTag,{value:"Module"}));export{Te as D,qe as F,Rt as P,rt as U,wt as W,Bt as a,Kt as b};
