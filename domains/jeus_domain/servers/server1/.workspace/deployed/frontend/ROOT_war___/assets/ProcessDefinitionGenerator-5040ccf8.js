import{bO as K,bP as en,bQ as tn,B as At,_ as Ct,r as _e,o as te,c as ce,b as W,w as J,f as Ur,Q as Xe,U as Vr,d as ve,t as pe,R as It,V as he,m as jr,bR as qr,W as Oe,h as we,e as xe,a_ as Wt,X as $r,bk as Gr,u as Yt,bi as rn,a as ae,aS as Ve,b7 as nn,K as zt,D as be,E as Ee,k as on,b9 as sn}from"./index-7b37f28a.js";import{P as an}from"./ProcessDefinition-8367c465.js";import{F as un}from"./FormDesignGenerator-cf42b57e.js";import{_ as cn}from"./FormDefinitionModule-1faf025f.js";import{V as ln}from"./VSlider-11543daf.js";var Ie={},je={},Ht;function _t(){return Ht||(Ht=1,(function(){je.defaults={"0.1":{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},"0.2":{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:`
`},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(K)),je}var qe={},De={},Ne={},Jt;function Te(){return Jt||(Jt=1,(function(){var t,s,h,u,m,e,r,i=[].slice,f={}.hasOwnProperty;t=function(){var N,D,E,x,C,O;if(O=arguments[0],C=2<=arguments.length?i.call(arguments,1):[],m(Object.assign))Object.assign.apply(null,arguments);else for(N=0,E=C.length;N<E;N++)if(x=C[N],x!=null)for(D in x)f.call(x,D)&&(O[D]=x[D]);return O},m=function(N){return!!N&&Object.prototype.toString.call(N)==="[object Function]"},e=function(N){var D;return!!N&&((D=typeof N)=="function"||D==="object")},h=function(N){return m(Array.isArray)?Array.isArray(N):Object.prototype.toString.call(N)==="[object Array]"},u=function(N){var D;if(h(N))return!N.length;for(D in N)if(f.call(N,D))return!1;return!0},r=function(N){var D,E;return e(N)&&(E=Object.getPrototypeOf(N))&&(D=E.constructor)&&typeof D=="function"&&D instanceof D&&Function.prototype.toString.call(D)===Function.prototype.toString.call(Object)},s=function(N){return m(N.valueOf)?N.valueOf():N},Ne.assign=t,Ne.isFunction=m,Ne.isObject=e,Ne.isArray=h,Ne.isEmpty=u,Ne.isPlainObject=r,Ne.getValue=s}).call(K)),Ne}var $e={exports:{}},Kt;function Wr(){return Kt||(Kt=1,(function(){$e.exports=function(){function t(){}return t.prototype.hasFeature=function(s,h){return!0},t.prototype.createDocumentType=function(s,h,u){throw new Error("This DOM method is not implemented.")},t.prototype.createDocument=function(s,h,u){throw new Error("This DOM method is not implemented.")},t.prototype.createHTMLDocument=function(s){throw new Error("This DOM method is not implemented.")},t.prototype.getFeature=function(s,h){throw new Error("This DOM method is not implemented.")},t}()}).call(K)),$e.exports}var Ge={exports:{}},We={exports:{}},Ye={exports:{}},Qt;function pn(){return Qt||(Qt=1,(function(){Ye.exports=function(){function t(){}return t.prototype.handleError=function(s){throw new Error(s)},t}()}).call(K)),Ye.exports}var ze={exports:{}},Zt;function fn(){return Zt||(Zt=1,(function(){ze.exports=function(){function t(s){this.arr=s||[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t.prototype.item=function(s){return this.arr[s]||null},t.prototype.contains=function(s){return this.arr.indexOf(s)!==-1},t}()}).call(K)),ze.exports}var er;function hn(){return er||(er=1,(function(){var t,s;t=pn(),s=fn(),We.exports=function(){function h(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new t,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(h.prototype,"parameterNames",{get:function(){return new s(Object.keys(this.defaultParams))}}),h.prototype.getParameter=function(u){return this.params.hasOwnProperty(u)?this.params[u]:null},h.prototype.canSetParameter=function(u,m){return!0},h.prototype.setParameter=function(u,m){return m!=null?this.params[u]=m:delete this.params[u]},h}()}).call(K)),We.exports}var He={exports:{}},Je={exports:{}},Ke={exports:{}},tr;function ue(){return tr||(tr=1,(function(){Ke.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(K)),Ke.exports}var Qe={exports:{}},rr;function Yr(){return rr||(rr=1,(function(){var t;t=ue(),ye(),Qe.exports=function(){function s(h,u,m){if(this.parent=h,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),u==null)throw new Error("Missing attribute name. "+this.debugInfo(u));this.name=this.stringify.name(u),this.value=this.stringify.attValue(m),this.type=t.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(s.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(s.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(s.prototype,"textContent",{get:function(){return this.value},set:function(h){return this.value=h||""}}),Object.defineProperty(s.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(s.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(s.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(s.prototype,"specified",{get:function(){return!0}}),s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(h){return this.options.writer.attribute(this,this.options.writer.filterOptions(h))},s.prototype.debugInfo=function(h){return h=h||this.name,h==null?"parent: <"+this.parent.name+">":"attribute: {"+h+"}, parent: <"+this.parent.name+">"},s.prototype.isEqualNode=function(h){return!(h.namespaceURI!==this.namespaceURI||h.prefix!==this.prefix||h.localName!==this.localName||h.value!==this.value)},s}()}).call(K)),Qe.exports}var Ze={exports:{}},nr;function Mt(){return nr||(nr=1,(function(){Ze.exports=function(){function t(s){this.nodes=s}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.getNamedItem=function(s){return this.nodes[s]},t.prototype.setNamedItem=function(s){var h;return h=this.nodes[s.nodeName],this.nodes[s.nodeName]=s,h||null},t.prototype.removeNamedItem=function(s){var h;return h=this.nodes[s],delete this.nodes[s],h||null},t.prototype.item=function(s){return this.nodes[Object.keys(this.nodes)[s]]||null},t.prototype.getNamedItemNS=function(s,h){throw new Error("This DOM method is not implemented.")},t.prototype.setNamedItemNS=function(s){throw new Error("This DOM method is not implemented.")},t.prototype.removeNamedItemNS=function(s,h){throw new Error("This DOM method is not implemented.")},t}()}).call(K)),Ze.exports}var ir;function Ot(){return ir||(ir=1,(function(){var t,s,h,u,m,e,r,i,f=function(D,E){for(var x in E)N.call(E,x)&&(D[x]=E[x]);function C(){this.constructor=D}return C.prototype=E.prototype,D.prototype=new C,D.__super__=E.prototype,D},N={}.hasOwnProperty;i=Te(),r=i.isObject,e=i.isFunction,m=i.getValue,u=ye(),t=ue(),s=Yr(),h=Mt(),Je.exports=function(D){f(E,D);function E(x,C,O){var F,B,I,T;if(E.__super__.constructor.call(this,x),C==null)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(C),this.type=t.Element,this.attribs={},this.schemaTypeInfo=null,O!=null&&this.attribute(O),x.type===t.Document&&(this.isRoot=!0,this.documentObject=x,x.rootObject=this,x.children)){for(T=x.children,B=0,I=T.length;B<I;B++)if(F=T[B],F.type===t.DocType){F.name=this.name;break}}}return Object.defineProperty(E.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(E.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(E.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(E.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(E.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(E.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(E.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(E.prototype,"attributes",{get:function(){return(!this.attributeMap||!this.attributeMap.nodes)&&(this.attributeMap=new h(this.attribs)),this.attributeMap}}),E.prototype.clone=function(){var x,C,O,F;O=Object.create(this),O.isRoot&&(O.documentObject=null),O.attribs={},F=this.attribs;for(C in F)N.call(F,C)&&(x=F[C],O.attribs[C]=x.clone());return O.children=[],this.children.forEach(function(B){var I;return I=B.clone(),I.parent=O,O.children.push(I)}),O},E.prototype.attribute=function(x,C){var O,F;if(x!=null&&(x=m(x)),r(x))for(O in x)N.call(x,O)&&(F=x[O],this.attribute(O,F));else e(C)&&(C=C.apply()),this.options.keepNullAttributes&&C==null?this.attribs[x]=new s(this,x,""):C!=null&&(this.attribs[x]=new s(this,x,C));return this},E.prototype.removeAttribute=function(x){var C,O,F;if(x==null)throw new Error("Missing attribute name. "+this.debugInfo());if(x=m(x),Array.isArray(x))for(O=0,F=x.length;O<F;O++)C=x[O],delete this.attribs[C];else delete this.attribs[x];return this},E.prototype.toString=function(x){return this.options.writer.element(this,this.options.writer.filterOptions(x))},E.prototype.att=function(x,C){return this.attribute(x,C)},E.prototype.a=function(x,C){return this.attribute(x,C)},E.prototype.getAttribute=function(x){return this.attribs.hasOwnProperty(x)?this.attribs[x].value:null},E.prototype.setAttribute=function(x,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.getAttributeNode=function(x){return this.attribs.hasOwnProperty(x)?this.attribs[x]:null},E.prototype.setAttributeNode=function(x){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.removeAttributeNode=function(x){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.getElementsByTagName=function(x){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.getAttributeNS=function(x,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.setAttributeNS=function(x,C,O){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.removeAttributeNS=function(x,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.getAttributeNodeNS=function(x,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.setAttributeNodeNS=function(x){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.getElementsByTagNameNS=function(x,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.hasAttribute=function(x){return this.attribs.hasOwnProperty(x)},E.prototype.hasAttributeNS=function(x,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.setIdAttribute=function(x,C){return this.attribs.hasOwnProperty(x)?this.attribs[x].isId:C},E.prototype.setIdAttributeNS=function(x,C,O){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.setIdAttributeNode=function(x,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.getElementsByTagName=function(x){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.getElementsByTagNameNS=function(x,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.getElementsByClassName=function(x){throw new Error("This DOM method is not implemented."+this.debugInfo())},E.prototype.isEqualNode=function(x){var C,O,F;if(!E.__super__.isEqualNode.apply(this,arguments).isEqualNode(x)||x.namespaceURI!==this.namespaceURI||x.prefix!==this.prefix||x.localName!==this.localName||x.attribs.length!==this.attribs.length)return!1;for(C=O=0,F=this.attribs.length-1;0<=F?O<=F:O>=F;C=0<=F?++O:--O)if(!this.attribs[C].isEqualNode(x.attribs[C]))return!1;return!0},E}(u)}).call(K)),Je.exports}var et={exports:{}},tt={exports:{}},or;function ke(){return or||(or=1,(function(){var t,s=function(u,m){for(var e in m)h.call(m,e)&&(u[e]=m[e]);function r(){this.constructor=u}return r.prototype=m.prototype,u.prototype=new r,u.__super__=m.prototype,u},h={}.hasOwnProperty;t=ye(),tt.exports=function(u){s(m,u);function m(e){m.__super__.constructor.call(this,e),this.value=""}return Object.defineProperty(m.prototype,"data",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(m.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(m.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),m.prototype.clone=function(){return Object.create(this)},m.prototype.substringData=function(e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.appendData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.insertData=function(e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.deleteData=function(e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.replaceData=function(e,r,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.isEqualNode=function(e){return!(!m.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)||e.data!==this.data)},m}(t)}).call(K)),tt.exports}var sr;function St(){return sr||(sr=1,(function(){var t,s,h=function(m,e){for(var r in e)u.call(e,r)&&(m[r]=e[r]);function i(){this.constructor=m}return i.prototype=e.prototype,m.prototype=new i,m.__super__=e.prototype,m},u={}.hasOwnProperty;t=ue(),s=ke(),et.exports=function(m){h(e,m);function e(r,i){if(e.__super__.constructor.call(this,r),i==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=t.CData,this.value=this.stringify.cdata(i)}return e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(r){return this.options.writer.cdata(this,this.options.writer.filterOptions(r))},e}(s)}).call(K)),et.exports}var rt={exports:{}},ar;function Lt(){return ar||(ar=1,(function(){var t,s,h=function(m,e){for(var r in e)u.call(e,r)&&(m[r]=e[r]);function i(){this.constructor=m}return i.prototype=e.prototype,m.prototype=new i,m.__super__=e.prototype,m},u={}.hasOwnProperty;t=ue(),s=ke(),rt.exports=function(m){h(e,m);function e(r,i){if(e.__super__.constructor.call(this,r),i==null)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=t.Comment,this.value=this.stringify.comment(i)}return e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(r){return this.options.writer.comment(this,this.options.writer.filterOptions(r))},e}(s)}).call(K)),rt.exports}var nt={exports:{}},ur;function Pt(){return ur||(ur=1,(function(){var t,s,h,u=function(e,r){for(var i in r)m.call(r,i)&&(e[i]=r[i]);function f(){this.constructor=e}return f.prototype=r.prototype,e.prototype=new f,e.__super__=r.prototype,e},m={}.hasOwnProperty;h=Te().isObject,s=ye(),t=ue(),nt.exports=function(e){u(r,e);function r(i,f,N,D){var E;r.__super__.constructor.call(this,i),h(f)&&(E=f,f=E.version,N=E.encoding,D=E.standalone),f||(f="1.0"),this.type=t.Declaration,this.version=this.stringify.xmlVersion(f),N!=null&&(this.encoding=this.stringify.xmlEncoding(N)),D!=null&&(this.standalone=this.stringify.xmlStandalone(D))}return r.prototype.toString=function(i){return this.options.writer.declaration(this,this.options.writer.filterOptions(i))},r}(s)}).call(K)),nt.exports}var it={exports:{}},ot={exports:{}},cr;function Ft(){return cr||(cr=1,(function(){var t,s,h=function(m,e){for(var r in e)u.call(e,r)&&(m[r]=e[r]);function i(){this.constructor=m}return i.prototype=e.prototype,m.prototype=new i,m.__super__=e.prototype,m},u={}.hasOwnProperty;s=ye(),t=ue(),ot.exports=function(m){h(e,m);function e(r,i,f,N,D,E){if(e.__super__.constructor.call(this,r),i==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(f==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(i));if(!N)throw new Error("Missing DTD attribute type. "+this.debugInfo(i));if(!D)throw new Error("Missing DTD attribute default. "+this.debugInfo(i));if(D.indexOf("#")!==0&&(D="#"+D),!D.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(i));if(E&&!D.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(i));this.elementName=this.stringify.name(i),this.type=t.AttributeDeclaration,this.attributeName=this.stringify.name(f),this.attributeType=this.stringify.dtdAttType(N),E&&(this.defaultValue=this.stringify.dtdAttDefault(E)),this.defaultValueType=D}return e.prototype.toString=function(r){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(r))},e}(s)}).call(K)),ot.exports}var st={exports:{}},lr;function Bt(){return lr||(lr=1,(function(){var t,s,h,u=function(e,r){for(var i in r)m.call(r,i)&&(e[i]=r[i]);function f(){this.constructor=e}return f.prototype=r.prototype,e.prototype=new f,e.__super__=r.prototype,e},m={}.hasOwnProperty;h=Te().isObject,s=ye(),t=ue(),st.exports=function(e){u(r,e);function r(i,f,N,D){if(r.__super__.constructor.call(this,i),N==null)throw new Error("Missing DTD entity name. "+this.debugInfo(N));if(D==null)throw new Error("Missing DTD entity value. "+this.debugInfo(N));if(this.pe=!!f,this.name=this.stringify.name(N),this.type=t.EntityDeclaration,!h(D))this.value=this.stringify.dtdEntityValue(D),this.internal=!0;else{if(!D.pubID&&!D.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(N));if(D.pubID&&!D.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(N));if(this.internal=!1,D.pubID!=null&&(this.pubID=this.stringify.dtdPubID(D.pubID)),D.sysID!=null&&(this.sysID=this.stringify.dtdSysID(D.sysID)),D.nData!=null&&(this.nData=this.stringify.dtdNData(D.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(N))}}return Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return null}}),r.prototype.toString=function(i){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(i))},r}(s)}).call(K)),st.exports}var at={exports:{}},pr;function Rt(){return pr||(pr=1,(function(){var t,s,h=function(m,e){for(var r in e)u.call(e,r)&&(m[r]=e[r]);function i(){this.constructor=m}return i.prototype=e.prototype,m.prototype=new i,m.__super__=e.prototype,m},u={}.hasOwnProperty;s=ye(),t=ue(),at.exports=function(m){h(e,m);function e(r,i,f){if(e.__super__.constructor.call(this,r),i==null)throw new Error("Missing DTD element name. "+this.debugInfo());f||(f="(#PCDATA)"),Array.isArray(f)&&(f="("+f.join(",")+")"),this.name=this.stringify.name(i),this.type=t.ElementDeclaration,this.value=this.stringify.dtdElementValue(f)}return e.prototype.toString=function(r){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(r))},e}(s)}).call(K)),at.exports}var ut={exports:{}},fr;function Xt(){return fr||(fr=1,(function(){var t,s,h=function(m,e){for(var r in e)u.call(e,r)&&(m[r]=e[r]);function i(){this.constructor=m}return i.prototype=e.prototype,m.prototype=new i,m.__super__=e.prototype,m},u={}.hasOwnProperty;s=ye(),t=ue(),ut.exports=function(m){h(e,m);function e(r,i,f){if(e.__super__.constructor.call(this,r),i==null)throw new Error("Missing DTD notation name. "+this.debugInfo(i));if(!f.pubID&&!f.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(i));this.name=this.stringify.name(i),this.type=t.NotationDeclaration,f.pubID!=null&&(this.pubID=this.stringify.dtdPubID(f.pubID)),f.sysID!=null&&(this.sysID=this.stringify.dtdSysID(f.sysID))}return Object.defineProperty(e.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(e.prototype,"systemId",{get:function(){return this.sysID}}),e.prototype.toString=function(r){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(r))},e}(s)}).call(K)),ut.exports}var hr;function kt(){return hr||(hr=1,(function(){var t,s,h,u,m,e,r,i,f=function(D,E){for(var x in E)N.call(E,x)&&(D[x]=E[x]);function C(){this.constructor=D}return C.prototype=E.prototype,D.prototype=new C,D.__super__=E.prototype,D},N={}.hasOwnProperty;i=Te().isObject,r=ye(),t=ue(),s=Ft(),u=Bt(),h=Rt(),m=Xt(),e=Mt(),it.exports=function(D){f(E,D);function E(x,C,O){var F,B,I,T,l,d;if(E.__super__.constructor.call(this,x),this.type=t.DocType,x.children){for(T=x.children,B=0,I=T.length;B<I;B++)if(F=T[B],F.type===t.Element){this.name=F.name;break}}this.documentObject=x,i(C)&&(l=C,C=l.pubID,O=l.sysID),O==null&&(d=[C,O],O=d[0],C=d[1]),C!=null&&(this.pubID=this.stringify.dtdPubID(C)),O!=null&&(this.sysID=this.stringify.dtdSysID(O))}return Object.defineProperty(E.prototype,"entities",{get:function(){var x,C,O,F,B;for(F={},B=this.children,C=0,O=B.length;C<O;C++)x=B[C],x.type===t.EntityDeclaration&&!x.pe&&(F[x.name]=x);return new e(F)}}),Object.defineProperty(E.prototype,"notations",{get:function(){var x,C,O,F,B;for(F={},B=this.children,C=0,O=B.length;C<O;C++)x=B[C],x.type===t.NotationDeclaration&&(F[x.name]=x);return new e(F)}}),Object.defineProperty(E.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(E.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(E.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),E.prototype.element=function(x,C){var O;return O=new h(this,x,C),this.children.push(O),this},E.prototype.attList=function(x,C,O,F,B){var I;return I=new s(this,x,C,O,F,B),this.children.push(I),this},E.prototype.entity=function(x,C){var O;return O=new u(this,!1,x,C),this.children.push(O),this},E.prototype.pEntity=function(x,C){var O;return O=new u(this,!0,x,C),this.children.push(O),this},E.prototype.notation=function(x,C){var O;return O=new m(this,x,C),this.children.push(O),this},E.prototype.toString=function(x){return this.options.writer.docType(this,this.options.writer.filterOptions(x))},E.prototype.ele=function(x,C){return this.element(x,C)},E.prototype.att=function(x,C,O,F,B){return this.attList(x,C,O,F,B)},E.prototype.ent=function(x,C){return this.entity(x,C)},E.prototype.pent=function(x,C){return this.pEntity(x,C)},E.prototype.not=function(x,C){return this.notation(x,C)},E.prototype.up=function(){return this.root()||this.documentObject},E.prototype.isEqualNode=function(x){return!(!E.__super__.isEqualNode.apply(this,arguments).isEqualNode(x)||x.name!==this.name||x.publicId!==this.publicId||x.systemId!==this.systemId)},E}(r)}).call(K)),it.exports}var ct={exports:{}},dr;function Ut(){return dr||(dr=1,(function(){var t,s,h=function(m,e){for(var r in e)u.call(e,r)&&(m[r]=e[r]);function i(){this.constructor=m}return i.prototype=e.prototype,m.prototype=new i,m.__super__=e.prototype,m},u={}.hasOwnProperty;t=ue(),s=ye(),ct.exports=function(m){h(e,m);function e(r,i){if(e.__super__.constructor.call(this,r),i==null)throw new Error("Missing raw text. "+this.debugInfo());this.type=t.Raw,this.value=this.stringify.raw(i)}return e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(r){return this.options.writer.raw(this,this.options.writer.filterOptions(r))},e}(s)}).call(K)),ct.exports}var lt={exports:{}},mr;function Vt(){return mr||(mr=1,(function(){var t,s,h=function(m,e){for(var r in e)u.call(e,r)&&(m[r]=e[r]);function i(){this.constructor=m}return i.prototype=e.prototype,m.prototype=new i,m.__super__=e.prototype,m},u={}.hasOwnProperty;t=ue(),s=ke(),lt.exports=function(m){h(e,m);function e(r,i){if(e.__super__.constructor.call(this,r),i==null)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=t.Text,this.value=this.stringify.text(i)}return Object.defineProperty(e.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(e.prototype,"wholeText",{get:function(){var r,i,f;for(f="",i=this.previousSibling;i;)f=i.data+f,i=i.previousSibling;for(f+=this.data,r=this.nextSibling;r;)f=f+r.data,r=r.nextSibling;return f}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(r){return this.options.writer.text(this,this.options.writer.filterOptions(r))},e.prototype.splitText=function(r){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.replaceWholeText=function(r){throw new Error("This DOM method is not implemented."+this.debugInfo())},e}(s)}).call(K)),lt.exports}var pt={exports:{}},gr;function jt(){return gr||(gr=1,(function(){var t,s,h=function(m,e){for(var r in e)u.call(e,r)&&(m[r]=e[r]);function i(){this.constructor=m}return i.prototype=e.prototype,m.prototype=new i,m.__super__=e.prototype,m},u={}.hasOwnProperty;t=ue(),s=ke(),pt.exports=function(m){h(e,m);function e(r,i,f){if(e.__super__.constructor.call(this,r),i==null)throw new Error("Missing instruction target. "+this.debugInfo());this.type=t.ProcessingInstruction,this.target=this.stringify.insTarget(i),this.name=this.target,f&&(this.value=this.stringify.insValue(f))}return e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(r){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(r))},e.prototype.isEqualNode=function(r){return!(!e.__super__.isEqualNode.apply(this,arguments).isEqualNode(r)||r.target!==this.target)},e}(s)}).call(K)),pt.exports}var ft={exports:{}},yr;function zr(){return yr||(yr=1,(function(){var t,s,h=function(m,e){for(var r in e)u.call(e,r)&&(m[r]=e[r]);function i(){this.constructor=m}return i.prototype=e.prototype,m.prototype=new i,m.__super__=e.prototype,m},u={}.hasOwnProperty;s=ye(),t=ue(),ft.exports=function(m){h(e,m);function e(r){e.__super__.constructor.call(this,r),this.type=t.Dummy}return e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(r){return""},e}(s)}).call(K)),ft.exports}var ht={exports:{}},wr;function dn(){return wr||(wr=1,(function(){ht.exports=function(){function t(s){this.nodes=s}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.item=function(s){return this.nodes[s]||null},t}()}).call(K)),ht.exports}var dt={exports:{}},br;function mn(){return br||(br=1,(function(){dt.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(K)),dt.exports}var Er;function ye(){return Er||(Er=1,(function(){var t,s,h,u,m,e,r,i,f,N,D,E,x,C,O,F,B,I={}.hasOwnProperty;B=Te(),F=B.isObject,O=B.isFunction,C=B.isEmpty,x=B.getValue,i=null,h=null,u=null,m=null,e=null,D=null,E=null,N=null,r=null,s=null,f=null,t=null,He.exports=function(){function T(l){this.parent=l,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,i||(i=Ot(),h=St(),u=Lt(),m=Pt(),e=kt(),D=Ut(),E=Vt(),N=jt(),r=zr(),s=ue(),f=dn(),Mt(),t=mn())}return Object.defineProperty(T.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(T.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(T.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(T.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(T.prototype,"childNodes",{get:function(){return(!this.childNodeList||!this.childNodeList.nodes)&&(this.childNodeList=new f(this.children)),this.childNodeList}}),Object.defineProperty(T.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(T.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(T.prototype,"previousSibling",{get:function(){var l;return l=this.parent.children.indexOf(this),this.parent.children[l-1]||null}}),Object.defineProperty(T.prototype,"nextSibling",{get:function(){var l;return l=this.parent.children.indexOf(this),this.parent.children[l+1]||null}}),Object.defineProperty(T.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(T.prototype,"textContent",{get:function(){var l,d,b,S,L;if(this.nodeType===s.Element||this.nodeType===s.DocumentFragment){for(L="",S=this.children,d=0,b=S.length;d<b;d++)l=S[d],l.textContent&&(L+=l.textContent);return L}else return null},set:function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),T.prototype.setParent=function(l){var d,b,S,L,y;for(this.parent=l,l&&(this.options=l.options,this.stringify=l.stringify),L=this.children,y=[],b=0,S=L.length;b<S;b++)d=L[b],y.push(d.setParent(this));return y},T.prototype.element=function(l,d,b){var S,L,y,a,_,P,X,U,$,z,H;if(P=null,d===null&&b==null&&($=[{},null],d=$[0],b=$[1]),d==null&&(d={}),d=x(d),F(d)||(z=[d,b],b=z[0],d=z[1]),l!=null&&(l=x(l)),Array.isArray(l))for(y=0,X=l.length;y<X;y++)L=l[y],P=this.element(L);else if(O(l))P=this.element(l.apply());else if(F(l)){for(_ in l)if(I.call(l,_))if(H=l[_],O(H)&&(H=H.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&_.indexOf(this.stringify.convertAttKey)===0)P=this.attribute(_.substr(this.stringify.convertAttKey.length),H);else if(!this.options.separateArrayItems&&Array.isArray(H)&&C(H))P=this.dummy();else if(F(H)&&C(H))P=this.element(_);else if(!this.options.keepNullNodes&&H==null)P=this.dummy();else if(!this.options.separateArrayItems&&Array.isArray(H))for(a=0,U=H.length;a<U;a++)L=H[a],S={},S[_]=L,P=this.element(S);else F(H)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&_.indexOf(this.stringify.convertTextKey)===0?P=this.element(H):(P=this.element(_),P.element(H)):P=this.element(_,H)}else!this.options.keepNullNodes&&b===null?P=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&l.indexOf(this.stringify.convertTextKey)===0?P=this.text(b):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&l.indexOf(this.stringify.convertCDataKey)===0?P=this.cdata(b):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&l.indexOf(this.stringify.convertCommentKey)===0?P=this.comment(b):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&l.indexOf(this.stringify.convertRawKey)===0?P=this.raw(b):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&l.indexOf(this.stringify.convertPIKey)===0?P=this.instruction(l.substr(this.stringify.convertPIKey.length),b):P=this.node(l,d,b);if(P==null)throw new Error("Could not create any elements with: "+l+". "+this.debugInfo());return P},T.prototype.insertBefore=function(l,d,b){var S,L,y,a,_;if(l!=null&&l.type)return y=l,a=d,y.setParent(this),a?(L=children.indexOf(a),_=children.splice(L),children.push(y),Array.prototype.push.apply(children,_)):children.push(y),y;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(l));return L=this.parent.children.indexOf(this),_=this.parent.children.splice(L),S=this.parent.element(l,d,b),Array.prototype.push.apply(this.parent.children,_),S},T.prototype.insertAfter=function(l,d,b){var S,L,y;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(l));return L=this.parent.children.indexOf(this),y=this.parent.children.splice(L+1),S=this.parent.element(l,d,b),Array.prototype.push.apply(this.parent.children,y),S},T.prototype.remove=function(){var l;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return l=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[l,l-l+1].concat([])),this.parent},T.prototype.node=function(l,d,b){var S,L;return l!=null&&(l=x(l)),d||(d={}),d=x(d),F(d)||(L=[d,b],b=L[0],d=L[1]),S=new i(this,l,d),b!=null&&S.text(b),this.children.push(S),S},T.prototype.text=function(l){var d;return F(l)&&this.element(l),d=new E(this,l),this.children.push(d),this},T.prototype.cdata=function(l){var d;return d=new h(this,l),this.children.push(d),this},T.prototype.comment=function(l){var d;return d=new u(this,l),this.children.push(d),this},T.prototype.commentBefore=function(l){var d,b;return d=this.parent.children.indexOf(this),b=this.parent.children.splice(d),this.parent.comment(l),Array.prototype.push.apply(this.parent.children,b),this},T.prototype.commentAfter=function(l){var d,b;return d=this.parent.children.indexOf(this),b=this.parent.children.splice(d+1),this.parent.comment(l),Array.prototype.push.apply(this.parent.children,b),this},T.prototype.raw=function(l){var d;return d=new D(this,l),this.children.push(d),this},T.prototype.dummy=function(){var l;return l=new r(this),l},T.prototype.instruction=function(l,d){var b,S,L,y,a;if(l!=null&&(l=x(l)),d!=null&&(d=x(d)),Array.isArray(l))for(y=0,a=l.length;y<a;y++)b=l[y],this.instruction(b);else if(F(l))for(b in l)I.call(l,b)&&(S=l[b],this.instruction(b,S));else O(d)&&(d=d.apply()),L=new N(this,l,d),this.children.push(L);return this},T.prototype.instructionBefore=function(l,d){var b,S;return b=this.parent.children.indexOf(this),S=this.parent.children.splice(b),this.parent.instruction(l,d),Array.prototype.push.apply(this.parent.children,S),this},T.prototype.instructionAfter=function(l,d){var b,S;return b=this.parent.children.indexOf(this),S=this.parent.children.splice(b+1),this.parent.instruction(l,d),Array.prototype.push.apply(this.parent.children,S),this},T.prototype.declaration=function(l,d,b){var S,L;return S=this.document(),L=new m(S,l,d,b),S.children.length===0?S.children.unshift(L):S.children[0].type===s.Declaration?S.children[0]=L:S.children.unshift(L),S.root()||S},T.prototype.dtd=function(l,d){var b,S,L,y,a,_,P,X,U,$;for(S=this.document(),L=new e(S,l,d),U=S.children,y=a=0,P=U.length;a<P;y=++a)if(b=U[y],b.type===s.DocType)return S.children[y]=L,L;for($=S.children,y=_=0,X=$.length;_<X;y=++_)if(b=$[y],b.isRoot)return S.children.splice(y,0,L),L;return S.children.push(L),L},T.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},T.prototype.root=function(){var l;for(l=this;l;){if(l.type===s.Document)return l.rootObject;if(l.isRoot)return l;l=l.parent}},T.prototype.document=function(){var l;for(l=this;l;){if(l.type===s.Document)return l;l=l.parent}},T.prototype.end=function(l){return this.document().end(l)},T.prototype.prev=function(){var l;if(l=this.parent.children.indexOf(this),l<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[l-1]},T.prototype.next=function(){var l;if(l=this.parent.children.indexOf(this),l===-1||l===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[l+1]},T.prototype.importDocument=function(l){var d;return d=l.root().clone(),d.parent=this,d.isRoot=!1,this.children.push(d),this},T.prototype.debugInfo=function(l){var d,b;return l=l||this.name,l==null&&!((d=this.parent)!=null&&d.name)?"":l==null?"parent: <"+this.parent.name+">":(b=this.parent)!=null&&b.name?"node: <"+l+">, parent: <"+this.parent.name+">":"node: <"+l+">"},T.prototype.ele=function(l,d,b){return this.element(l,d,b)},T.prototype.nod=function(l,d,b){return this.node(l,d,b)},T.prototype.txt=function(l){return this.text(l)},T.prototype.dat=function(l){return this.cdata(l)},T.prototype.com=function(l){return this.comment(l)},T.prototype.ins=function(l,d){return this.instruction(l,d)},T.prototype.doc=function(){return this.document()},T.prototype.dec=function(l,d,b){return this.declaration(l,d,b)},T.prototype.e=function(l,d,b){return this.element(l,d,b)},T.prototype.n=function(l,d,b){return this.node(l,d,b)},T.prototype.t=function(l){return this.text(l)},T.prototype.d=function(l){return this.cdata(l)},T.prototype.c=function(l){return this.comment(l)},T.prototype.r=function(l){return this.raw(l)},T.prototype.i=function(l,d){return this.instruction(l,d)},T.prototype.u=function(){return this.up()},T.prototype.importXMLBuilder=function(l){return this.importDocument(l)},T.prototype.replaceChild=function(l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.removeChild=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.appendChild=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.hasChildNodes=function(){return this.children.length!==0},T.prototype.cloneNode=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.isSupported=function(l,d){return!0},T.prototype.hasAttributes=function(){return this.attribs.length!==0},T.prototype.compareDocumentPosition=function(l){var d,b;return d=this,d===l?0:this.document()!==l.document()?(b=t.Disconnected|t.ImplementationSpecific,Math.random()<.5?b|=t.Preceding:b|=t.Following,b):d.isAncestor(l)?t.Contains|t.Preceding:d.isDescendant(l)?t.Contains|t.Following:d.isPreceding(l)?t.Preceding:t.Following},T.prototype.isSameNode=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.lookupPrefix=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.isDefaultNamespace=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.lookupNamespaceURI=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.isEqualNode=function(l){var d,b,S;if(l.nodeType!==this.nodeType||l.children.length!==this.children.length)return!1;for(d=b=0,S=this.children.length-1;0<=S?b<=S:b>=S;d=0<=S?++b:--b)if(!this.children[d].isEqualNode(l.children[d]))return!1;return!0},T.prototype.getFeature=function(l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.setUserData=function(l,d,b){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.getUserData=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.contains=function(l){return l?l===this||this.isDescendant(l):!1},T.prototype.isDescendant=function(l){var d,b,S,L,y;for(y=this.children,S=0,L=y.length;S<L;S++)if(d=y[S],l===d||(b=d.isDescendant(l),b))return!0;return!1},T.prototype.isAncestor=function(l){return l.isDescendant(this)},T.prototype.isPreceding=function(l){var d,b;return d=this.treePosition(l),b=this.treePosition(this),d===-1||b===-1?!1:d<b},T.prototype.isFollowing=function(l){var d,b;return d=this.treePosition(l),b=this.treePosition(this),d===-1||b===-1?!1:d>b},T.prototype.treePosition=function(l){var d,b;return b=0,d=!1,this.foreachTreeNode(this.document(),function(S){if(b++,!d&&S===l)return d=!0}),d?b:-1},T.prototype.foreachTreeNode=function(l,d){var b,S,L,y,a;for(l||(l=this.document()),y=l.children,S=0,L=y.length;S<L;S++){if(b=y[S],a=d(b))return a;if(a=this.foreachTreeNode(b,d),a)return a}},T}()}).call(K)),He.exports}var mt={exports:{}},Dr;function Hr(){return Dr||(Dr=1,(function(){var t=function(h,u){return function(){return h.apply(u,arguments)}},s={}.hasOwnProperty;mt.exports=function(){function h(u){this.assertLegalName=t(this.assertLegalName,this),this.assertLegalChar=t(this.assertLegalChar,this);var m,e,r;u||(u={}),this.options=u,this.options.version||(this.options.version="1.0"),e=u.stringify||{};for(m in e)s.call(e,m)&&(r=e[m],this[m]=r)}return h.prototype.name=function(u){return this.options.noValidation?u:this.assertLegalName(""+u||"")},h.prototype.text=function(u){return this.options.noValidation?u:this.assertLegalChar(this.textEscape(""+u||""))},h.prototype.cdata=function(u){return this.options.noValidation?u:(u=""+u||"",u=u.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(u))},h.prototype.comment=function(u){if(this.options.noValidation)return u;if(u=""+u||"",u.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+u);return this.assertLegalChar(u)},h.prototype.raw=function(u){return this.options.noValidation?u:""+u||""},h.prototype.attValue=function(u){return this.options.noValidation?u:this.assertLegalChar(this.attEscape(u=""+u||""))},h.prototype.insTarget=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},h.prototype.insValue=function(u){if(this.options.noValidation)return u;if(u=""+u||"",u.match(/\?>/))throw new Error("Invalid processing instruction value: "+u);return this.assertLegalChar(u)},h.prototype.xmlVersion=function(u){if(this.options.noValidation)return u;if(u=""+u||"",!u.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+u);return u},h.prototype.xmlEncoding=function(u){if(this.options.noValidation)return u;if(u=""+u||"",!u.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+u);return this.assertLegalChar(u)},h.prototype.xmlStandalone=function(u){return this.options.noValidation?u:u?"yes":"no"},h.prototype.dtdPubID=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},h.prototype.dtdSysID=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},h.prototype.dtdElementValue=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},h.prototype.dtdAttType=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},h.prototype.dtdAttDefault=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},h.prototype.dtdEntityValue=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},h.prototype.dtdNData=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},h.prototype.convertAttKey="@",h.prototype.convertPIKey="?",h.prototype.convertTextKey="#text",h.prototype.convertCDataKey="#cdata",h.prototype.convertCommentKey="#comment",h.prototype.convertRawKey="#raw",h.prototype.assertLegalChar=function(u){var m,e;if(this.options.noValidation)return u;if(m="",this.options.version==="1.0"){if(m=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,e=u.match(m))throw new Error("Invalid character in string: "+u+" at index "+e.index)}else if(this.options.version==="1.1"&&(m=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,e=u.match(m)))throw new Error("Invalid character in string: "+u+" at index "+e.index);return u},h.prototype.assertLegalName=function(u){var m;if(this.options.noValidation)return u;if(this.assertLegalChar(u),m=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!u.match(m))throw new Error("Invalid character in name");return u},h.prototype.textEscape=function(u){var m;return this.options.noValidation?u:(m=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,u.replace(m,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},h.prototype.attEscape=function(u){var m;return this.options.noValidation?u:(m=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,u.replace(m,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},h}()}).call(K)),mt.exports}var gt={exports:{}},yt={exports:{}},wt={exports:{}},Nr;function Ue(){return Nr||(Nr=1,(function(){wt.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(K)),wt.exports}var xr;function Jr(){return xr||(xr=1,(function(){var t,s,h,u={}.hasOwnProperty;h=Te().assign,t=ue(),Pt(),kt(),St(),Lt(),Ot(),Ut(),Vt(),jt(),zr(),Ft(),Rt(),Bt(),Xt(),s=Ue(),yt.exports=function(){function m(e){var r,i,f;e||(e={}),this.options=e,i=e.writer||{};for(r in i)u.call(i,r)&&(f=i[r],this["_"+r]=this[r],this[r]=f)}return m.prototype.filterOptions=function(e){var r,i,f,N,D,E,x,C;return e||(e={}),e=h({},this.options,e),r={writer:this},r.pretty=e.pretty||!1,r.allowEmpty=e.allowEmpty||!1,r.indent=(i=e.indent)!=null?i:"  ",r.newline=(f=e.newline)!=null?f:`
`,r.offset=(N=e.offset)!=null?N:0,r.dontPrettyTextNodes=(D=(E=e.dontPrettyTextNodes)!=null?E:e.dontprettytextnodes)!=null?D:0,r.spaceBeforeSlash=(x=(C=e.spaceBeforeSlash)!=null?C:e.spacebeforeslash)!=null?x:"",r.spaceBeforeSlash===!0&&(r.spaceBeforeSlash=" "),r.suppressPrettyCount=0,r.user={},r.state=s.None,r},m.prototype.indent=function(e,r,i){var f;return!r.pretty||r.suppressPrettyCount?"":r.pretty&&(f=(i||0)+r.offset+1,f>0)?new Array(f).join(r.indent):""},m.prototype.endline=function(e,r,i){return!r.pretty||r.suppressPrettyCount?"":r.newline},m.prototype.attribute=function(e,r,i){var f;return this.openAttribute(e,r,i),f=" "+e.name+'="'+e.value+'"',this.closeAttribute(e,r,i),f},m.prototype.cdata=function(e,r,i){var f;return this.openNode(e,r,i),r.state=s.OpenTag,f=this.indent(e,r,i)+"<![CDATA[",r.state=s.InsideTag,f+=e.value,r.state=s.CloseTag,f+="]]>"+this.endline(e,r,i),r.state=s.None,this.closeNode(e,r,i),f},m.prototype.comment=function(e,r,i){var f;return this.openNode(e,r,i),r.state=s.OpenTag,f=this.indent(e,r,i)+"<!-- ",r.state=s.InsideTag,f+=e.value,r.state=s.CloseTag,f+=" -->"+this.endline(e,r,i),r.state=s.None,this.closeNode(e,r,i),f},m.prototype.declaration=function(e,r,i){var f;return this.openNode(e,r,i),r.state=s.OpenTag,f=this.indent(e,r,i)+"<?xml",r.state=s.InsideTag,f+=' version="'+e.version+'"',e.encoding!=null&&(f+=' encoding="'+e.encoding+'"'),e.standalone!=null&&(f+=' standalone="'+e.standalone+'"'),r.state=s.CloseTag,f+=r.spaceBeforeSlash+"?>",f+=this.endline(e,r,i),r.state=s.None,this.closeNode(e,r,i),f},m.prototype.docType=function(e,r,i){var f,N,D,E,x;if(i||(i=0),this.openNode(e,r,i),r.state=s.OpenTag,E=this.indent(e,r,i),E+="<!DOCTYPE "+e.root().name,e.pubID&&e.sysID?E+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(E+=' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(E+=" [",E+=this.endline(e,r,i),r.state=s.InsideTag,x=e.children,N=0,D=x.length;N<D;N++)f=x[N],E+=this.writeChildNode(f,r,i+1);r.state=s.CloseTag,E+="]"}return r.state=s.CloseTag,E+=r.spaceBeforeSlash+">",E+=this.endline(e,r,i),r.state=s.None,this.closeNode(e,r,i),E},m.prototype.element=function(e,r,i){var f,N,D,E,x,C,O,F,B,I,T,l,d,b;i||(i=0),I=!1,T="",this.openNode(e,r,i),r.state=s.OpenTag,T+=this.indent(e,r,i)+"<"+e.name,l=e.attribs;for(B in l)u.call(l,B)&&(f=l[B],T+=this.attribute(f,r,i));if(D=e.children.length,E=D===0?null:e.children[0],D===0||e.children.every(function(S){return(S.type===t.Text||S.type===t.Raw)&&S.value===""}))r.allowEmpty?(T+=">",r.state=s.CloseTag,T+="</"+e.name+">"+this.endline(e,r,i)):(r.state=s.CloseTag,T+=r.spaceBeforeSlash+"/>"+this.endline(e,r,i));else if(r.pretty&&D===1&&(E.type===t.Text||E.type===t.Raw)&&E.value!=null)T+=">",r.state=s.InsideTag,r.suppressPrettyCount++,I=!0,T+=this.writeChildNode(E,r,i+1),r.suppressPrettyCount--,I=!1,r.state=s.CloseTag,T+="</"+e.name+">"+this.endline(e,r,i);else{if(r.dontPrettyTextNodes){for(d=e.children,x=0,O=d.length;x<O;x++)if(N=d[x],(N.type===t.Text||N.type===t.Raw)&&N.value!=null){r.suppressPrettyCount++,I=!0;break}}for(T+=">"+this.endline(e,r,i),r.state=s.InsideTag,b=e.children,C=0,F=b.length;C<F;C++)N=b[C],T+=this.writeChildNode(N,r,i+1);r.state=s.CloseTag,T+=this.indent(e,r,i)+"</"+e.name+">",I&&r.suppressPrettyCount--,T+=this.endline(e,r,i),r.state=s.None}return this.closeNode(e,r,i),T},m.prototype.writeChildNode=function(e,r,i){switch(e.type){case t.CData:return this.cdata(e,r,i);case t.Comment:return this.comment(e,r,i);case t.Element:return this.element(e,r,i);case t.Raw:return this.raw(e,r,i);case t.Text:return this.text(e,r,i);case t.ProcessingInstruction:return this.processingInstruction(e,r,i);case t.Dummy:return"";case t.Declaration:return this.declaration(e,r,i);case t.DocType:return this.docType(e,r,i);case t.AttributeDeclaration:return this.dtdAttList(e,r,i);case t.ElementDeclaration:return this.dtdElement(e,r,i);case t.EntityDeclaration:return this.dtdEntity(e,r,i);case t.NotationDeclaration:return this.dtdNotation(e,r,i);default:throw new Error("Unknown XML node type: "+e.constructor.name)}},m.prototype.processingInstruction=function(e,r,i){var f;return this.openNode(e,r,i),r.state=s.OpenTag,f=this.indent(e,r,i)+"<?",r.state=s.InsideTag,f+=e.target,e.value&&(f+=" "+e.value),r.state=s.CloseTag,f+=r.spaceBeforeSlash+"?>",f+=this.endline(e,r,i),r.state=s.None,this.closeNode(e,r,i),f},m.prototype.raw=function(e,r,i){var f;return this.openNode(e,r,i),r.state=s.OpenTag,f=this.indent(e,r,i),r.state=s.InsideTag,f+=e.value,r.state=s.CloseTag,f+=this.endline(e,r,i),r.state=s.None,this.closeNode(e,r,i),f},m.prototype.text=function(e,r,i){var f;return this.openNode(e,r,i),r.state=s.OpenTag,f=this.indent(e,r,i),r.state=s.InsideTag,f+=e.value,r.state=s.CloseTag,f+=this.endline(e,r,i),r.state=s.None,this.closeNode(e,r,i),f},m.prototype.dtdAttList=function(e,r,i){var f;return this.openNode(e,r,i),r.state=s.OpenTag,f=this.indent(e,r,i)+"<!ATTLIST",r.state=s.InsideTag,f+=" "+e.elementName+" "+e.attributeName+" "+e.attributeType,e.defaultValueType!=="#DEFAULT"&&(f+=" "+e.defaultValueType),e.defaultValue&&(f+=' "'+e.defaultValue+'"'),r.state=s.CloseTag,f+=r.spaceBeforeSlash+">"+this.endline(e,r,i),r.state=s.None,this.closeNode(e,r,i),f},m.prototype.dtdElement=function(e,r,i){var f;return this.openNode(e,r,i),r.state=s.OpenTag,f=this.indent(e,r,i)+"<!ELEMENT",r.state=s.InsideTag,f+=" "+e.name+" "+e.value,r.state=s.CloseTag,f+=r.spaceBeforeSlash+">"+this.endline(e,r,i),r.state=s.None,this.closeNode(e,r,i),f},m.prototype.dtdEntity=function(e,r,i){var f;return this.openNode(e,r,i),r.state=s.OpenTag,f=this.indent(e,r,i)+"<!ENTITY",r.state=s.InsideTag,e.pe&&(f+=" %"),f+=" "+e.name,e.value?f+=' "'+e.value+'"':(e.pubID&&e.sysID?f+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(f+=' SYSTEM "'+e.sysID+'"'),e.nData&&(f+=" NDATA "+e.nData)),r.state=s.CloseTag,f+=r.spaceBeforeSlash+">"+this.endline(e,r,i),r.state=s.None,this.closeNode(e,r,i),f},m.prototype.dtdNotation=function(e,r,i){var f;return this.openNode(e,r,i),r.state=s.OpenTag,f=this.indent(e,r,i)+"<!NOTATION",r.state=s.InsideTag,f+=" "+e.name,e.pubID&&e.sysID?f+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.pubID?f+=' PUBLIC "'+e.pubID+'"':e.sysID&&(f+=' SYSTEM "'+e.sysID+'"'),r.state=s.CloseTag,f+=r.spaceBeforeSlash+">"+this.endline(e,r,i),r.state=s.None,this.closeNode(e,r,i),f},m.prototype.openNode=function(e,r,i){},m.prototype.closeNode=function(e,r,i){},m.prototype.openAttribute=function(e,r,i){},m.prototype.closeAttribute=function(e,r,i){},m}()}).call(K)),yt.exports}var vr;function qt(){return vr||(vr=1,(function(){var t,s=function(u,m){for(var e in m)h.call(m,e)&&(u[e]=m[e]);function r(){this.constructor=u}return r.prototype=m.prototype,u.prototype=new r,u.__super__=m.prototype,u},h={}.hasOwnProperty;t=Jr(),gt.exports=function(u){s(m,u);function m(e){m.__super__.constructor.call(this,e)}return m.prototype.document=function(e,r){var i,f,N,D,E;for(r=this.filterOptions(r),D="",E=e.children,f=0,N=E.length;f<N;f++)i=E[f],D+=this.writeChildNode(i,r,0);return r.pretty&&D.slice(-r.newline.length)===r.newline&&(D=D.slice(0,-r.newline.length)),D},m}(t)}).call(K)),gt.exports}var Tr;function Kr(){return Tr||(Tr=1,(function(){var t,s,h,u,m,e,r,i=function(N,D){for(var E in D)f.call(D,E)&&(N[E]=D[E]);function x(){this.constructor=N}return x.prototype=D.prototype,N.prototype=new x,N.__super__=D.prototype,N},f={}.hasOwnProperty;r=Te().isPlainObject,h=Wr(),s=hn(),u=ye(),t=ue(),e=Hr(),m=qt(),Ge.exports=function(N){i(D,N);function D(E){D.__super__.constructor.call(this,null),this.name="#document",this.type=t.Document,this.documentURI=null,this.domConfig=new s,E||(E={}),E.writer||(E.writer=new m),this.options=E,this.stringify=new e(E)}return Object.defineProperty(D.prototype,"implementation",{value:new h}),Object.defineProperty(D.prototype,"doctype",{get:function(){var E,x,C,O;for(O=this.children,x=0,C=O.length;x<C;x++)if(E=O[x],E.type===t.DocType)return E;return null}}),Object.defineProperty(D.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(D.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(D.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(D.prototype,"xmlEncoding",{get:function(){return this.children.length!==0&&this.children[0].type===t.Declaration?this.children[0].encoding:null}}),Object.defineProperty(D.prototype,"xmlStandalone",{get:function(){return this.children.length!==0&&this.children[0].type===t.Declaration?this.children[0].standalone==="yes":!1}}),Object.defineProperty(D.prototype,"xmlVersion",{get:function(){return this.children.length!==0&&this.children[0].type===t.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(D.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(D.prototype,"origin",{get:function(){return null}}),Object.defineProperty(D.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(D.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(D.prototype,"contentType",{get:function(){return null}}),D.prototype.end=function(E){var x;return x={},E?r(E)&&(x=E,E=this.options.writer):E=this.options.writer,E.document(this,E.filterOptions(x))},D.prototype.toString=function(E){return this.options.writer.document(this,this.options.writer.filterOptions(E))},D.prototype.createElement=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createTextNode=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createComment=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createCDATASection=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createProcessingInstruction=function(E,x){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createAttribute=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createEntityReference=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.getElementsByTagName=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.importNode=function(E,x){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createElementNS=function(E,x){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createAttributeNS=function(E,x){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.getElementsByTagNameNS=function(E,x){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.getElementById=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.adoptNode=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.renameNode=function(E,x,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.getElementsByClassName=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createEvent=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createNodeIterator=function(E,x,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.createTreeWalker=function(E,x,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},D}(u)}).call(K)),Ge.exports}var bt={exports:{}},Ir;function gn(){return Ir||(Ir=1,(function(){var t,s,h,u,m,e,r,i,f,N,D,E,x,C,O,F,B,I,T,l,d,b,S,L={}.hasOwnProperty;S=Te(),d=S.isObject,l=S.isFunction,b=S.isPlainObject,T=S.getValue,t=ue(),E=Kr(),x=Ot(),u=St(),m=Lt(),O=Ut(),I=Vt(),C=jt(),N=Pt(),D=kt(),e=Ft(),i=Bt(),r=Rt(),f=Xt(),h=Yr(),B=Hr(),F=qt(),s=Ue(),bt.exports=function(){function y(a,_,P){var X;this.name="?xml",this.type=t.Document,a||(a={}),X={},a.writer?b(a.writer)&&(X=a.writer,a.writer=new F):a.writer=new F,this.options=a,this.writer=a.writer,this.writerOptions=this.writer.filterOptions(X),this.stringify=new B(a),this.onDataCallback=_||function(){},this.onEndCallback=P||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return y.prototype.createChildNode=function(a){var _,P,X,U,$,z,H,Y;switch(a.type){case t.CData:this.cdata(a.value);break;case t.Comment:this.comment(a.value);break;case t.Element:X={},H=a.attribs;for(P in H)L.call(H,P)&&(_=H[P],X[P]=_.value);this.node(a.name,X);break;case t.Dummy:this.dummy();break;case t.Raw:this.raw(a.value);break;case t.Text:this.text(a.value);break;case t.ProcessingInstruction:this.instruction(a.target,a.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+a.constructor.name)}for(Y=a.children,$=0,z=Y.length;$<z;$++)U=Y[$],this.createChildNode(U),U.type===t.Element&&this.up();return this},y.prototype.dummy=function(){return this},y.prototype.node=function(a,_,P){var X;if(a==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(a));return this.openCurrent(),a=T(a),_==null&&(_={}),_=T(_),d(_)||(X=[_,P],P=X[0],_=X[1]),this.currentNode=new x(this,a,_),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,P!=null&&this.text(P),this},y.prototype.element=function(a,_,P){var X,U,$,z,H,Y;if(this.currentNode&&this.currentNode.type===t.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(a)||d(a)||l(a))for(z=this.options.noValidation,this.options.noValidation=!0,Y=new E(this.options).element("TEMP_ROOT"),Y.element(a),this.options.noValidation=z,H=Y.children,U=0,$=H.length;U<$;U++)X=H[U],this.createChildNode(X),X.type===t.Element&&this.up();else this.node(a,_,P);return this},y.prototype.attribute=function(a,_){var P,X;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(a));if(a!=null&&(a=T(a)),d(a))for(P in a)L.call(a,P)&&(X=a[P],this.attribute(P,X));else l(_)&&(_=_.apply()),this.options.keepNullAttributes&&_==null?this.currentNode.attribs[a]=new h(this,a,""):_!=null&&(this.currentNode.attribs[a]=new h(this,a,_));return this},y.prototype.text=function(a){var _;return this.openCurrent(),_=new I(this,a),this.onData(this.writer.text(_,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},y.prototype.cdata=function(a){var _;return this.openCurrent(),_=new u(this,a),this.onData(this.writer.cdata(_,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},y.prototype.comment=function(a){var _;return this.openCurrent(),_=new m(this,a),this.onData(this.writer.comment(_,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},y.prototype.raw=function(a){var _;return this.openCurrent(),_=new O(this,a),this.onData(this.writer.raw(_,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},y.prototype.instruction=function(a,_){var P,X,U,$,z;if(this.openCurrent(),a!=null&&(a=T(a)),_!=null&&(_=T(_)),Array.isArray(a))for(P=0,$=a.length;P<$;P++)X=a[P],this.instruction(X);else if(d(a))for(X in a)L.call(a,X)&&(U=a[X],this.instruction(X,U));else l(_)&&(_=_.apply()),z=new C(this,a,_),this.onData(this.writer.processingInstruction(z,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},y.prototype.declaration=function(a,_,P){var X;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return X=new N(this,a,_,P),this.onData(this.writer.declaration(X,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},y.prototype.doctype=function(a,_,P){if(this.openCurrent(),a==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new D(this,_,P),this.currentNode.rootNodeName=a,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},y.prototype.dtdElement=function(a,_){var P;return this.openCurrent(),P=new r(this,a,_),this.onData(this.writer.dtdElement(P,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},y.prototype.attList=function(a,_,P,X,U){var $;return this.openCurrent(),$=new e(this,a,_,P,X,U),this.onData(this.writer.dtdAttList($,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},y.prototype.entity=function(a,_){var P;return this.openCurrent(),P=new i(this,!1,a,_),this.onData(this.writer.dtdEntity(P,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},y.prototype.pEntity=function(a,_){var P;return this.openCurrent(),P=new i(this,!0,a,_),this.onData(this.writer.dtdEntity(P,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},y.prototype.notation=function(a,_){var P;return this.openCurrent(),P=new f(this,a,_),this.onData(this.writer.dtdNotation(P,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},y.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},y.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},y.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},y.prototype.openNode=function(a){var _,P,X,U;if(!a.isOpen){if(!this.root&&this.currentLevel===0&&a.type===t.Element&&(this.root=a),P="",a.type===t.Element){this.writerOptions.state=s.OpenTag,P=this.writer.indent(a,this.writerOptions,this.currentLevel)+"<"+a.name,U=a.attribs;for(X in U)L.call(U,X)&&(_=U[X],P+=this.writer.attribute(_,this.writerOptions,this.currentLevel));P+=(a.children?">":"/>")+this.writer.endline(a,this.writerOptions,this.currentLevel),this.writerOptions.state=s.InsideTag}else this.writerOptions.state=s.OpenTag,P=this.writer.indent(a,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+a.rootNodeName,a.pubID&&a.sysID?P+=' PUBLIC "'+a.pubID+'" "'+a.sysID+'"':a.sysID&&(P+=' SYSTEM "'+a.sysID+'"'),a.children?(P+=" [",this.writerOptions.state=s.InsideTag):(this.writerOptions.state=s.CloseTag,P+=">"),P+=this.writer.endline(a,this.writerOptions,this.currentLevel);return this.onData(P,this.currentLevel),a.isOpen=!0}},y.prototype.closeNode=function(a){var _;if(!a.isClosed)return _="",this.writerOptions.state=s.CloseTag,a.type===t.Element?_=this.writer.indent(a,this.writerOptions,this.currentLevel)+"</"+a.name+">"+this.writer.endline(a,this.writerOptions,this.currentLevel):_=this.writer.indent(a,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(a,this.writerOptions,this.currentLevel),this.writerOptions.state=s.None,this.onData(_,this.currentLevel),a.isClosed=!0},y.prototype.onData=function(a,_){return this.documentStarted=!0,this.onDataCallback(a,_+1)},y.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},y.prototype.debugInfo=function(a){return a==null?"":"node: <"+a+">"},y.prototype.ele=function(){return this.element.apply(this,arguments)},y.prototype.nod=function(a,_,P){return this.node(a,_,P)},y.prototype.txt=function(a){return this.text(a)},y.prototype.dat=function(a){return this.cdata(a)},y.prototype.com=function(a){return this.comment(a)},y.prototype.ins=function(a,_){return this.instruction(a,_)},y.prototype.dec=function(a,_,P){return this.declaration(a,_,P)},y.prototype.dtd=function(a,_,P){return this.doctype(a,_,P)},y.prototype.e=function(a,_,P){return this.element(a,_,P)},y.prototype.n=function(a,_,P){return this.node(a,_,P)},y.prototype.t=function(a){return this.text(a)},y.prototype.d=function(a){return this.cdata(a)},y.prototype.c=function(a){return this.comment(a)},y.prototype.r=function(a){return this.raw(a)},y.prototype.i=function(a,_){return this.instruction(a,_)},y.prototype.att=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},y.prototype.a=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},y.prototype.ent=function(a,_){return this.entity(a,_)},y.prototype.pent=function(a,_){return this.pEntity(a,_)},y.prototype.not=function(a,_){return this.notation(a,_)},y}()}).call(K)),bt.exports}var Et={exports:{}},Ar;function yn(){return Ar||(Ar=1,(function(){var t,s,h,u=function(e,r){for(var i in r)m.call(r,i)&&(e[i]=r[i]);function f(){this.constructor=e}return f.prototype=r.prototype,e.prototype=new f,e.__super__=r.prototype,e},m={}.hasOwnProperty;t=ue(),h=Jr(),s=Ue(),Et.exports=function(e){u(r,e);function r(i,f){this.stream=i,r.__super__.constructor.call(this,f)}return r.prototype.endline=function(i,f,N){return i.isLastRootNode&&f.state===s.CloseTag?"":r.__super__.endline.call(this,i,f,N)},r.prototype.document=function(i,f){var N,D,E,x,C,O,F,B,I;for(F=i.children,D=E=0,C=F.length;E<C;D=++E)N=F[D],N.isLastRootNode=D===i.children.length-1;for(f=this.filterOptions(f),B=i.children,I=[],x=0,O=B.length;x<O;x++)N=B[x],I.push(this.writeChildNode(N,f,0));return I},r.prototype.attribute=function(i,f,N){return this.stream.write(r.__super__.attribute.call(this,i,f,N))},r.prototype.cdata=function(i,f,N){return this.stream.write(r.__super__.cdata.call(this,i,f,N))},r.prototype.comment=function(i,f,N){return this.stream.write(r.__super__.comment.call(this,i,f,N))},r.prototype.declaration=function(i,f,N){return this.stream.write(r.__super__.declaration.call(this,i,f,N))},r.prototype.docType=function(i,f,N){var D,E,x,C;if(N||(N=0),this.openNode(i,f,N),f.state=s.OpenTag,this.stream.write(this.indent(i,f,N)),this.stream.write("<!DOCTYPE "+i.root().name),i.pubID&&i.sysID?this.stream.write(' PUBLIC "'+i.pubID+'" "'+i.sysID+'"'):i.sysID&&this.stream.write(' SYSTEM "'+i.sysID+'"'),i.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(i,f,N)),f.state=s.InsideTag,C=i.children,E=0,x=C.length;E<x;E++)D=C[E],this.writeChildNode(D,f,N+1);f.state=s.CloseTag,this.stream.write("]")}return f.state=s.CloseTag,this.stream.write(f.spaceBeforeSlash+">"),this.stream.write(this.endline(i,f,N)),f.state=s.None,this.closeNode(i,f,N)},r.prototype.element=function(i,f,N){var D,E,x,C,O,F,B,I,T;N||(N=0),this.openNode(i,f,N),f.state=s.OpenTag,this.stream.write(this.indent(i,f,N)+"<"+i.name),I=i.attribs;for(B in I)m.call(I,B)&&(D=I[B],this.attribute(D,f,N));if(x=i.children.length,C=x===0?null:i.children[0],x===0||i.children.every(function(l){return(l.type===t.Text||l.type===t.Raw)&&l.value===""}))f.allowEmpty?(this.stream.write(">"),f.state=s.CloseTag,this.stream.write("</"+i.name+">")):(f.state=s.CloseTag,this.stream.write(f.spaceBeforeSlash+"/>"));else if(f.pretty&&x===1&&(C.type===t.Text||C.type===t.Raw)&&C.value!=null)this.stream.write(">"),f.state=s.InsideTag,f.suppressPrettyCount++,this.writeChildNode(C,f,N+1),f.suppressPrettyCount--,f.state=s.CloseTag,this.stream.write("</"+i.name+">");else{for(this.stream.write(">"+this.endline(i,f,N)),f.state=s.InsideTag,T=i.children,O=0,F=T.length;O<F;O++)E=T[O],this.writeChildNode(E,f,N+1);f.state=s.CloseTag,this.stream.write(this.indent(i,f,N)+"</"+i.name+">")}return this.stream.write(this.endline(i,f,N)),f.state=s.None,this.closeNode(i,f,N)},r.prototype.processingInstruction=function(i,f,N){return this.stream.write(r.__super__.processingInstruction.call(this,i,f,N))},r.prototype.raw=function(i,f,N){return this.stream.write(r.__super__.raw.call(this,i,f,N))},r.prototype.text=function(i,f,N){return this.stream.write(r.__super__.text.call(this,i,f,N))},r.prototype.dtdAttList=function(i,f,N){return this.stream.write(r.__super__.dtdAttList.call(this,i,f,N))},r.prototype.dtdElement=function(i,f,N){return this.stream.write(r.__super__.dtdElement.call(this,i,f,N))},r.prototype.dtdEntity=function(i,f,N){return this.stream.write(r.__super__.dtdEntity.call(this,i,f,N))},r.prototype.dtdNotation=function(i,f,N){return this.stream.write(r.__super__.dtdNotation.call(this,i,f,N))},r}(h)}).call(K)),Et.exports}var Cr;function wn(){return Cr||(Cr=1,(function(){var t,s,h,u,m,e,r,i,f,N;N=Te(),i=N.assign,f=N.isFunction,h=Wr(),u=Kr(),m=gn(),r=qt(),e=yn(),t=ue(),s=Ue(),De.create=function(D,E,x,C){var O,F;if(D==null)throw new Error("Root element needs a name.");return C=i({},E,x,C),O=new u(C),F=O.element(D),C.headless||(O.declaration(C),(C.pubID!=null||C.sysID!=null)&&O.dtd(C)),F},De.begin=function(D,E,x){var C;return f(D)&&(C=[D,E],E=C[0],x=C[1],D={}),E?new m(D,E,x):new u(D)},De.stringWriter=function(D){return new r(D)},De.streamWriter=function(D,E){return new e(D,E)},De.implementation=new h,De.nodeType=t,De.writerState=s}).call(K)),De}var _r;function bn(){return _r||(_r=1,(function(){var t,s,h,u,m,e={}.hasOwnProperty;t=wn(),s=_t().defaults,u=function(r){return typeof r=="string"&&(r.indexOf("&")>=0||r.indexOf(">")>=0||r.indexOf("<")>=0)},m=function(r){return"<![CDATA["+h(r)+"]]>"},h=function(r){return r.replace("]]>","]]]]><![CDATA[>")},qe.Builder=function(){function r(i){var f,N,D;this.options={},N=s["0.2"];for(f in N)e.call(N,f)&&(D=N[f],this.options[f]=D);for(f in i)e.call(i,f)&&(D=i[f],this.options[f]=D)}return r.prototype.buildObject=function(i){var f,N,D,E,x;return f=this.options.attrkey,N=this.options.charkey,Object.keys(i).length===1&&this.options.rootName===s["0.2"].rootName?(x=Object.keys(i)[0],i=i[x]):x=this.options.rootName,D=function(C){return function(O,F){var B,I,T,l,d,b;if(typeof F!="object")C.options.cdata&&u(F)?O.raw(m(F)):O.txt(F);else if(Array.isArray(F)){for(l in F)if(e.call(F,l)){I=F[l];for(d in I)T=I[d],O=D(O.ele(d),T).up()}}else for(d in F)if(e.call(F,d))if(I=F[d],d===f){if(typeof I=="object")for(B in I)b=I[B],O=O.att(B,b)}else if(d===N)C.options.cdata&&u(I)?O=O.raw(m(I)):O=O.txt(I);else if(Array.isArray(I))for(l in I)e.call(I,l)&&(T=I[l],typeof T=="string"?C.options.cdata&&u(T)?O=O.ele(d).raw(m(T)).up():O=O.ele(d,T).up():O=D(O.ele(d),T).up());else typeof I=="object"?O=D(O.ele(d),I).up():typeof I=="string"&&C.options.cdata&&u(I)?O=O.ele(d).raw(m(I)).up():(I==null&&(I=""),O=O.ele(d,I.toString()).up());return O}}(this),E=t.create(x,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),D(E,i).end(this.options.renderOpts)},r}()}).call(K)),qe}var Dt={},Nt={};const En={},Dn=Object.freeze(Object.defineProperty({__proto__:null,default:En},Symbol.toStringTag,{value:"Module"})),Qr=en(Dn);var xt={},Pe={exports:{}},vt={},Fe={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Mr;function Nn(){return Mr||(Mr=1,Fe.read=function(t,s,h,u,m){var e,r,i=m*8-u-1,f=(1<<i)-1,N=f>>1,D=-7,E=h?m-1:0,x=h?-1:1,C=t[s+E];for(E+=x,e=C&(1<<-D)-1,C>>=-D,D+=i;D>0;e=e*256+t[s+E],E+=x,D-=8);for(r=e&(1<<-D)-1,e>>=-D,D+=u;D>0;r=r*256+t[s+E],E+=x,D-=8);if(e===0)e=1-N;else{if(e===f)return r?NaN:(C?-1:1)*(1/0);r=r+Math.pow(2,u),e=e-N}return(C?-1:1)*r*Math.pow(2,e-u)},Fe.write=function(t,s,h,u,m,e){var r,i,f,N=e*8-m-1,D=(1<<N)-1,E=D>>1,x=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,C=u?0:e-1,O=u?1:-1,F=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(i=isNaN(s)?1:0,r=D):(r=Math.floor(Math.log(s)/Math.LN2),s*(f=Math.pow(2,-r))<1&&(r--,f*=2),r+E>=1?s+=x/f:s+=x*Math.pow(2,1-E),s*f>=2&&(r++,f/=2),r+E>=D?(i=0,r=D):r+E>=1?(i=(s*f-1)*Math.pow(2,m),r=r+E):(i=s*Math.pow(2,E-1)*Math.pow(2,m),r=0));m>=8;t[h+C]=i&255,C+=O,i/=256,m-=8);for(r=r<<m|i,N+=m;N>0;t[h+C]=r&255,C+=O,r/=256,N-=8);t[h+C-O]|=F*128}),Fe}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Or;function xn(){return Or||(Or=1,function(t){var s=tn,h=Nn(),u=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=i,t.SlowBuffer=T,t.INSPECT_MAX_BYTES=50;var m=2147483647;t.kMaxLength=m,i.TYPED_ARRAY_SUPPORT=e(),!i.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function e(){try{var g=new Uint8Array(1),n={foo:function(){return 42}};return Object.setPrototypeOf(n,Uint8Array.prototype),Object.setPrototypeOf(g,n),g.foo()===42}catch{return!1}}Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}});function r(g){if(g>m)throw new RangeError('The value "'+g+'" is invalid for option "size"');var n=new Uint8Array(g);return Object.setPrototypeOf(n,i.prototype),n}function i(g,n,o){if(typeof g=="number"){if(typeof n=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return E(g)}return f(g,n,o)}i.poolSize=8192;function f(g,n,o){if(typeof g=="string")return x(g,n);if(ArrayBuffer.isView(g))return O(g);if(g==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g);if(q(g,ArrayBuffer)||g&&q(g.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(q(g,SharedArrayBuffer)||g&&q(g.buffer,SharedArrayBuffer)))return F(g,n,o);if(typeof g=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var w=g.valueOf&&g.valueOf();if(w!=null&&w!==g)return i.from(w,n,o);var A=B(g);if(A)return A;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof g[Symbol.toPrimitive]=="function")return i.from(g[Symbol.toPrimitive]("string"),n,o);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g)}i.from=function(g,n,o){return f(g,n,o)},Object.setPrototypeOf(i.prototype,Uint8Array.prototype),Object.setPrototypeOf(i,Uint8Array);function N(g){if(typeof g!="number")throw new TypeError('"size" argument must be of type number');if(g<0)throw new RangeError('The value "'+g+'" is invalid for option "size"')}function D(g,n,o){return N(g),g<=0?r(g):n!==void 0?typeof o=="string"?r(g).fill(n,o):r(g).fill(n):r(g)}i.alloc=function(g,n,o){return D(g,n,o)};function E(g){return N(g),r(g<0?0:I(g)|0)}i.allocUnsafe=function(g){return E(g)},i.allocUnsafeSlow=function(g){return E(g)};function x(g,n){if((typeof n!="string"||n==="")&&(n="utf8"),!i.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var o=l(g,n)|0,w=r(o),A=w.write(g,n);return A!==o&&(w=w.slice(0,A)),w}function C(g){for(var n=g.length<0?0:I(g.length)|0,o=r(n),w=0;w<n;w+=1)o[w]=g[w]&255;return o}function O(g){if(q(g,Uint8Array)){var n=new Uint8Array(g);return F(n.buffer,n.byteOffset,n.byteLength)}return C(g)}function F(g,n,o){if(n<0||g.byteLength<n)throw new RangeError('"offset" is outside of buffer bounds');if(g.byteLength<n+(o||0))throw new RangeError('"length" is outside of buffer bounds');var w;return n===void 0&&o===void 0?w=new Uint8Array(g):o===void 0?w=new Uint8Array(g,n):w=new Uint8Array(g,n,o),Object.setPrototypeOf(w,i.prototype),w}function B(g){if(i.isBuffer(g)){var n=I(g.length)|0,o=r(n);return o.length===0||g.copy(o,0,0,n),o}if(g.length!==void 0)return typeof g.length!="number"||G(g.length)?r(0):C(g);if(g.type==="Buffer"&&Array.isArray(g.data))return C(g.data)}function I(g){if(g>=m)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+m.toString(16)+" bytes");return g|0}function T(g){return+g!=g&&(g=0),i.alloc(+g)}i.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==i.prototype},i.compare=function(n,o){if(q(n,Uint8Array)&&(n=i.from(n,n.offset,n.byteLength)),q(o,Uint8Array)&&(o=i.from(o,o.offset,o.byteLength)),!i.isBuffer(n)||!i.isBuffer(o))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===o)return 0;for(var w=n.length,A=o.length,R=0,k=Math.min(w,A);R<k;++R)if(n[R]!==o[R]){w=n[R],A=o[R];break}return w<A?-1:A<w?1:0},i.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(n,o){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return i.alloc(0);var w;if(o===void 0)for(o=0,w=0;w<n.length;++w)o+=n[w].length;var A=i.allocUnsafe(o),R=0;for(w=0;w<n.length;++w){var k=n[w];if(q(k,Uint8Array))R+k.length>A.length?i.from(k).copy(A,R):Uint8Array.prototype.set.call(A,k,R);else if(i.isBuffer(k))k.copy(A,R);else throw new TypeError('"list" argument must be an Array of Buffers');R+=k.length}return A};function l(g,n){if(i.isBuffer(g))return g.length;if(ArrayBuffer.isView(g)||q(g,ArrayBuffer))return g.byteLength;if(typeof g!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof g);var o=g.length,w=arguments.length>2&&arguments[2]===!0;if(!w&&o===0)return 0;for(var A=!1;;)switch(n){case"ascii":case"latin1":case"binary":return o;case"utf8":case"utf-8":return c(g).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o*2;case"hex":return o>>>1;case"base64":return V(g).length;default:if(A)return w?-1:c(g).length;n=(""+n).toLowerCase(),A=!0}}i.byteLength=l;function d(g,n,o){var w=!1;if((n===void 0||n<0)&&(n=0),n>this.length||((o===void 0||o>this.length)&&(o=this.length),o<=0)||(o>>>=0,n>>>=0,o<=n))return"";for(g||(g="utf8");;)switch(g){case"hex":return me(this,n,o);case"utf8":case"utf-8":return $(this,n,o);case"ascii":return Y(this,n,o);case"latin1":case"binary":return fe(this,n,o);case"base64":return U(this,n,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,n,o);default:if(w)throw new TypeError("Unknown encoding: "+g);g=(g+"").toLowerCase(),w=!0}}i.prototype._isBuffer=!0;function b(g,n,o){var w=g[n];g[n]=g[o],g[o]=w}i.prototype.swap16=function(){var n=this.length;if(n%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var o=0;o<n;o+=2)b(this,o,o+1);return this},i.prototype.swap32=function(){var n=this.length;if(n%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var o=0;o<n;o+=4)b(this,o,o+3),b(this,o+1,o+2);return this},i.prototype.swap64=function(){var n=this.length;if(n%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var o=0;o<n;o+=8)b(this,o,o+7),b(this,o+1,o+6),b(this,o+2,o+5),b(this,o+3,o+4);return this},i.prototype.toString=function(){var n=this.length;return n===0?"":arguments.length===0?$(this,0,n):d.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(n){if(!i.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:i.compare(this,n)===0},i.prototype.inspect=function(){var n="",o=t.INSPECT_MAX_BYTES;return n=this.toString("hex",0,o).replace(/(.{2})/g,"$1 ").trim(),this.length>o&&(n+=" ... "),"<Buffer "+n+">"},u&&(i.prototype[u]=i.prototype.inspect),i.prototype.compare=function(n,o,w,A,R){if(q(n,Uint8Array)&&(n=i.from(n,n.offset,n.byteLength)),!i.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(o===void 0&&(o=0),w===void 0&&(w=n?n.length:0),A===void 0&&(A=0),R===void 0&&(R=this.length),o<0||w>n.length||A<0||R>this.length)throw new RangeError("out of range index");if(A>=R&&o>=w)return 0;if(A>=R)return-1;if(o>=w)return 1;if(o>>>=0,w>>>=0,A>>>=0,R>>>=0,this===n)return 0;for(var k=R-A,Q=w-o,ee=Math.min(k,Q),oe=this.slice(A,R),le=n.slice(o,w),se=0;se<ee;++se)if(oe[se]!==le[se]){k=oe[se],Q=le[se];break}return k<Q?-1:Q<k?1:0};function S(g,n,o,w,A){if(g.length===0)return-1;if(typeof o=="string"?(w=o,o=0):o>2147483647?o=2147483647:o<-2147483648&&(o=-2147483648),o=+o,G(o)&&(o=A?0:g.length-1),o<0&&(o=g.length+o),o>=g.length){if(A)return-1;o=g.length-1}else if(o<0)if(A)o=0;else return-1;if(typeof n=="string"&&(n=i.from(n,w)),i.isBuffer(n))return n.length===0?-1:L(g,n,o,w,A);if(typeof n=="number")return n=n&255,typeof Uint8Array.prototype.indexOf=="function"?A?Uint8Array.prototype.indexOf.call(g,n,o):Uint8Array.prototype.lastIndexOf.call(g,n,o):L(g,[n],o,w,A);throw new TypeError("val must be string, number or Buffer")}function L(g,n,o,w,A){var R=1,k=g.length,Q=n.length;if(w!==void 0&&(w=String(w).toLowerCase(),w==="ucs2"||w==="ucs-2"||w==="utf16le"||w==="utf-16le")){if(g.length<2||n.length<2)return-1;R=2,k/=2,Q/=2,o/=2}function ee($t,Gt){return R===1?$t[Gt]:$t.readUInt16BE(Gt*R)}var oe;if(A){var le=-1;for(oe=o;oe<k;oe++)if(ee(g,oe)===ee(n,le===-1?0:oe-le)){if(le===-1&&(le=oe),oe-le+1===Q)return le*R}else le!==-1&&(oe-=oe-le),le=-1}else for(o+Q>k&&(o=k-Q),oe=o;oe>=0;oe--){for(var se=!0,Le=0;Le<Q;Le++)if(ee(g,oe+Le)!==ee(n,Le)){se=!1;break}if(se)return oe}return-1}i.prototype.includes=function(n,o,w){return this.indexOf(n,o,w)!==-1},i.prototype.indexOf=function(n,o,w){return S(this,n,o,w,!0)},i.prototype.lastIndexOf=function(n,o,w){return S(this,n,o,w,!1)};function y(g,n,o,w){o=Number(o)||0;var A=g.length-o;w?(w=Number(w),w>A&&(w=A)):w=A;var R=n.length;w>R/2&&(w=R/2);for(var k=0;k<w;++k){var Q=parseInt(n.substr(k*2,2),16);if(G(Q))return k;g[o+k]=Q}return k}function a(g,n,o,w){return j(c(n,g.length-o),g,o,w)}function _(g,n,o,w){return j(M(n),g,o,w)}function P(g,n,o,w){return j(V(n),g,o,w)}function X(g,n,o,w){return j(v(n,g.length-o),g,o,w)}i.prototype.write=function(n,o,w,A){if(o===void 0)A="utf8",w=this.length,o=0;else if(w===void 0&&typeof o=="string")A=o,w=this.length,o=0;else if(isFinite(o))o=o>>>0,isFinite(w)?(w=w>>>0,A===void 0&&(A="utf8")):(A=w,w=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var R=this.length-o;if((w===void 0||w>R)&&(w=R),n.length>0&&(w<0||o<0)||o>this.length)throw new RangeError("Attempt to write outside buffer bounds");A||(A="utf8");for(var k=!1;;)switch(A){case"hex":return y(this,n,o,w);case"utf8":case"utf-8":return a(this,n,o,w);case"ascii":case"latin1":case"binary":return _(this,n,o,w);case"base64":return P(this,n,o,w);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,n,o,w);default:if(k)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),k=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(g,n,o){return n===0&&o===g.length?s.fromByteArray(g):s.fromByteArray(g.slice(n,o))}function $(g,n,o){o=Math.min(g.length,o);for(var w=[],A=n;A<o;){var R=g[A],k=null,Q=R>239?4:R>223?3:R>191?2:1;if(A+Q<=o){var ee,oe,le,se;switch(Q){case 1:R<128&&(k=R);break;case 2:ee=g[A+1],(ee&192)===128&&(se=(R&31)<<6|ee&63,se>127&&(k=se));break;case 3:ee=g[A+1],oe=g[A+2],(ee&192)===128&&(oe&192)===128&&(se=(R&15)<<12|(ee&63)<<6|oe&63,se>2047&&(se<55296||se>57343)&&(k=se));break;case 4:ee=g[A+1],oe=g[A+2],le=g[A+3],(ee&192)===128&&(oe&192)===128&&(le&192)===128&&(se=(R&15)<<18|(ee&63)<<12|(oe&63)<<6|le&63,se>65535&&se<1114112&&(k=se))}}k===null?(k=65533,Q=1):k>65535&&(k-=65536,w.push(k>>>10&1023|55296),k=56320|k&1023),w.push(k),A+=Q}return H(w)}var z=4096;function H(g){var n=g.length;if(n<=z)return String.fromCharCode.apply(String,g);for(var o="",w=0;w<n;)o+=String.fromCharCode.apply(String,g.slice(w,w+=z));return o}function Y(g,n,o){var w="";o=Math.min(g.length,o);for(var A=n;A<o;++A)w+=String.fromCharCode(g[A]&127);return w}function fe(g,n,o){var w="";o=Math.min(g.length,o);for(var A=n;A<o;++A)w+=String.fromCharCode(g[A]);return w}function me(g,n,o){var w=g.length;(!n||n<0)&&(n=0),(!o||o<0||o>w)&&(o=w);for(var A="",R=n;R<o;++R)A+=ne[g[R]];return A}function ie(g,n,o){for(var w=g.slice(n,o),A="",R=0;R<w.length-1;R+=2)A+=String.fromCharCode(w[R]+w[R+1]*256);return A}i.prototype.slice=function(n,o){var w=this.length;n=~~n,o=o===void 0?w:~~o,n<0?(n+=w,n<0&&(n=0)):n>w&&(n=w),o<0?(o+=w,o<0&&(o=0)):o>w&&(o=w),o<n&&(o=n);var A=this.subarray(n,o);return Object.setPrototypeOf(A,i.prototype),A};function Z(g,n,o){if(g%1!==0||g<0)throw new RangeError("offset is not uint");if(g+n>o)throw new RangeError("Trying to access beyond buffer length")}i.prototype.readUintLE=i.prototype.readUIntLE=function(n,o,w){n=n>>>0,o=o>>>0,w||Z(n,o,this.length);for(var A=this[n],R=1,k=0;++k<o&&(R*=256);)A+=this[n+k]*R;return A},i.prototype.readUintBE=i.prototype.readUIntBE=function(n,o,w){n=n>>>0,o=o>>>0,w||Z(n,o,this.length);for(var A=this[n+--o],R=1;o>0&&(R*=256);)A+=this[n+--o]*R;return A},i.prototype.readUint8=i.prototype.readUInt8=function(n,o){return n=n>>>0,o||Z(n,1,this.length),this[n]},i.prototype.readUint16LE=i.prototype.readUInt16LE=function(n,o){return n=n>>>0,o||Z(n,2,this.length),this[n]|this[n+1]<<8},i.prototype.readUint16BE=i.prototype.readUInt16BE=function(n,o){return n=n>>>0,o||Z(n,2,this.length),this[n]<<8|this[n+1]},i.prototype.readUint32LE=i.prototype.readUInt32LE=function(n,o){return n=n>>>0,o||Z(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216},i.prototype.readUint32BE=i.prototype.readUInt32BE=function(n,o){return n=n>>>0,o||Z(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])},i.prototype.readIntLE=function(n,o,w){n=n>>>0,o=o>>>0,w||Z(n,o,this.length);for(var A=this[n],R=1,k=0;++k<o&&(R*=256);)A+=this[n+k]*R;return R*=128,A>=R&&(A-=Math.pow(2,8*o)),A},i.prototype.readIntBE=function(n,o,w){n=n>>>0,o=o>>>0,w||Z(n,o,this.length);for(var A=o,R=1,k=this[n+--A];A>0&&(R*=256);)k+=this[n+--A]*R;return R*=128,k>=R&&(k-=Math.pow(2,8*o)),k},i.prototype.readInt8=function(n,o){return n=n>>>0,o||Z(n,1,this.length),this[n]&128?(255-this[n]+1)*-1:this[n]},i.prototype.readInt16LE=function(n,o){n=n>>>0,o||Z(n,2,this.length);var w=this[n]|this[n+1]<<8;return w&32768?w|4294901760:w},i.prototype.readInt16BE=function(n,o){n=n>>>0,o||Z(n,2,this.length);var w=this[n+1]|this[n]<<8;return w&32768?w|4294901760:w},i.prototype.readInt32LE=function(n,o){return n=n>>>0,o||Z(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},i.prototype.readInt32BE=function(n,o){return n=n>>>0,o||Z(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},i.prototype.readFloatLE=function(n,o){return n=n>>>0,o||Z(n,4,this.length),h.read(this,n,!0,23,4)},i.prototype.readFloatBE=function(n,o){return n=n>>>0,o||Z(n,4,this.length),h.read(this,n,!1,23,4)},i.prototype.readDoubleLE=function(n,o){return n=n>>>0,o||Z(n,8,this.length),h.read(this,n,!0,52,8)},i.prototype.readDoubleBE=function(n,o){return n=n>>>0,o||Z(n,8,this.length),h.read(this,n,!1,52,8)};function re(g,n,o,w,A,R){if(!i.isBuffer(g))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>A||n<R)throw new RangeError('"value" argument is out of bounds');if(o+w>g.length)throw new RangeError("Index out of range")}i.prototype.writeUintLE=i.prototype.writeUIntLE=function(n,o,w,A){if(n=+n,o=o>>>0,w=w>>>0,!A){var R=Math.pow(2,8*w)-1;re(this,n,o,w,R,0)}var k=1,Q=0;for(this[o]=n&255;++Q<w&&(k*=256);)this[o+Q]=n/k&255;return o+w},i.prototype.writeUintBE=i.prototype.writeUIntBE=function(n,o,w,A){if(n=+n,o=o>>>0,w=w>>>0,!A){var R=Math.pow(2,8*w)-1;re(this,n,o,w,R,0)}var k=w-1,Q=1;for(this[o+k]=n&255;--k>=0&&(Q*=256);)this[o+k]=n/Q&255;return o+w},i.prototype.writeUint8=i.prototype.writeUInt8=function(n,o,w){return n=+n,o=o>>>0,w||re(this,n,o,1,255,0),this[o]=n&255,o+1},i.prototype.writeUint16LE=i.prototype.writeUInt16LE=function(n,o,w){return n=+n,o=o>>>0,w||re(this,n,o,2,65535,0),this[o]=n&255,this[o+1]=n>>>8,o+2},i.prototype.writeUint16BE=i.prototype.writeUInt16BE=function(n,o,w){return n=+n,o=o>>>0,w||re(this,n,o,2,65535,0),this[o]=n>>>8,this[o+1]=n&255,o+2},i.prototype.writeUint32LE=i.prototype.writeUInt32LE=function(n,o,w){return n=+n,o=o>>>0,w||re(this,n,o,4,4294967295,0),this[o+3]=n>>>24,this[o+2]=n>>>16,this[o+1]=n>>>8,this[o]=n&255,o+4},i.prototype.writeUint32BE=i.prototype.writeUInt32BE=function(n,o,w){return n=+n,o=o>>>0,w||re(this,n,o,4,4294967295,0),this[o]=n>>>24,this[o+1]=n>>>16,this[o+2]=n>>>8,this[o+3]=n&255,o+4},i.prototype.writeIntLE=function(n,o,w,A){if(n=+n,o=o>>>0,!A){var R=Math.pow(2,8*w-1);re(this,n,o,w,R-1,-R)}var k=0,Q=1,ee=0;for(this[o]=n&255;++k<w&&(Q*=256);)n<0&&ee===0&&this[o+k-1]!==0&&(ee=1),this[o+k]=(n/Q>>0)-ee&255;return o+w},i.prototype.writeIntBE=function(n,o,w,A){if(n=+n,o=o>>>0,!A){var R=Math.pow(2,8*w-1);re(this,n,o,w,R-1,-R)}var k=w-1,Q=1,ee=0;for(this[o+k]=n&255;--k>=0&&(Q*=256);)n<0&&ee===0&&this[o+k+1]!==0&&(ee=1),this[o+k]=(n/Q>>0)-ee&255;return o+w},i.prototype.writeInt8=function(n,o,w){return n=+n,o=o>>>0,w||re(this,n,o,1,127,-128),n<0&&(n=255+n+1),this[o]=n&255,o+1},i.prototype.writeInt16LE=function(n,o,w){return n=+n,o=o>>>0,w||re(this,n,o,2,32767,-32768),this[o]=n&255,this[o+1]=n>>>8,o+2},i.prototype.writeInt16BE=function(n,o,w){return n=+n,o=o>>>0,w||re(this,n,o,2,32767,-32768),this[o]=n>>>8,this[o+1]=n&255,o+2},i.prototype.writeInt32LE=function(n,o,w){return n=+n,o=o>>>0,w||re(this,n,o,4,2147483647,-2147483648),this[o]=n&255,this[o+1]=n>>>8,this[o+2]=n>>>16,this[o+3]=n>>>24,o+4},i.prototype.writeInt32BE=function(n,o,w){return n=+n,o=o>>>0,w||re(this,n,o,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),this[o]=n>>>24,this[o+1]=n>>>16,this[o+2]=n>>>8,this[o+3]=n&255,o+4};function de(g,n,o,w,A,R){if(o+w>g.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("Index out of range")}function ge(g,n,o,w,A){return n=+n,o=o>>>0,A||de(g,n,o,4),h.write(g,n,o,w,23,4),o+4}i.prototype.writeFloatLE=function(n,o,w){return ge(this,n,o,!0,w)},i.prototype.writeFloatBE=function(n,o,w){return ge(this,n,o,!1,w)};function Me(g,n,o,w,A){return n=+n,o=o>>>0,A||de(g,n,o,8),h.write(g,n,o,w,52,8),o+8}i.prototype.writeDoubleLE=function(n,o,w){return Me(this,n,o,!0,w)},i.prototype.writeDoubleBE=function(n,o,w){return Me(this,n,o,!1,w)},i.prototype.copy=function(n,o,w,A){if(!i.isBuffer(n))throw new TypeError("argument should be a Buffer");if(w||(w=0),!A&&A!==0&&(A=this.length),o>=n.length&&(o=n.length),o||(o=0),A>0&&A<w&&(A=w),A===w||n.length===0||this.length===0)return 0;if(o<0)throw new RangeError("targetStart out of bounds");if(w<0||w>=this.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),n.length-o<A-w&&(A=n.length-o+w);var R=A-w;return this===n&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(o,w,A):Uint8Array.prototype.set.call(n,this.subarray(w,A),o),R},i.prototype.fill=function(n,o,w,A){if(typeof n=="string"){if(typeof o=="string"?(A=o,o=0,w=this.length):typeof w=="string"&&(A=w,w=this.length),A!==void 0&&typeof A!="string")throw new TypeError("encoding must be a string");if(typeof A=="string"&&!i.isEncoding(A))throw new TypeError("Unknown encoding: "+A);if(n.length===1){var R=n.charCodeAt(0);(A==="utf8"&&R<128||A==="latin1")&&(n=R)}}else typeof n=="number"?n=n&255:typeof n=="boolean"&&(n=Number(n));if(o<0||this.length<o||this.length<w)throw new RangeError("Out of range index");if(w<=o)return this;o=o>>>0,w=w===void 0?this.length:w>>>0,n||(n=0);var k;if(typeof n=="number")for(k=o;k<w;++k)this[k]=n;else{var Q=i.isBuffer(n)?n:i.from(n,A),ee=Q.length;if(ee===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(k=0;k<w-o;++k)this[k+o]=Q[k%ee]}return this};var Se=/[^+/0-9A-Za-z-_]/g;function p(g){if(g=g.split("=")[0],g=g.trim().replace(Se,""),g.length<2)return"";for(;g.length%4!==0;)g=g+"=";return g}function c(g,n){n=n||1/0;for(var o,w=g.length,A=null,R=[],k=0;k<w;++k){if(o=g.charCodeAt(k),o>55295&&o<57344){if(!A){if(o>56319){(n-=3)>-1&&R.push(239,191,189);continue}else if(k+1===w){(n-=3)>-1&&R.push(239,191,189);continue}A=o;continue}if(o<56320){(n-=3)>-1&&R.push(239,191,189),A=o;continue}o=(A-55296<<10|o-56320)+65536}else A&&(n-=3)>-1&&R.push(239,191,189);if(A=null,o<128){if((n-=1)<0)break;R.push(o)}else if(o<2048){if((n-=2)<0)break;R.push(o>>6|192,o&63|128)}else if(o<65536){if((n-=3)<0)break;R.push(o>>12|224,o>>6&63|128,o&63|128)}else if(o<1114112){if((n-=4)<0)break;R.push(o>>18|240,o>>12&63|128,o>>6&63|128,o&63|128)}else throw new Error("Invalid code point")}return R}function M(g){for(var n=[],o=0;o<g.length;++o)n.push(g.charCodeAt(o)&255);return n}function v(g,n){for(var o,w,A,R=[],k=0;k<g.length&&!((n-=2)<0);++k)o=g.charCodeAt(k),w=o>>8,A=o%256,R.push(A),R.push(w);return R}function V(g){return s.toByteArray(p(g))}function j(g,n,o,w){for(var A=0;A<w&&!(A+o>=n.length||A>=g.length);++A)n[A+o]=g[A];return A}function q(g,n){return g instanceof n||g!=null&&g.constructor!=null&&g.constructor.name!=null&&g.constructor.name===n.name}function G(g){return g!==g}var ne=function(){for(var g="0123456789abcdef",n=new Array(256),o=0;o<16;++o)for(var w=o*16,A=0;A<16;++A)n[w+A]=g[o]+g[A];return n}()}(vt)),vt}var Sr;function vn(){return Sr||(Sr=1,function(t,s){var h=xn(),u=h.Buffer;function m(r,i){for(var f in r)i[f]=r[f]}u.from&&u.alloc&&u.allocUnsafe&&u.allocUnsafeSlow?t.exports=h:(m(h,s),s.Buffer=e);function e(r,i,f){return u(r,i,f)}m(u,e),e.from=function(r,i,f){if(typeof r=="number")throw new TypeError("Argument must not be a number");return u(r,i,f)},e.alloc=function(r,i,f){if(typeof r!="number")throw new TypeError("Argument must be a number");var N=u(r);return i!==void 0?typeof f=="string"?N.fill(i,f):N.fill(i):N.fill(0),N},e.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return u(r)},e.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return h.SlowBuffer(r)}}(Pe,Pe.exports)),Pe.exports}var Lr;function Tn(){if(Lr)return xt;Lr=1;var t=vn().Buffer,s=t.isEncoding||function(I){switch(I=""+I,I&&I.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function h(I){if(!I)return"utf8";for(var T;;)switch(I){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return I;default:if(T)return;I=(""+I).toLowerCase(),T=!0}}function u(I){var T=h(I);if(typeof T!="string"&&(t.isEncoding===s||!s(I)))throw new Error("Unknown encoding: "+I);return T||I}xt.StringDecoder=m;function m(I){this.encoding=u(I);var T;switch(this.encoding){case"utf16le":this.text=E,this.end=x,T=4;break;case"utf8":this.fillLast=f,T=4;break;case"base64":this.text=C,this.end=O,T=3;break;default:this.write=F,this.end=B;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(T)}m.prototype.write=function(I){if(I.length===0)return"";var T,l;if(this.lastNeed){if(T=this.fillLast(I),T===void 0)return"";l=this.lastNeed,this.lastNeed=0}else l=0;return l<I.length?T?T+this.text(I,l):this.text(I,l):T||""},m.prototype.end=D,m.prototype.text=N,m.prototype.fillLast=function(I){if(this.lastNeed<=I.length)return I.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);I.copy(this.lastChar,this.lastTotal-this.lastNeed,0,I.length),this.lastNeed-=I.length};function e(I){return I<=127?0:I>>5===6?2:I>>4===14?3:I>>3===30?4:I>>6===2?-1:-2}function r(I,T,l){var d=T.length-1;if(d<l)return 0;var b=e(T[d]);return b>=0?(b>0&&(I.lastNeed=b-1),b):--d<l||b===-2?0:(b=e(T[d]),b>=0?(b>0&&(I.lastNeed=b-2),b):--d<l||b===-2?0:(b=e(T[d]),b>=0?(b>0&&(b===2?b=0:I.lastNeed=b-3),b):0))}function i(I,T,l){if((T[0]&192)!==128)return I.lastNeed=0,"";if(I.lastNeed>1&&T.length>1){if((T[1]&192)!==128)return I.lastNeed=1,"";if(I.lastNeed>2&&T.length>2&&(T[2]&192)!==128)return I.lastNeed=2,""}}function f(I){var T=this.lastTotal-this.lastNeed,l=i(this,I);if(l!==void 0)return l;if(this.lastNeed<=I.length)return I.copy(this.lastChar,T,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);I.copy(this.lastChar,T,0,I.length),this.lastNeed-=I.length}function N(I,T){var l=r(this,I,T);if(!this.lastNeed)return I.toString("utf8",T);this.lastTotal=l;var d=I.length-(l-this.lastNeed);return I.copy(this.lastChar,0,d),I.toString("utf8",T,d)}function D(I){var T=I&&I.length?this.write(I):"";return this.lastNeed?T+"":T}function E(I,T){if((I.length-T)%2===0){var l=I.toString("utf16le",T);if(l){var d=l.charCodeAt(l.length-1);if(d>=55296&&d<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=I[I.length-2],this.lastChar[1]=I[I.length-1],l.slice(0,-1)}return l}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=I[I.length-1],I.toString("utf16le",T,I.length-1)}function x(I){var T=I&&I.length?this.write(I):"";if(this.lastNeed){var l=this.lastTotal-this.lastNeed;return T+this.lastChar.toString("utf16le",0,l)}return T}function C(I,T){var l=(I.length-T)%3;return l===0?I.toString("base64",T):(this.lastNeed=3-l,this.lastTotal=3,l===1?this.lastChar[0]=I[I.length-1]:(this.lastChar[0]=I[I.length-2],this.lastChar[1]=I[I.length-1]),I.toString("base64",T,I.length-l))}function O(I){var T=I&&I.length?this.write(I):"";return this.lastNeed?T+this.lastChar.toString("base64",0,3-this.lastNeed):T}function F(I){return I.toString(this.encoding)}function B(I){return I&&I.length?this.write(I):""}return xt}var Pr;function In(){return Pr||(Pr=1,function(t){(function(s){s.parser=function(p,c){return new u(p,c)},s.SAXParser=u,s.SAXStream=D,s.createStream=N,s.MAX_BUFFER_LENGTH=64*1024;var h=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];s.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function u(p,c){if(!(this instanceof u))return new u(p,c);var M=this;e(M),M.q=M.c="",M.bufferCheckPosition=s.MAX_BUFFER_LENGTH,M.opt=c||{},M.opt.lowercase=M.opt.lowercase||M.opt.lowercasetags,M.looseCase=M.opt.lowercase?"toLowerCase":"toUpperCase",M.tags=[],M.closed=M.closedRoot=M.sawRoot=!1,M.tag=M.error=null,M.strict=!!p,M.noscript=!!(p||M.opt.noscript),M.state=a.BEGIN,M.strictEntities=M.opt.strictEntities,M.ENTITIES=M.strictEntities?Object.create(s.XML_ENTITIES):Object.create(s.ENTITIES),M.attribList=[],M.opt.xmlns&&(M.ns=Object.create(F)),M.trackPosition=M.opt.position!==!1,M.trackPosition&&(M.position=M.line=M.column=0),P(M,"onready")}Object.create||(Object.create=function(p){function c(){}c.prototype=p;var M=new c;return M}),Object.keys||(Object.keys=function(p){var c=[];for(var M in p)p.hasOwnProperty(M)&&c.push(M);return c});function m(p){for(var c=Math.max(s.MAX_BUFFER_LENGTH,10),M=0,v=0,V=h.length;v<V;v++){var j=p[h[v]].length;if(j>c)switch(h[v]){case"textNode":U(p);break;case"cdata":X(p,"oncdata",p.cdata),p.cdata="";break;case"script":X(p,"onscript",p.script),p.script="";break;default:z(p,"Max buffer length exceeded: "+h[v])}M=Math.max(M,j)}var q=s.MAX_BUFFER_LENGTH-M;p.bufferCheckPosition=q+p.position}function e(p){for(var c=0,M=h.length;c<M;c++)p[h[c]]=""}function r(p){U(p),p.cdata!==""&&(X(p,"oncdata",p.cdata),p.cdata=""),p.script!==""&&(X(p,"onscript",p.script),p.script="")}u.prototype={end:function(){H(this)},write:Se,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){r(this)}};var i;try{i=Qr.Stream}catch{i=function(){}}i||(i=function(){});var f=s.EVENTS.filter(function(p){return p!=="error"&&p!=="end"});function N(p,c){return new D(p,c)}function D(p,c){if(!(this instanceof D))return new D(p,c);i.apply(this),this._parser=new u(p,c),this.writable=!0,this.readable=!0;var M=this;this._parser.onend=function(){M.emit("end")},this._parser.onerror=function(v){M.emit("error",v),M._parser.error=null},this._decoder=null,f.forEach(function(v){Object.defineProperty(M,"on"+v,{get:function(){return M._parser["on"+v]},set:function(V){if(!V)return M.removeAllListeners(v),M._parser["on"+v]=V,V;M.on(v,V)},enumerable:!0,configurable:!1})})}D.prototype=Object.create(i.prototype,{constructor:{value:D}}),D.prototype.write=function(p){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(p)){if(!this._decoder){var c=Tn().StringDecoder;this._decoder=new c("utf8")}p=this._decoder.write(p)}return this._parser.write(p.toString()),this.emit("data",p),!0},D.prototype.end=function(p){return p&&p.length&&this.write(p),this._parser.end(),!0},D.prototype.on=function(p,c){var M=this;return!M._parser["on"+p]&&f.indexOf(p)!==-1&&(M._parser["on"+p]=function(){var v=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);v.splice(0,0,p),M.emit.apply(M,v)}),i.prototype.on.call(M,p,c)};var E="[CDATA[",x="DOCTYPE",C="http://www.w3.org/XML/1998/namespace",O="http://www.w3.org/2000/xmlns/",F={xml:C,xmlns:O},B=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,I=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,T=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,l=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function d(p){return p===" "||p===`
`||p==="\r"||p==="	"}function b(p){return p==='"'||p==="'"}function S(p){return p===">"||d(p)}function L(p,c){return p.test(c)}function y(p,c){return!L(p,c)}var a=0;s.STATE={BEGIN:a++,BEGIN_WHITESPACE:a++,TEXT:a++,TEXT_ENTITY:a++,OPEN_WAKA:a++,SGML_DECL:a++,SGML_DECL_QUOTED:a++,DOCTYPE:a++,DOCTYPE_QUOTED:a++,DOCTYPE_DTD:a++,DOCTYPE_DTD_QUOTED:a++,COMMENT_STARTING:a++,COMMENT:a++,COMMENT_ENDING:a++,COMMENT_ENDED:a++,CDATA:a++,CDATA_ENDING:a++,CDATA_ENDING_2:a++,PROC_INST:a++,PROC_INST_BODY:a++,PROC_INST_ENDING:a++,OPEN_TAG:a++,OPEN_TAG_SLASH:a++,ATTRIB:a++,ATTRIB_NAME:a++,ATTRIB_NAME_SAW_WHITE:a++,ATTRIB_VALUE:a++,ATTRIB_VALUE_QUOTED:a++,ATTRIB_VALUE_CLOSED:a++,ATTRIB_VALUE_UNQUOTED:a++,ATTRIB_VALUE_ENTITY_Q:a++,ATTRIB_VALUE_ENTITY_U:a++,CLOSE_TAG:a++,CLOSE_TAG_SAW_WHITE:a++,SCRIPT:a++,SCRIPT_ENDING:a++},s.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},s.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(s.ENTITIES).forEach(function(p){var c=s.ENTITIES[p],M=typeof c=="number"?String.fromCharCode(c):c;s.ENTITIES[p]=M});for(var _ in s.STATE)s.STATE[s.STATE[_]]=_;a=s.STATE;function P(p,c,M){p[c]&&p[c](M)}function X(p,c,M){p.textNode&&U(p),P(p,c,M)}function U(p){p.textNode=$(p.opt,p.textNode),p.textNode&&P(p,"ontext",p.textNode),p.textNode=""}function $(p,c){return p.trim&&(c=c.trim()),p.normalize&&(c=c.replace(/\s+/g," ")),c}function z(p,c){return U(p),p.trackPosition&&(c+=`
Line: `+p.line+`
Column: `+p.column+`
Char: `+p.c),c=new Error(c),p.error=c,P(p,"onerror",c),p}function H(p){return p.sawRoot&&!p.closedRoot&&Y(p,"Unclosed root tag"),p.state!==a.BEGIN&&p.state!==a.BEGIN_WHITESPACE&&p.state!==a.TEXT&&z(p,"Unexpected end"),U(p),p.c="",p.closed=!0,P(p,"onend"),u.call(p,p.strict,p.opt),p}function Y(p,c){if(typeof p!="object"||!(p instanceof u))throw new Error("bad call to strictFail");p.strict&&z(p,c)}function fe(p){p.strict||(p.tagName=p.tagName[p.looseCase]());var c=p.tags[p.tags.length-1]||p,M=p.tag={name:p.tagName,attributes:{}};p.opt.xmlns&&(M.ns=c.ns),p.attribList.length=0,X(p,"onopentagstart",M)}function me(p,c){var M=p.indexOf(":"),v=M<0?["",p]:p.split(":"),V=v[0],j=v[1];return c&&p==="xmlns"&&(V="xmlns",j=""),{prefix:V,local:j}}function ie(p){if(p.strict||(p.attribName=p.attribName[p.looseCase]()),p.attribList.indexOf(p.attribName)!==-1||p.tag.attributes.hasOwnProperty(p.attribName)){p.attribName=p.attribValue="";return}if(p.opt.xmlns){var c=me(p.attribName,!0),M=c.prefix,v=c.local;if(M==="xmlns")if(v==="xml"&&p.attribValue!==C)Y(p,"xml: prefix must be bound to "+C+`
Actual: `+p.attribValue);else if(v==="xmlns"&&p.attribValue!==O)Y(p,"xmlns: prefix must be bound to "+O+`
Actual: `+p.attribValue);else{var V=p.tag,j=p.tags[p.tags.length-1]||p;V.ns===j.ns&&(V.ns=Object.create(j.ns)),V.ns[v]=p.attribValue}p.attribList.push([p.attribName,p.attribValue])}else p.tag.attributes[p.attribName]=p.attribValue,X(p,"onattribute",{name:p.attribName,value:p.attribValue});p.attribName=p.attribValue=""}function Z(p,c){if(p.opt.xmlns){var M=p.tag,v=me(p.tagName);M.prefix=v.prefix,M.local=v.local,M.uri=M.ns[v.prefix]||"",M.prefix&&!M.uri&&(Y(p,"Unbound namespace prefix: "+JSON.stringify(p.tagName)),M.uri=v.prefix);var V=p.tags[p.tags.length-1]||p;M.ns&&V.ns!==M.ns&&Object.keys(M.ns).forEach(function(k){X(p,"onopennamespace",{prefix:k,uri:M.ns[k]})});for(var j=0,q=p.attribList.length;j<q;j++){var G=p.attribList[j],ne=G[0],g=G[1],n=me(ne,!0),o=n.prefix,w=n.local,A=o===""?"":M.ns[o]||"",R={name:ne,value:g,prefix:o,local:w,uri:A};o&&o!=="xmlns"&&!A&&(Y(p,"Unbound namespace prefix: "+JSON.stringify(o)),R.uri=o),p.tag.attributes[ne]=R,X(p,"onattribute",R)}p.attribList.length=0}p.tag.isSelfClosing=!!c,p.sawRoot=!0,p.tags.push(p.tag),X(p,"onopentag",p.tag),c||(!p.noscript&&p.tagName.toLowerCase()==="script"?p.state=a.SCRIPT:p.state=a.TEXT,p.tag=null,p.tagName=""),p.attribName=p.attribValue="",p.attribList.length=0}function re(p){if(!p.tagName){Y(p,"Weird empty close tag."),p.textNode+="</>",p.state=a.TEXT;return}if(p.script){if(p.tagName!=="script"){p.script+="</"+p.tagName+">",p.tagName="",p.state=a.SCRIPT;return}X(p,"onscript",p.script),p.script=""}var c=p.tags.length,M=p.tagName;p.strict||(M=M[p.looseCase]());for(var v=M;c--;){var V=p.tags[c];if(V.name!==v)Y(p,"Unexpected close tag");else break}if(c<0){Y(p,"Unmatched closing tag: "+p.tagName),p.textNode+="</"+p.tagName+">",p.state=a.TEXT;return}p.tagName=M;for(var j=p.tags.length;j-- >c;){var q=p.tag=p.tags.pop();p.tagName=p.tag.name,X(p,"onclosetag",p.tagName);var G={};for(var ne in q.ns)G[ne]=q.ns[ne];var g=p.tags[p.tags.length-1]||p;p.opt.xmlns&&q.ns!==g.ns&&Object.keys(q.ns).forEach(function(n){var o=q.ns[n];X(p,"onclosenamespace",{prefix:n,uri:o})})}c===0&&(p.closedRoot=!0),p.tagName=p.attribValue=p.attribName="",p.attribList.length=0,p.state=a.TEXT}function de(p){var c=p.entity,M=c.toLowerCase(),v,V="";return p.ENTITIES[c]?p.ENTITIES[c]:p.ENTITIES[M]?p.ENTITIES[M]:(c=M,c.charAt(0)==="#"&&(c.charAt(1)==="x"?(c=c.slice(2),v=parseInt(c,16),V=v.toString(16)):(c=c.slice(1),v=parseInt(c,10),V=v.toString(10))),c=c.replace(/^0+/,""),isNaN(v)||V.toLowerCase()!==c?(Y(p,"Invalid character entity"),"&"+p.entity+";"):String.fromCodePoint(v))}function ge(p,c){c==="<"?(p.state=a.OPEN_WAKA,p.startTagPosition=p.position):d(c)||(Y(p,"Non-whitespace before first tag."),p.textNode=c,p.state=a.TEXT)}function Me(p,c){var M="";return c<p.length&&(M=p.charAt(c)),M}function Se(p){var c=this;if(this.error)throw this.error;if(c.closed)return z(c,"Cannot write after close. Assign an onready handler.");if(p===null)return H(c);typeof p=="object"&&(p=p.toString());for(var M=0,v="";v=Me(p,M++),c.c=v,!!v;)switch(c.trackPosition&&(c.position++,v===`
`?(c.line++,c.column=0):c.column++),c.state){case a.BEGIN:if(c.state=a.BEGIN_WHITESPACE,v==="\uFEFF")continue;ge(c,v);continue;case a.BEGIN_WHITESPACE:ge(c,v);continue;case a.TEXT:if(c.sawRoot&&!c.closedRoot){for(var V=M-1;v&&v!=="<"&&v!=="&";)v=Me(p,M++),v&&c.trackPosition&&(c.position++,v===`
`?(c.line++,c.column=0):c.column++);c.textNode+=p.substring(V,M-1)}v==="<"&&!(c.sawRoot&&c.closedRoot&&!c.strict)?(c.state=a.OPEN_WAKA,c.startTagPosition=c.position):(!d(v)&&(!c.sawRoot||c.closedRoot)&&Y(c,"Text data outside of root node."),v==="&"?c.state=a.TEXT_ENTITY:c.textNode+=v);continue;case a.SCRIPT:v==="<"?c.state=a.SCRIPT_ENDING:c.script+=v;continue;case a.SCRIPT_ENDING:v==="/"?c.state=a.CLOSE_TAG:(c.script+="<"+v,c.state=a.SCRIPT);continue;case a.OPEN_WAKA:if(v==="!")c.state=a.SGML_DECL,c.sgmlDecl="";else if(!d(v))if(L(B,v))c.state=a.OPEN_TAG,c.tagName=v;else if(v==="/")c.state=a.CLOSE_TAG,c.tagName="";else if(v==="?")c.state=a.PROC_INST,c.procInstName=c.procInstBody="";else{if(Y(c,"Unencoded <"),c.startTagPosition+1<c.position){var j=c.position-c.startTagPosition;v=new Array(j).join(" ")+v}c.textNode+="<"+v,c.state=a.TEXT}continue;case a.SGML_DECL:(c.sgmlDecl+v).toUpperCase()===E?(X(c,"onopencdata"),c.state=a.CDATA,c.sgmlDecl="",c.cdata=""):c.sgmlDecl+v==="--"?(c.state=a.COMMENT,c.comment="",c.sgmlDecl=""):(c.sgmlDecl+v).toUpperCase()===x?(c.state=a.DOCTYPE,(c.doctype||c.sawRoot)&&Y(c,"Inappropriately located doctype declaration"),c.doctype="",c.sgmlDecl=""):v===">"?(X(c,"onsgmldeclaration",c.sgmlDecl),c.sgmlDecl="",c.state=a.TEXT):(b(v)&&(c.state=a.SGML_DECL_QUOTED),c.sgmlDecl+=v);continue;case a.SGML_DECL_QUOTED:v===c.q&&(c.state=a.SGML_DECL,c.q=""),c.sgmlDecl+=v;continue;case a.DOCTYPE:v===">"?(c.state=a.TEXT,X(c,"ondoctype",c.doctype),c.doctype=!0):(c.doctype+=v,v==="["?c.state=a.DOCTYPE_DTD:b(v)&&(c.state=a.DOCTYPE_QUOTED,c.q=v));continue;case a.DOCTYPE_QUOTED:c.doctype+=v,v===c.q&&(c.q="",c.state=a.DOCTYPE);continue;case a.DOCTYPE_DTD:c.doctype+=v,v==="]"?c.state=a.DOCTYPE:b(v)&&(c.state=a.DOCTYPE_DTD_QUOTED,c.q=v);continue;case a.DOCTYPE_DTD_QUOTED:c.doctype+=v,v===c.q&&(c.state=a.DOCTYPE_DTD,c.q="");continue;case a.COMMENT:v==="-"?c.state=a.COMMENT_ENDING:c.comment+=v;continue;case a.COMMENT_ENDING:v==="-"?(c.state=a.COMMENT_ENDED,c.comment=$(c.opt,c.comment),c.comment&&X(c,"oncomment",c.comment),c.comment=""):(c.comment+="-"+v,c.state=a.COMMENT);continue;case a.COMMENT_ENDED:v!==">"?(Y(c,"Malformed comment"),c.comment+="--"+v,c.state=a.COMMENT):c.state=a.TEXT;continue;case a.CDATA:v==="]"?c.state=a.CDATA_ENDING:c.cdata+=v;continue;case a.CDATA_ENDING:v==="]"?c.state=a.CDATA_ENDING_2:(c.cdata+="]"+v,c.state=a.CDATA);continue;case a.CDATA_ENDING_2:v===">"?(c.cdata&&X(c,"oncdata",c.cdata),X(c,"onclosecdata"),c.cdata="",c.state=a.TEXT):v==="]"?c.cdata+="]":(c.cdata+="]]"+v,c.state=a.CDATA);continue;case a.PROC_INST:v==="?"?c.state=a.PROC_INST_ENDING:d(v)?c.state=a.PROC_INST_BODY:c.procInstName+=v;continue;case a.PROC_INST_BODY:if(!c.procInstBody&&d(v))continue;v==="?"?c.state=a.PROC_INST_ENDING:c.procInstBody+=v;continue;case a.PROC_INST_ENDING:v===">"?(X(c,"onprocessinginstruction",{name:c.procInstName,body:c.procInstBody}),c.procInstName=c.procInstBody="",c.state=a.TEXT):(c.procInstBody+="?"+v,c.state=a.PROC_INST_BODY);continue;case a.OPEN_TAG:L(I,v)?c.tagName+=v:(fe(c),v===">"?Z(c):v==="/"?c.state=a.OPEN_TAG_SLASH:(d(v)||Y(c,"Invalid character in tag name"),c.state=a.ATTRIB));continue;case a.OPEN_TAG_SLASH:v===">"?(Z(c,!0),re(c)):(Y(c,"Forward-slash in opening tag not followed by >"),c.state=a.ATTRIB);continue;case a.ATTRIB:if(d(v))continue;v===">"?Z(c):v==="/"?c.state=a.OPEN_TAG_SLASH:L(B,v)?(c.attribName=v,c.attribValue="",c.state=a.ATTRIB_NAME):Y(c,"Invalid attribute name");continue;case a.ATTRIB_NAME:v==="="?c.state=a.ATTRIB_VALUE:v===">"?(Y(c,"Attribute without value"),c.attribValue=c.attribName,ie(c),Z(c)):d(v)?c.state=a.ATTRIB_NAME_SAW_WHITE:L(I,v)?c.attribName+=v:Y(c,"Invalid attribute name");continue;case a.ATTRIB_NAME_SAW_WHITE:if(v==="=")c.state=a.ATTRIB_VALUE;else{if(d(v))continue;Y(c,"Attribute without value"),c.tag.attributes[c.attribName]="",c.attribValue="",X(c,"onattribute",{name:c.attribName,value:""}),c.attribName="",v===">"?Z(c):L(B,v)?(c.attribName=v,c.state=a.ATTRIB_NAME):(Y(c,"Invalid attribute name"),c.state=a.ATTRIB)}continue;case a.ATTRIB_VALUE:if(d(v))continue;b(v)?(c.q=v,c.state=a.ATTRIB_VALUE_QUOTED):(Y(c,"Unquoted attribute value"),c.state=a.ATTRIB_VALUE_UNQUOTED,c.attribValue=v);continue;case a.ATTRIB_VALUE_QUOTED:if(v!==c.q){v==="&"?c.state=a.ATTRIB_VALUE_ENTITY_Q:c.attribValue+=v;continue}ie(c),c.q="",c.state=a.ATTRIB_VALUE_CLOSED;continue;case a.ATTRIB_VALUE_CLOSED:d(v)?c.state=a.ATTRIB:v===">"?Z(c):v==="/"?c.state=a.OPEN_TAG_SLASH:L(B,v)?(Y(c,"No whitespace between attributes"),c.attribName=v,c.attribValue="",c.state=a.ATTRIB_NAME):Y(c,"Invalid attribute name");continue;case a.ATTRIB_VALUE_UNQUOTED:if(!S(v)){v==="&"?c.state=a.ATTRIB_VALUE_ENTITY_U:c.attribValue+=v;continue}ie(c),v===">"?Z(c):c.state=a.ATTRIB;continue;case a.CLOSE_TAG:if(c.tagName)v===">"?re(c):L(I,v)?c.tagName+=v:c.script?(c.script+="</"+c.tagName,c.tagName="",c.state=a.SCRIPT):(d(v)||Y(c,"Invalid tagname in closing tag"),c.state=a.CLOSE_TAG_SAW_WHITE);else{if(d(v))continue;y(B,v)?c.script?(c.script+="</"+v,c.state=a.SCRIPT):Y(c,"Invalid tagname in closing tag."):c.tagName=v}continue;case a.CLOSE_TAG_SAW_WHITE:if(d(v))continue;v===">"?re(c):Y(c,"Invalid characters in closing tag");continue;case a.TEXT_ENTITY:case a.ATTRIB_VALUE_ENTITY_Q:case a.ATTRIB_VALUE_ENTITY_U:var q,G;switch(c.state){case a.TEXT_ENTITY:q=a.TEXT,G="textNode";break;case a.ATTRIB_VALUE_ENTITY_Q:q=a.ATTRIB_VALUE_QUOTED,G="attribValue";break;case a.ATTRIB_VALUE_ENTITY_U:q=a.ATTRIB_VALUE_UNQUOTED,G="attribValue";break}if(v===";")if(c.opt.unparsedEntities){var ne=de(c);c.entity="",c.state=q,c.write(ne)}else c[G]+=de(c),c.entity="",c.state=q;else L(c.entity.length?l:T,v)?c.entity+=v:(Y(c,"Invalid character in entity name"),c[G]+="&"+c.entity+v,c.entity="",c.state=q);continue;default:throw new Error(c,"Unknown state: "+c.state)}return c.position>=c.bufferCheckPosition&&m(c),c}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var p=String.fromCharCode,c=Math.floor,M=function(){var v=16384,V=[],j,q,G=-1,ne=arguments.length;if(!ne)return"";for(var g="";++G<ne;){var n=Number(arguments[G]);if(!isFinite(n)||n<0||n>1114111||c(n)!==n)throw RangeError("Invalid code point: "+n);n<=65535?V.push(n):(n-=65536,j=(n>>10)+55296,q=n%1024+56320,V.push(j,q)),(G+1===ne||V.length>v)&&(g+=p.apply(null,V),V.length=0)}return g};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:M,configurable:!0,writable:!0}):String.fromCodePoint=M}()})(t)}(Nt)),Nt}var Be={exports:{}},Fr;function An(){if(Fr)return Be.exports;Fr=1;var t=typeof Reflect=="object"?Reflect:null,s=t&&typeof t.apply=="function"?t.apply:function(b,S,L){return Function.prototype.apply.call(b,S,L)},h;t&&typeof t.ownKeys=="function"?h=t.ownKeys:Object.getOwnPropertySymbols?h=function(b){return Object.getOwnPropertyNames(b).concat(Object.getOwnPropertySymbols(b))}:h=function(b){return Object.getOwnPropertyNames(b)};function u(d){console&&console.warn&&console.warn(d)}var m=Number.isNaN||function(b){return b!==b};function e(){e.init.call(this)}Be.exports=e,Be.exports.once=I,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var r=10;function i(d){if(typeof d!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof d)}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return r},set:function(d){if(typeof d!="number"||d<0||m(d))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+d+".");r=d}}),e.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(b){if(typeof b!="number"||b<0||m(b))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+b+".");return this._maxListeners=b,this};function f(d){return d._maxListeners===void 0?e.defaultMaxListeners:d._maxListeners}e.prototype.getMaxListeners=function(){return f(this)},e.prototype.emit=function(b){for(var S=[],L=1;L<arguments.length;L++)S.push(arguments[L]);var y=b==="error",a=this._events;if(a!==void 0)y=y&&a.error===void 0;else if(!y)return!1;if(y){var _;if(S.length>0&&(_=S[0]),_ instanceof Error)throw _;var P=new Error("Unhandled error."+(_?" ("+_.message+")":""));throw P.context=_,P}var X=a[b];if(X===void 0)return!1;if(typeof X=="function")s(X,this,S);else for(var U=X.length,$=O(X,U),L=0;L<U;++L)s($[L],this,S);return!0};function N(d,b,S,L){var y,a,_;if(i(S),a=d._events,a===void 0?(a=d._events=Object.create(null),d._eventsCount=0):(a.newListener!==void 0&&(d.emit("newListener",b,S.listener?S.listener:S),a=d._events),_=a[b]),_===void 0)_=a[b]=S,++d._eventsCount;else if(typeof _=="function"?_=a[b]=L?[S,_]:[_,S]:L?_.unshift(S):_.push(S),y=f(d),y>0&&_.length>y&&!_.warned){_.warned=!0;var P=new Error("Possible EventEmitter memory leak detected. "+_.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");P.name="MaxListenersExceededWarning",P.emitter=d,P.type=b,P.count=_.length,u(P)}return d}e.prototype.addListener=function(b,S){return N(this,b,S,!1)},e.prototype.on=e.prototype.addListener,e.prototype.prependListener=function(b,S){return N(this,b,S,!0)};function D(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function E(d,b,S){var L={fired:!1,wrapFn:void 0,target:d,type:b,listener:S},y=D.bind(L);return y.listener=S,L.wrapFn=y,y}e.prototype.once=function(b,S){return i(S),this.on(b,E(this,b,S)),this},e.prototype.prependOnceListener=function(b,S){return i(S),this.prependListener(b,E(this,b,S)),this},e.prototype.removeListener=function(b,S){var L,y,a,_,P;if(i(S),y=this._events,y===void 0)return this;if(L=y[b],L===void 0)return this;if(L===S||L.listener===S)--this._eventsCount===0?this._events=Object.create(null):(delete y[b],y.removeListener&&this.emit("removeListener",b,L.listener||S));else if(typeof L!="function"){for(a=-1,_=L.length-1;_>=0;_--)if(L[_]===S||L[_].listener===S){P=L[_].listener,a=_;break}if(a<0)return this;a===0?L.shift():F(L,a),L.length===1&&(y[b]=L[0]),y.removeListener!==void 0&&this.emit("removeListener",b,P||S)}return this},e.prototype.off=e.prototype.removeListener,e.prototype.removeAllListeners=function(b){var S,L,y;if(L=this._events,L===void 0)return this;if(L.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):L[b]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete L[b]),this;if(arguments.length===0){var a=Object.keys(L),_;for(y=0;y<a.length;++y)_=a[y],_!=="removeListener"&&this.removeAllListeners(_);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(S=L[b],typeof S=="function")this.removeListener(b,S);else if(S!==void 0)for(y=S.length-1;y>=0;y--)this.removeListener(b,S[y]);return this};function x(d,b,S){var L=d._events;if(L===void 0)return[];var y=L[b];return y===void 0?[]:typeof y=="function"?S?[y.listener||y]:[y]:S?B(y):O(y,y.length)}e.prototype.listeners=function(b){return x(this,b,!0)},e.prototype.rawListeners=function(b){return x(this,b,!1)},e.listenerCount=function(d,b){return typeof d.listenerCount=="function"?d.listenerCount(b):C.call(d,b)},e.prototype.listenerCount=C;function C(d){var b=this._events;if(b!==void 0){var S=b[d];if(typeof S=="function")return 1;if(S!==void 0)return S.length}return 0}e.prototype.eventNames=function(){return this._eventsCount>0?h(this._events):[]};function O(d,b){for(var S=new Array(b),L=0;L<b;++L)S[L]=d[L];return S}function F(d,b){for(;b+1<d.length;b++)d[b]=d[b+1];d.pop()}function B(d){for(var b=new Array(d.length),S=0;S<b.length;++S)b[S]=d[S].listener||d[S];return b}function I(d,b){return new Promise(function(S,L){function y(_){d.removeListener(b,a),L(_)}function a(){typeof d.removeListener=="function"&&d.removeListener("error",y),S([].slice.call(arguments))}l(d,b,a,{once:!0}),b!=="error"&&T(d,y,{once:!0})})}function T(d,b,S){typeof d.on=="function"&&l(d,"error",b,S)}function l(d,b,S,L){if(typeof d.on=="function")L.once?d.once(b,S):d.on(b,S);else if(typeof d.addEventListener=="function")d.addEventListener(b,function y(a){L.once&&d.removeEventListener(b,y),S(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof d)}return Be.exports}var Tt={},Br;function Cn(){return Br||(Br=1,(function(){Tt.stripBOM=function(t){return t[0]==="\uFEFF"?t.substring(1):t}}).call(K)),Tt}var Ae={},Rr;function Zr(){return Rr||(Rr=1,(function(){var t;t=new RegExp(/(?!xmlns)^.*:/),Ae.normalize=function(s){return s.toLowerCase()},Ae.firstCharLowerCase=function(s){return s.charAt(0).toLowerCase()+s.slice(1)},Ae.stripPrefix=function(s){return s.replace(t,"")},Ae.parseNumbers=function(s){return isNaN(s)||(s=s%1===0?parseInt(s,10):parseFloat(s)),s},Ae.parseBooleans=function(s){return/^(?:true|false)$/i.test(s)&&(s=s.toLowerCase()==="true"),s}}).call(K)),Ae}var Xr;function _n(){return Xr||(Xr=1,function(t){(function(){var s,h,u,m,e,r,i,f,N,D=function(C,O){return function(){return C.apply(O,arguments)}},E=function(C,O){for(var F in O)x.call(O,F)&&(C[F]=O[F]);function B(){this.constructor=C}return B.prototype=O.prototype,C.prototype=new B,C.__super__=O.prototype,C},x={}.hasOwnProperty;f=In(),m=An(),s=Cn(),i=Zr(),N=Qr.setImmediate,h=_t().defaults,e=function(C){return typeof C=="object"&&C!=null&&Object.keys(C).length===0},r=function(C,O,F){var B,I,T;for(B=0,I=C.length;B<I;B++)T=C[B],O=T(O,F);return O},u=function(C,O,F){var B;return B=Object.create(null),B.value=F,B.writable=!0,B.enumerable=!0,B.configurable=!0,Object.defineProperty(C,O,B)},t.Parser=function(C){E(O,C);function O(F){this.parseStringPromise=D(this.parseStringPromise,this),this.parseString=D(this.parseString,this),this.reset=D(this.reset,this),this.assignOrPush=D(this.assignOrPush,this),this.processAsync=D(this.processAsync,this);var B,I,T;if(!(this instanceof t.Parser))return new t.Parser(F);this.options={},I=h["0.2"];for(B in I)x.call(I,B)&&(T=I[B],this.options[B]=T);for(B in F)x.call(F,B)&&(T=F[B],this.options[B]=T);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(i.normalize)),this.reset()}return O.prototype.processAsync=function(){var F,B;try{return this.remaining.length<=this.options.chunkSize?(F=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(F),this.saxParser.close()):(F=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(F),N(this.processAsync))}catch(I){if(B=I,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(B)}},O.prototype.assignOrPush=function(F,B,I){return B in F?(F[B]instanceof Array||u(F,B,[F[B]]),F[B].push(I)):this.options.explicitArray?u(F,B,[I]):u(F,B,I)},O.prototype.reset=function(){var F,B,I,T;return this.removeAllListeners(),this.saxParser=f.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(l){return function(d){if(l.saxParser.resume(),!l.saxParser.errThrown)return l.saxParser.errThrown=!0,l.emit("error",d)}}(this),this.saxParser.onend=function(l){return function(){if(!l.saxParser.ended)return l.saxParser.ended=!0,l.emit("end",l.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,T=[],F=this.options.attrkey,B=this.options.charkey,this.saxParser.onopentag=function(l){return function(d){var b,S,L,y,a;if(L={},L[B]="",!l.options.ignoreAttrs){a=d.attributes;for(b in a)x.call(a,b)&&(!(F in L)&&!l.options.mergeAttrs&&(L[F]={}),S=l.options.attrValueProcessors?r(l.options.attrValueProcessors,d.attributes[b],b):d.attributes[b],y=l.options.attrNameProcessors?r(l.options.attrNameProcessors,b):b,l.options.mergeAttrs?l.assignOrPush(L,y,S):u(L[F],y,S))}return L["#name"]=l.options.tagNameProcessors?r(l.options.tagNameProcessors,d.name):d.name,l.options.xmlns&&(L[l.options.xmlnskey]={uri:d.uri,local:d.local}),T.push(L)}}(this),this.saxParser.onclosetag=function(l){return function(){var d,b,S,L,y,a,_,P,X,U;if(a=T.pop(),y=a["#name"],(!l.options.explicitChildren||!l.options.preserveChildrenOrder)&&delete a["#name"],a.cdata===!0&&(d=a.cdata,delete a.cdata),X=T[T.length-1],a[B].match(/^\s*$/)&&!d?(b=a[B],delete a[B]):(l.options.trim&&(a[B]=a[B].trim()),l.options.normalize&&(a[B]=a[B].replace(/\s{2,}/g," ").trim()),a[B]=l.options.valueProcessors?r(l.options.valueProcessors,a[B],y):a[B],Object.keys(a).length===1&&B in a&&!l.EXPLICIT_CHARKEY&&(a=a[B])),e(a)&&(typeof l.options.emptyTag=="function"?a=l.options.emptyTag():a=l.options.emptyTag!==""?l.options.emptyTag:b),l.options.validator!=null&&(U="/"+function(){var $,z,H;for(H=[],$=0,z=T.length;$<z;$++)L=T[$],H.push(L["#name"]);return H}().concat(y).join("/"),function(){var $;try{return a=l.options.validator(U,X&&X[y],a)}catch(z){return $=z,l.emit("error",$)}}()),l.options.explicitChildren&&!l.options.mergeAttrs&&typeof a=="object"){if(!l.options.preserveChildrenOrder)L={},l.options.attrkey in a&&(L[l.options.attrkey]=a[l.options.attrkey],delete a[l.options.attrkey]),!l.options.charsAsChildren&&l.options.charkey in a&&(L[l.options.charkey]=a[l.options.charkey],delete a[l.options.charkey]),Object.getOwnPropertyNames(a).length>0&&(L[l.options.childkey]=a),a=L;else if(X){X[l.options.childkey]=X[l.options.childkey]||[],_={};for(S in a)x.call(a,S)&&u(_,S,a[S]);X[l.options.childkey].push(_),delete a["#name"],Object.keys(a).length===1&&B in a&&!l.EXPLICIT_CHARKEY&&(a=a[B])}}return T.length>0?l.assignOrPush(X,y,a):(l.options.explicitRoot&&(P=a,a={},u(a,y,P)),l.resultObject=a,l.saxParser.ended=!0,l.emit("end",l.resultObject))}}(this),I=function(l){return function(d){var b,S;if(S=T[T.length-1],S)return S[B]+=d,l.options.explicitChildren&&l.options.preserveChildrenOrder&&l.options.charsAsChildren&&(l.options.includeWhiteChars||d.replace(/\\n/g,"").trim()!=="")&&(S[l.options.childkey]=S[l.options.childkey]||[],b={"#name":"__text__"},b[B]=d,l.options.normalize&&(b[B]=b[B].replace(/\s{2,}/g," ").trim()),S[l.options.childkey].push(b)),S}}(this),this.saxParser.ontext=I,this.saxParser.oncdata=function(l){return function(d){var b;if(b=I(d),b)return b.cdata=!0}}()},O.prototype.parseString=function(F,B){var I;B!=null&&typeof B=="function"&&(this.on("end",function(T){return this.reset(),B(null,T)}),this.on("error",function(T){return this.reset(),B(T)}));try{return F=F.toString(),F.trim()===""?(this.emit("end",null),!0):(F=s.stripBOM(F),this.options.async?(this.remaining=F,N(this.processAsync),this.saxParser):this.saxParser.write(F).close())}catch(T){if(I=T,this.saxParser.errThrown||this.saxParser.ended){if(this.saxParser.ended)throw I}else return this.emit("error",I),this.saxParser.errThrown=!0}},O.prototype.parseStringPromise=function(F){return new Promise(function(B){return function(I,T){return B.parseString(F,function(l,d){return l?T(l):I(d)})}}(this))},O}(m),t.parseString=function(C,O,F){var B,I,T;return F!=null?(typeof F=="function"&&(B=F),typeof O=="object"&&(I=O)):(typeof O=="function"&&(B=O),I={}),T=new t.Parser(I),T.parseString(C,B)},t.parseStringPromise=function(C,O){var F,B;return typeof O=="object"&&(F=O),B=new t.Parser(F),B.parseStringPromise(C)}}).call(K)}(Dt)),Dt}(function(){var t,s,h,u,m=function(r,i){for(var f in i)e.call(i,f)&&(r[f]=i[f]);function N(){this.constructor=r}return N.prototype=i.prototype,r.prototype=new N,r.__super__=i.prototype,r},e={}.hasOwnProperty;s=_t(),t=bn(),h=_n(),u=Zr(),Ie.defaults=s.defaults,Ie.processors=u,Ie.ValidationError=function(r){m(i,r);function i(f){this.message=f}return i}(Error),Ie.Builder=t.Builder,Ie.Parser=h.Parser,Ie.parseString=h.parseString,Ie.parseStringPromise=h.parseStringPromise}).call(K);const Re=At.createBackend(),Mn={name:"ProcessDefinitionVersionDialog",components:{},props:{open:Boolean,process:Object,definition:Object,loading:Boolean,processName:String},data:()=>({isVersion:!1,isMajor:!1,isRelease:!1,isNew:!1,information:{arcv_id:null,version:0,name:null,proc_def_id:null,snapshot:null,diff:null,timeStamp:null,message:null,releaseName:null},isOpen:!1}),computed:{newVersion(){let t=Math.floor(this.information.version),s=this.information.version.toString().includes(".")?Number(this.information.version.toString().split(".")[1]):0;return this.isVersion?(t+=1,Number(t).toFixed(1)):(s+=1,`${t}.${s}`)},useLock(){return this.mode=="ProcessGPT"},mode(){return window.$mode}},watch:{open:{async handler(t){t?(await this.load(),this.isOpen=!0):this.isOpen=!1}},$route:function(t){t&&this.load()}},async mounted(){},methods:{async load(){var t=this;if(t.process&&t.process.processDefinitionId){t.isNew=!1;var s=null;try{s=t.process.processDefinitionId!="Unknown"?await Re.getRawDefinition(t.process.processDefinitionId,{type:"bpmn"}):null}catch{}if(s)if(t.useLock){let h=await Re.getRawDefinition(t.process.processDefinitionId),u=await Re.getDefinitionVersions(t.process.processDefinitionId,{sort:"desc",orderBy:"timeStamp",size:1});u.length>0?(t.information=u[0],t.information.name=t.processName?t.processName:h.name,t.information.message=""):t.information={arcv_id:h.id,version:0,name:t.processName?t.processName:h.name,proc_def_id:h.id,snapshot:s,diff:null,timeStamp:null,message:null}}else{let h=t.$route.params.pathMatch?t.$route.params.pathMatch.join("/"):null;t.process&&t.process.processDefinitionId&&(h=t.process.processDefinitionId);let u=await Re.getDefinitionVersions(h,{sort:"desc",type:"bpmn",orderBy:"timeStamp",size:1});if(console.log(u),u){u.sort((e,r)=>parseFloat(r.version)-parseFloat(e.version));const m=u.length>0?u[0].version:null;t.information.version=m}else t.information.version="0.0";t.information.proc_def_id=h,t.information.name=h}else t.isNew=!0,t.information.proc_def_id=t.process.processDefinitionId,t.information.name=t.process.processDefinitionName}else t.isNew=!0,t.isVersion=!1,t.$route.query&&t.$route.query.id&&t.$route.query.name?(t.information.id=t.$route.query.id,t.information.name=t.$route.query.name,t.information.message=""):t.information={arcv_id:"",version:0,name:t.processName?t.processName:"",proc_def_id:"",snapshot:"",diff:"",timeStamp:"",message:""}},save(){var t=this;this.$try({context:t,action:async()=>{t.information.proc_def_id&&(t.isNew&&!t.information.name||t.$emit("save",{arcv_id:t.process?`${t.process.processDefinitionId}_${t.newVersion}`:`${t.information.proc_def_id}_${t.newVersion}`,version:this.isVersion?t.newVersion:null,name:t.information.name,proc_def_id:t.information.proc_def_id,prevSnapshot:t.information.snapshot,prevDiff:t.information.diff,type:"bpmn",message:t.information.message,release:t.isRelease,releaseName:t.information.releaseName}))}})},close(){this.$emit("close",!1)}}},On={key:0},Sn={key:0},Ln={key:1},Pn={key:0},Fn={key:0};function Bn(t,s,h,u,m,e){const r=_e("Icons"),i=_e("DetailComponent");return te(),ce("div",null,[W($r,{modelValue:t.isOpen,"onUpdate:modelValue":s[9]||(s[9]=f=>t.isOpen=f),"max-width":"400","onClick:outside":s[10]||(s[10]=f=>e.close())},{default:J(()=>[W(Ur,null,{default:J(()=>[W(Xe,{class:"ma-0 pa-2 pt-0 pb-0"},{default:J(()=>[W(Vr,null,{default:J(()=>[ve(pe(t.isNew?t.$t("ProcessDefinitionVersionDialog.title"):t.$t("ProcessDefinitionVersionDialog.title2")),1)]),_:1}),W(It),W(he,{onClick:s[0]||(s[0]=f=>e.close()),icon:"",variant:"text",density:"comfortable"},{default:J(()=>[W(r,{icon:"close",size:16})]),_:1})]),_:1}),W(jr,{class:"delete-input-details pt-0"},{default:J(()=>[W(qr,{modelValue:t.isVersion,"onUpdate:modelValue":s[1]||(s[1]=f=>t.isVersion=f),color:"primary",label:`${t.$t("ProcessDefinitionVersionDialog.minorUpdate")}: ${e.newVersion}`},null,8,["modelValue","label"]),W(i,{title:t.$t("ProcessDefinitionVersionDialog.versionDescriptionTitle")},null,8,["title"]),e.mode=="ProcessGPT"?(te(),ce("div",On,[t.isNew?(te(),ce("div",Sn,[W(Oe,{modelValue:t.information.proc_def_id,"onUpdate:modelValue":s[2]||(s[2]=f=>t.information.proc_def_id=f),label:t.$t("ProcessDefinitionVersionDialog.id"),rules:[f=>!!f||"ID is required"],required:"",class:"pb-2"},null,8,["modelValue","label","rules"]),W(Oe,{modelValue:t.information.name,"onUpdate:modelValue":s[3]||(s[3]=f=>t.information.name=f),label:t.$t("ProcessDefinitionVersionDialog.name"),rules:[f=>!!f||"Name is required"],required:"",class:"pb-2"},null,8,["modelValue","label","rules"])])):we("",!0),t.isVersion?(te(),xe(Wt,{key:1,modelValue:t.information.message,"onUpdate:modelValue":s[4]||(s[4]=f=>t.information.message=f),label:t.$t("ProcessDefinitionVersionDialog.message"),"hide-details":"",rows:"3"},null,8,["modelValue","label"])):we("",!0)])):(te(),ce("div",Ln,[t.isVersion?(te(),ce("div",Pn,[t.isNew?(te(),ce("div",Fn,[W(Oe,{modelValue:t.information.proc_def_id,"onUpdate:modelValue":s[5]||(s[5]=f=>t.information.proc_def_id=f),label:t.$t("ProcessDefinitionVersionDialog.id"),rules:[f=>!!f||"ID is required"],required:"",class:"pb-2"},null,8,["modelValue","label","rules"]),W(Oe,{modelValue:t.information.name,"onUpdate:modelValue":s[6]||(s[6]=f=>t.information.name=f),label:t.$t("ProcessDefinitionVersionDialog.name"),rules:[f=>!!f||"Name is required"],required:"",class:"pb-2"},null,8,["modelValue","label","rules"])])):we("",!0),W(Wt,{modelValue:t.information.message,"onUpdate:modelValue":s[7]||(s[7]=f=>t.information.message=f),label:t.$t("ProcessDefinitionVersionDialog.message"),"hide-details":"",rows:"3"},null,8,["modelValue","label"])])):we("",!0)]))]),_:1}),W(Xe,{class:"ma-0 pa-4 pt-0 pr-5"},{default:J(()=>[W(It),h.loading?we("",!0):(te(),xe(he,{key:0,onClick:s[8]||(s[8]=f=>e.save()),color:"primary",rounded:""},{default:J(()=>[ve(pe(t.$t("ProcessDefinitionVersionDialog.save")),1)]),_:1})),h.loading?(te(),xe(Gr,{key:1,color:"primary",size:25,indeterminate:"",style:{margin:"5px"}})):we("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const xi=Ct(Mn,[["render",Bn]]),Ce=At.createBackend(),Rn={mixins:[cn],data:()=>({processDefinition:null,bpmn:null,definitionChangeCount:0,projectName:null,disableChat:!1,isViewMode:!1,lock:!1,loading:!1,isChanged:!1,generateFormTask:null}),computed:{},mounted(){},beforeUnmount(){},async created(){},methods:{async checkedFormData(){if(this.processDefinition&&this.processDefinition.components){const t=this.processDefinition.components.filter(s=>s.componentType==="Activity");this.generateFormTask={};for(const s of t){let h=null;s.outputData&&s.outputData.length>0&&(h=s.outputData?s.outputData.join(", "):"");let u=null;if(s.inputData&&s.inputData.length>0&&(u=s.inputData.filter(e=>!s.outputData.includes(e)).join(", ")),h||u){this.generateFormTask[s.id]="generating";let m="Please refer to the following and create a form.";h&&(m+=`Fields to enter: ${h}`),u&&(m+=`Fields to read only without input: ${u}`);const e=await this.generateForm(m,s);let r=this.messages[this.messages.length-1];r.isLoading=!1,this.messages.push({role:"system",content:`${s.name}   .`,timeStamp:Date.now(),contentType:"html",htmlContent:e,jsonContent:{}})}}this.generateFormTask={}}},async generateForm(t,s){var h=this;return new Promise((u,m)=>{let e=null;const r=new un(h,{isStream:!0,preferredLanguage:"Korean"});r.client.genType="form",r.client.onFormCreated=async i=>{let f=h.messages[h.messages.length-1];f.content=i},r.client.onFormGenerationFinished=async i=>{try{let f=this.extractLastJSON(i);if(f.htmlOutput){const N=await h.keditorContentHTMLToDynamicFormHTML(f.htmlOutput);e=await h.saveFormData(N,s.id),e&&(h.generateFormTask[s.id]="finished"),u(e)}else u(null)}catch(f){console.log(f);const N=3;let D=0;(async()=>{D<N?(console.log("retrying generate form"),D++,r.generate()):m(f)})()}},r.previousMessages=[r.prevMessageFormat],r.previousMessages.push({role:"user",content:t}),r.generate(),h.messages.push({role:"system",content:`${s.name}   .`,timeStamp:Date.now(),isLoading:!0})})},async saveFormData(t,s){const h={type:"form",proc_def_id:this.processDefinition.processDefinitionId,activity_id:s},u=`${h.proc_def_id}_${h.activity_id}_form`;return await Ce.putRawDefinition(t,u,h),t},extractPropertyNameAndIndex(t){let s;return s=t.match(/^\$\.(\w+)\[(\d+)\]$/),s?{propertyName:s[1],index:parseInt(s[2],10)}:(s=t.match(/^\$\.(\w+)\[\?(.*)\]$/),s?{propertyName:s[1],index:s.index}:null)},extendUEngineProperties(t,s,h){var r;if((r=t.extensionElements)!=null&&r.values)return;const u=h.get("bpmnFactory"),m=u.create("uengine:Properties",{json:""});m.json=JSON.stringify(s.value.spec);const e=u.create("bpmn:ExtensionElements");e.get("values").push(m),t.set("extensionElements",e)},modificationElement(t,s){console.log(t),s.get("bpmnFactory");const h=s.get("elementFactory"),u=s.get("canvas"),m=s.get("modeling"),e=s.get("elementRegistry");if(t.targetJsonPath.includes("components")){var r=u.getRootElement(),i=h.createShape({type:`bpmn:${t.value.componentType}`,id:t.value.id,x:0,y:0});i.businessObject.set("name",t.value.name),i.businessObject.set("id",t.value.id),m.createShape(i,{id:t.value.id,x:t.value.x?t.value.x:0,y:t.value.y?t.value.y:0},r.children[0]),this.extendUEngineProperties(i.businessObject,t,s)}if(t.targetJsonPath.includes("sequences")){var f=e.get(t.value.source),N=e.get(t.value.target);h.createConnection({type:"bpmn:SequenceFlow",source:f,target:N}),m.connect(f,N)}},modificationAdd(t){let s=this.extractPropertyNameAndIndex(t.targetJsonPath);s?this.processDefinition[s.propertyName].splice(s.index,0,t.value):this.processDefinition[t.targetJsonPath.replace("$.","")]&&this.processDefinition[t.targetJsonPath.replace("$.","")].push(t.value)},modificationReplace(t){let s=this.extractPropertyNameAndIndex(t.targetJsonPath);this.processDefinition[s.propertyName][s.index]=t.value},modificationRemove(t,s){if(t.value){const u=s.get("modeling"),m=s.get("elementRegistry");console.log("********"),console.log(t),console.log("********");var h=m.get(t.value.id);u.removeElements([h])}},toggleVersionDialog(t){this.versionDialog=t,this.loading=!1},taskMapping(t){switch(t){case"ScriptActivity":return"bpmn:scriptTask";case"EmailActivity":return"bpmn:sendTask";default:return"bpmn:userTask"}},transformJsonModel(t){const s={megaProcessId:"",majorProcessId:"",processDefinitionName:t.processDefinitionName||"Unknown",processDefinitionId:t.processDefinitionId||"Unknown",description:t.description||"",roles:(t.roles||[]).map(h=>({name:h.name,resolutionRule:" "+h.name+"() "})),components:[],data:t.data||[],sequences:(t.sequences||[]).map(h=>({source:h.source,target:h.target,condition:{}})),participants:[]};return Array.isArray(t.events)&&t.events.forEach(h=>{var u,m;s.components.push({componentType:"Event",id:h.id,name:h.name,role:h.role,source:h.type==="startEvent"?"none":(m=(u=t.sequences)==null?void 0:u.find(e=>e.target===h.id))==null?void 0:m.source,type:h.type==="startEvent"?"StartEvent":"EndEvent",description:h.description})}),Array.isArray(t.activities)&&t.activities.forEach(h=>{var u,m;s.components.push({componentType:"Activity",id:h.id,name:h.name,type:"UserActivity",source:(m=(u=t.sequences)==null?void 0:u.find(e=>e.target===h.id))==null?void 0:m.source,description:h.description,instruction:h.instruction,role:h.role,inputData:h.inputData,outputData:h.outputData,checkpoints:[]})}),s.components.length>0&&s.sequences.length>0&&s.components.sort((h,u)=>{const m=s.sequences.findIndex(r=>r.target===h.id),e=s.sequences.findIndex(r=>r.target===u.id);return m-e}),s},createBpmnXml(t){t&&!t.components&&(t=this.transformJsonModel(t));let s=this;const u=new DOMParser().parseFromString('<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:uengine="http://uengine" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" id="Definitions_0bfky9r" targetNamespace="http://bpmn.io/schema/bpmn" exporter="bpmn-js (https://demo.bpmn.io)" exporterVersion="16.4.0"></bpmn:definitions>',"application/xml"),m=u.documentElement;var e=t.isHorizontal;m.setAttribute("id","Definitions_"+t.processDefinitionId),m.setAttribute("targetNamespace","http://bpmn.io/schema/bpmn"),m.setAttribute("exporter","Custom BPMN Modeler"),m.setAttribute("exporterVersion","1.0");const r=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:collaboration");r.setAttribute("id","Collaboration_1"),m.appendChild(r);const i=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:process");i.setAttribute("id",t.processDefinitionId),i.setAttribute("isExecutable","true"),m.appendChild(i);const f=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:participant");f.setAttribute("id","Participant"),f.setAttribute("name","Participant"),f.setAttribute("processRef",t.processDefinitionId);const N=u.createElementNS("http://uengine","uengine:properties");f.appendChild(N);const D=u.createElementNS("http://uengine","uengine:json");D.textContent=JSON.stringify("{}"),N.appendChild(D),r.appendChild(f);const E=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:extensionElements"),x=u.createElementNS("http://uengine","uengine:properties");t.data&&t.data.forEach(p=>{const c=u.createElementNS("http://uengine","uengine:variable");c.setAttribute("name",p.name),c.setAttribute("type",p.type);const M=u.createElementNS("http://uengine","uengine:json");M.textContent=JSON.stringify({defaultValue:""}),c.appendChild(M),x.appendChild(c)}),E.appendChild(x),i.appendChild(E);let C={},O={},F=140,B={},I={},T={};t.sequences&&t.sequences.forEach((p,c)=>{B[p.source]||(B[p.source]=F,F+=120),c===t.sequences.length-1&&(B[p.target]=F+=130);const M=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:sequenceFlow");M.setAttribute("id","SequenceFlow_"+p.source+"_"+p.target),M.setAttribute("name",p.name?p.name:""),M.setAttribute("sourceRef",p.source),M.setAttribute("targetRef",p.target);let v=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:extensionElements"),V=u.createElementNS("http://uengine","uengine:properties"),j=u.createElementNS("http://uengine","uengine:json");if(j.setAttribute("key","condition"),p.condition){if(p.condition.key&&p.condition.condition&&p.condition.value){const q={condition:{_type:"org.uengine.kernel.Evaluate",key:p.condition.key,condition:p.condition.condition,value:p.condition.value}};if(!p.name||p.name==""){let G=p.condition.condition+""+p.condition.value;M.setAttribute("name",G)}j.textContent=JSON.stringify(q),V.appendChild(j),v.appendChild(V),M.appendChild(v)}else if(typeof p.condition=="string"){const q={condition:p.condition};if(!p.name||p.name==""){let G=p.condition;M.setAttribute("name",G)}j.textContent=JSON.stringify(q),V.appendChild(j),v.appendChild(V),M.appendChild(v)}}i.appendChild(M),O[p.source]="SequenceFlow_"+p.source+"_"+p.target,C[p.target]="SequenceFlow_"+p.source+"_"+p.target});const l=function(p,c){return(Array.isArray(p)?p.filter(v=>v&&v.type==="Form"):[]).some(v=>v.name==c)},d={},b=function(p,c){var o,w;const M=p.role?p.role:null;M&&(d[p==null?void 0:p.role]||(d[p==null?void 0:p.role]=[]),d[p.role].push(p.id));const v=s.taskMapping(p.type),V=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL",v);if(V.setAttribute("id",p.id),V.setAttribute("name",p.name),O[p.id]){let A=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:outgoing");A.textContent=O[p.id],V.appendChild(A)}if(C[p.id]){let A=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:incoming");A.textContent=C[p.id],V.appendChild(A)}let j=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:extensionElements"),q=u.createElementNS("http://uengine","uengine:properties"),G=u.createElementNS("http://uengine","uengine:json"),ne=[],g=[],n=null;if((o=p==null?void 0:p.inputData)==null||o.forEach(A=>{ne.push({argument:{text:A},variable:{name:A},direction:"OUT"})}),(w=p==null?void 0:p.outputData)==null||w.forEach(A=>{l(c,A)?n={name:A}:g.push({argument:{text:A},variable:{name:A},direction:"IN"})}),M){let A={parameters:[...ne,...g]};A.duration=p!=null&&p.duration?p==null?void 0:p.duration:5,n&&(A.variableForHtmlFormContext=n,A._type="org.uengine.kernel.FormActivity"),G.textContent=JSON.stringify(A),q.appendChild(G)}j.appendChild(q),V.appendChild(j),i.appendChild(V)},S=function(p){(p.role?p.role:null)&&(d[p==null?void 0:p.role]||(d[p==null?void 0:p.role]=[]),d[p.role].push(p.id));const M=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:"+p.type);if(M.setAttribute("id",p.id),M.setAttribute("name",p.name),O[p.id]){let v=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:outgoing");v.textContent=O[p.id],M.appendChild(v)}if(C[p.id]){let v=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:incoming");v.textContent=C[p.id],M.appendChild(v)}i.appendChild(M)},L=function(p){const c=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:"+p.type);c.setAttribute("id",p.id),c.setAttribute("name",p.name),i.appendChild(c)};var y=0,a=0,_={};t.components&&Object.keys(t.components).forEach(p=>{const c=t.components[p];c.componentType=="Activity"?b(c,t.data):c.componentType=="Gateway"?S(c):c.componentType=="Event"&&L(c)});const P=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNDiagram");P.setAttribute("id","BPMNDiagram_1"),m.appendChild(P);const X=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNPlane");X.setAttribute("id","BPMNPlane_1"),X.setAttribute("bpmnElement","Collaboration_1"),P.appendChild(X);const U=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNShape");U.setAttribute("id","Participant_1"),U.setAttribute("bpmnElement","Participant"),U.setAttribute("isHorizontal",e);const $=u.createElementNS("http://www.omg.org/spec/DD/20100524/DC","dc:Bounds");if(U.appendChild($),X.appendChild(U),t.roles){const p=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:laneSet");p.setAttribute("id","LaneSet_1"),i.appendChild(p),t.roles.forEach((c,M)=>{const v=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:lane");v.setAttribute("id","Lane_"+M),v.setAttribute("name",c.name),p.appendChild(v),d[c.name]&&d[c.name].forEach(V=>{const j=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:flowNodeRef");j.textContent=V,v.appendChild(j)})})}if(t.components){var z="default";Object.keys(t.components).forEach(p=>{const c=t.components[p];let M=100,v=100;if(c.source){const o=function(A,R){if(A){const k=Object.keys(A).reverse();for(let Q=0;Q<k.length;Q++){const ee=k[Q];if(A[ee].source===R.source)return A[ee]}}return null}(I,c),w=I[c.source?c.source:z];if(o)M=o.x+(e?0:200),v=o.y+(e?100:0),o.type.indexOf("Gateway")!=-1?M+=e?150:0:o.type.indexOf("Activity")!=-1||o.type.indexOf("Event")!=-1;else if(M=w?w.x+(e?150:0):e?150:0,v=w?w.y+(e?0:100):e?0:150,w&&w.role!=c.role){M+=e?0:150;const A=t.components.filter(R=>R.role==w.role);if(A.length>0){let R=v;A.forEach(k=>{R<I[k.id].y&&(R=I[k.id].y)}),v=e?R+100:0}else v+=e?100:0}z=c.source}const V=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNShape");c.componentType=="Event"?V.setAttribute("id",`Shape_${c.id}`):V.setAttribute("id",`BPMNShape_${c.id}`),V.setAttribute("bpmnElement",c.id);const j=u.createElementNS("http://www.omg.org/spec/DD/20100524/DC","dc:Bounds");let q=50,G=50;c.componentType=="Gateway"?(q=50,G=50):c.componentType=="Activity"?(q=100,G=80):c.componentType=="Event"&&(q=34,G=34),e?c.componentType!="Event"?M>1100&&(M=100,v+=150):c.type=="EndEvent"&&(M=1200,a>v&&(v=a)):c.type=="EndEvent"&&(v=900,y>M&&(M=y)),j.setAttribute("width",q),j.setAttribute("height",G);const ne=q/2,g=G/2;if(j.setAttribute("x",M-ne),j.setAttribute("y",v-g),V.appendChild(j),c.componentType=="Event"){const n=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNLabel"),o=u.createElementNS("http://www.omg.org/spec/DD/20100524/DC","dc:Bounds");o.setAttribute("x",M-ne-15),o.setAttribute("y",v-g+40),o.setAttribute("width","64"),o.setAttribute("height","14"),n.appendChild(o),V.appendChild(n)}X.appendChild(V),I[c.id]={x:M,y:v,width:parseInt(j.getAttribute("width")),height:parseInt(j.getAttribute("height")),role:c.role?c.role:z,type:c.type?c.type:"Activity",source:c.source?c.source:z},T[c.id]={x:M-ne,y:v-g,width:parseInt(j.getAttribute("width")),height:parseInt(j.getAttribute("height")),role:c.role?c.role:z,type:c.type?c.type:"Activity",source:c.source?c.source:z},_[c.role]||(_[c.role]={}),_[c.role][c.id]={x:M,y:v},c.type=="StartEvent"&&(y=M,a=v)})}let H=0,Y=0,fe=0,me=0;Object.keys(_).forEach(p=>{const c=_[p];Object.keys(c).forEach(M=>{H==0&&(H=c[M].x),Y==0&&(Y=c[M].y),fe<c[M].x&&(fe=c[M].x+0),me<c[M].y&&(me=c[M].y+0)})}),$.setAttribute("x",H+(e?-80:-70)),$.setAttribute("y",Y+(e?-50:-70)),$.setAttribute("width",fe+(e?0:50)),$.setAttribute("height",me+0),console.log(_);let ie=this.calculateLaneBounds(_),Z=e?fe-30:0,re=e?0:me-30,de=0,ge=0;return Object.keys(_).forEach((p,c)=>{const M=_[p];e?ge=0:de=0,Object.keys(M).forEach(j=>{e?(de==0&&(de=M[j].x),ge==0&&(ge=ie[p].y||100),re<M[j].y&&(re=ie[p].height||100)):(de==0&&(de=M[j].x),ge==0&&(ge=M[j].y),Z<M[j].x&&(Z=M[j].x-de+150))});const v=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNShape");v.setAttribute("id",`BPMNShape_${c}`),v.setAttribute("bpmnElement",`Lane_${c}`),v.setAttribute("isHorizontal",e);const V=u.createElementNS("http://www.omg.org/spec/DD/20100524/DC","dc:Bounds");V.setAttribute("x",de+(e?-50:-70)),V.setAttribute("y",ge+(e?-50:-40)),V.setAttribute("width",Z),V.setAttribute("height",re),console.log("role_",p),console.log("x",de),console.log("y",ge),console.log("width",Z),console.log("height",re),v.appendChild(V),X.appendChild(v)}),t.sequences&&t.sequences.forEach(p=>{if(!T[p.source]||!T[p.target])return!1;const c=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNEdge");c.setAttribute("id",`BPMNEdge_${p.source}_${p.target}`),c.setAttribute("bpmnElement","SequenceFlow_"+p.source+"_"+p.target);const M=T[p.source]||{},v=T[p.target]||{};let V=(parseInt(M.x)||0)+(parseInt(M.width)||0),j=(parseInt(M.y)||0)+(parseInt(M.height)||0)/2,q=parseInt(v.x)||0,G=(parseInt(v.y)||0)+(parseInt(v.height)||0)/2,ne=q-V,g=G-j;if(g>ne&&(V=(parseInt(M.x)||0)+(parseInt(M.width)||0)/2,j=(parseInt(M.y)||0)+(parseInt(M.height)||0),q=parseInt(v.x)||0,G=(parseInt(v.y)||0)+(parseInt(v.height)||0)/2),V>q&&(q=parseInt(v.x)||0,G=(parseInt(v.y)||0)+(parseInt(v.height)||0)/2),g<0&&(q=(parseInt(v.x)||0)+(parseInt(v.width)||0)/2,G=(parseInt(v.y)||0)+(parseInt(v.height)||0)),e||(V=(parseInt(M.x)||0)+(parseInt(M.width)||0)/2,j=(parseInt(M.y)||0)+(parseInt(M.height)||0),q=(parseInt(v.x)||0)+(parseInt(v.width)||0)/2,G=parseInt(v.y)||0,ne=q-V,g=G-j,Math.abs(ne)>Math.abs(g)&&(V=(parseInt(M.x)||0)+(parseInt(M.width)||0),j=(parseInt(M.y)||0)+(parseInt(M.height)||0)/2,q=parseInt(v.x)||0,G=(parseInt(v.y)||0)+(parseInt(v.height)||0)/2),j>G&&(q=(parseInt(v.x)||0)+(parseInt(v.width)||0)/2,G=(parseInt(v.y)||0)+(parseInt(v.height)||0)),ne<0&&(V=parseInt(M.x)||0,j=(parseInt(M.y)||0)+(parseInt(M.height)||0)/2)),e){const n=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");if(n.setAttribute("x",V),n.setAttribute("y",j),c.appendChild(n),j===G){const o=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");o.setAttribute("x",q),o.setAttribute("y",G),c.appendChild(o)}else if(V>q){const o=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");o.setAttribute("x",V),o.setAttribute("y",j),c.appendChild(o);const w=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");w.setAttribute("x",V),w.setAttribute("y",j+(G-j)/2),c.appendChild(w);const A=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");A.setAttribute("x",q-60),A.setAttribute("y",G-(G-j)/2),c.appendChild(A);const R=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");R.setAttribute("x",q-60),R.setAttribute("y",G),c.appendChild(R);const k=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");k.setAttribute("x",q),k.setAttribute("y",G),c.appendChild(k)}else{const o=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");if(o.setAttribute("x",V),o.setAttribute("y",j),c.appendChild(o),g>=0){const A=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");A.setAttribute("x",V),A.setAttribute("y",G),c.appendChild(A);const R=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");R.setAttribute("x",q),R.setAttribute("y",G),c.appendChild(R)}else{const A=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");A.setAttribute("x",q),A.setAttribute("y",j),c.appendChild(A);const R=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");R.setAttribute("x",q),R.setAttribute("y",G),c.appendChild(R)}const w=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");w.setAttribute("x",q),w.setAttribute("y",G),c.appendChild(w)}}else{const n=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");if(n.setAttribute("x",V),n.setAttribute("y",j),c.appendChild(n),V===q){const o=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");o.setAttribute("x",q),o.setAttribute("y",G),c.appendChild(o)}else if(j>G){const o=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");o.setAttribute("x",V),o.setAttribute("y",j),c.appendChild(o);const w=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");w.setAttribute("x",V+(q-V)/2),w.setAttribute("y",j),c.appendChild(w);const A=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");A.setAttribute("x",q-(q-V)/2),A.setAttribute("y",G+60),c.appendChild(A);const R=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");R.setAttribute("x",q),R.setAttribute("y",G+60),c.appendChild(R);const k=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");k.setAttribute("x",q),k.setAttribute("y",G),c.appendChild(k)}else{const o=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");if(o.setAttribute("x",V),o.setAttribute("y",j),c.appendChild(o),ne>=0){const A=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");A.setAttribute("x",q),A.setAttribute("y",j),c.appendChild(A);const R=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");R.setAttribute("x",q),R.setAttribute("y",G),c.appendChild(R)}else{const A=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");A.setAttribute("x",V),A.setAttribute("y",G),c.appendChild(A);const R=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");R.setAttribute("x",q),R.setAttribute("y",G),c.appendChild(R)}const w=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");w.setAttribute("x",q),w.setAttribute("y",G),c.appendChild(w)}}X.appendChild(c)}),new XMLSerializer().serializeToString(u)},calculateLaneBounds(t){let s={};return Object.keys(t).forEach(u=>{let m=Object.values(t[u]);if(m.length===0){s[u]={y:0,height:100};return}let e=Math.min(...m.map(N=>N.y)),r=Math.max(...m.map(N=>N.y));console.log(u,r,e);let i=e,f=r===e?100:100+(r-e);s[u]={y:i,height:f}}),s},createBpmnXmlTest(t){let s=this;const u=new DOMParser().parseFromString('<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:uengine="http://uengine" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" id="Definitions_0bfky9r" targetNamespace="http://bpmn.io/schema/bpmn" exporter="bpmn-js (https://demo.bpmn.io)" exporterVersion="16.4.0"></bpmn:definitions>',"application/xml"),m=u.documentElement;m.setAttribute("id","Definitions_"+t.processDefinitionId),m.setAttribute("targetNamespace","http://bpmn.io/schema/bpmn"),m.setAttribute("exporter","Custom BPMN Modeler"),m.setAttribute("exporterVersion","1.0");const e=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:collaboration");e.setAttribute("id","Collaboration_1"),m.appendChild(e);const r=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:process");r.setAttribute("id",t.processDefinitionId),r.setAttribute("isExecutable","true"),m.appendChild(r);const i=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:participant");i.setAttribute("id","Participant"),i.setAttribute("name","Participant"),i.setAttribute("processRef",t.processDefinitionId),e.appendChild(i);const f=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:extensionElements"),N=u.createElementNS("http://uengine","uengine:properties");t.data&&t.data.forEach(y=>{const a=u.createElementNS("http://uengine","uengine:variable");a.setAttribute("name",y.name),a.setAttribute("type",y.type),N.appendChild(a)}),f.appendChild(N),r.appendChild(f);const D={};if(t.activities&&t.activities.forEach(y=>{D[y==null?void 0:y.role]||(D[y==null?void 0:y.role]=[]),D[y.role].push(y.id)}),t.gateways&&t.gateways.forEach(y=>{D[y==null?void 0:y.role]||(D[y==null?void 0:y.role]=[]),D[y.role].push(y.id)}),t.roles){const y=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:laneSet");y.setAttribute("id","LaneSet_1"),r.appendChild(y),t.roles.forEach((a,_)=>{const P=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:lane");P.setAttribute("id","Lane_"+_),P.setAttribute("name",a.name),y.appendChild(P),D[a.name]&&D[a.name].forEach(X=>{const U=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:flowNodeRef");U.textContent=X,P.appendChild(U)})})}let E={},x={},C=140,O={},F={};t.sequences&&t.sequences.forEach((y,a)=>{O[y.source]||(O[y.source]=C,C+=120),a===t.sequences.length-1&&(O[y.target]=C+=130);const _=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:sequenceFlow");_.setAttribute("id","SequenceFlow_"+y.source+"_"+y.target),_.setAttribute("name",y.name?y.name:""),_.setAttribute("sourceRef",y.source),_.setAttribute("targetRef",y.target);let P=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:extensionElements"),X=u.createElementNS("http://uengine","uengine:properties"),U=u.createElementNS("http://uengine","uengine:json");U.setAttribute("key","condition"),y.condition==""?y.condition="true":y.condition==""&&(y.condition="false"),U.textContent=JSON.stringify({condition:y.condition?y.condition:""}),X.appendChild(U),P.appendChild(X),_.appendChild(P),r.appendChild(_),x[y.source]="SequenceFlow_"+y.source+"_"+y.target,E[y.target]="SequenceFlow_"+y.source+"_"+y.target}),t.activities&&t.activities.forEach((y,a)=>{var fe,me;const _=s.taskMapping(y.type),P=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL",_);if(P.setAttribute("id",y.id),P.setAttribute("name",y.name),x[y.id]){let ie=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:outgoing");ie.textContent=x[y.id],P.appendChild(ie)}if(E[y.id]){let ie=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:incoming");ie.textContent=E[y.id],P.appendChild(ie)}let X=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:extensionElements"),U=u.createElementNS("http://uengine","uengine:properties"),$=u.createElementNS("http://uengine","uengine:json");$.setAttribute("key","condition");let z=[],H=[];(fe=y==null?void 0:y.inputData)==null||fe.forEach(ie=>{z.push({argument:{text:ie},variable:{name:ie},direction:"OUT"})}),(me=y==null?void 0:y.outputData)==null||me.forEach(ie=>{H.push({argument:{text:ie},variable:{name:ie},direction:"IN"})});let Y={role:{name:y.role},parameters:[...z,...H]};$.textContent=JSON.stringify(Y),U.appendChild($),X.appendChild(U),P.appendChild(X),t.events&&t.events.forEach((ie,Z)=>{const re=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:"+ie.type);re.setAttribute("id",ie.id),re.setAttribute("name",ie.name),r.appendChild(re)}),r.appendChild(P)}),t.gateways&&t.gateways.forEach(y=>{const a=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:"+y.type);a.setAttribute("id",y.id),a.setAttribute("name",y.name);let _=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:extensionElements"),P=u.createElementNS("http://uengine","uengine:properties"),X=u.createElementNS("http://uengine","uengine:json");if(X.setAttribute("key","condition"),X.textContent=JSON.stringify({condition:y.condition?y.condition:""}),P.appendChild(X),_.appendChild(P),a.appendChild(_),x[y.id]){let U=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:outgoing");U.textContent=x[y.id],a.appendChild(U)}if(E[y.id]){let U=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/MODEL","bpmn:incoming");U.textContent=E[y.id],a.appendChild(U)}r.appendChild(a)});const B=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNDiagram");B.setAttribute("id","BPMNDiagram_1"),m.appendChild(B);const I=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNPlane");I.setAttribute("id","BPMNPlane_1"),I.setAttribute("bpmnElement","Collaboration_1"),B.appendChild(I);let T=(t==null?void 0:t.roles.length)>0?(t==null?void 0:t.roles.length)*100:100;const l=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNShape");l.setAttribute("id","Participant_1"),l.setAttribute("bpmnElement","Participant");const d=u.createElementNS("http://www.omg.org/spec/DD/20100524/DC","dc:Bounds");d.setAttribute("x","70"),d.setAttribute("y","100"),d.setAttribute("width",`${C+30}`),d.setAttribute("height",T),l.appendChild(d),I.appendChild(l);let b={};if(t.roles&&t.roles.forEach((y,a)=>{const _=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNShape");_.setAttribute("id",`BPMNShape_${a}`),_.setAttribute("bpmnElement",`Lane_${a}`),_.setAttribute("isHorizontal",!0);const P=u.createElementNS("http://www.omg.org/spec/DD/20100524/DC","dc:Bounds");P.setAttribute("x","100"),P.setAttribute("y",`${100+a*100}`),P.setAttribute("width",`${C}`),P.setAttribute("height","100"),_.appendChild(P),I.appendChild(_),F[y.name]={x:P.getAttribute("x"),y:P.getAttribute("y")}}),t.activities||t.gateways){const y=[...t.activities||[],...t.gateways||[]];let a=140,_=0;const P=[];t.sequences&&t.sequences.forEach(X=>{const U=y.find(z=>z.id===X.source),$=y.find(z=>z.id===X.target);U&&!P.includes(U)&&P.push(U),$&&!P.includes($)&&P.push($)}),P.forEach((X,U)=>{if(!X.role)return!1;let $=O[X.id]?O[X.id]-20:a+120,z=parseInt(F[X.role].y);U>0&&P[U-1].role!==X.role&&($=a+40),X.type==="ExclusiveGateway"&&($+=70,z+=15,_=$),U>0&&P[U-1].type==="ExclusiveGateway"&&($=_+100);const H=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNShape");H.setAttribute("id",`BPMNShape_${X.id}`),H.setAttribute("bpmnElement",X.id);const Y=u.createElementNS("http://www.omg.org/spec/DD/20100524/DC","dc:Bounds");Y.setAttribute("x",$),Y.setAttribute("y",z+10),X.type==="ExclusiveGateway"?(Y.setAttribute("width",50),Y.setAttribute("height",50)):(Y.setAttribute("width",100),Y.setAttribute("height",80)),H.appendChild(Y),I.appendChild(H),b[X.id]={x:$,y:z+10,width:parseInt(Y.getAttribute("width")),height:parseInt(Y.getAttribute("height"))},F[X.role].x=$,a=$+120})}return t.events&&t.events.forEach(y=>{let a,_;y.type=="StartEvent"?(a=160,_=parseInt(F[t.activities[0].role].y)+33):y.type=="EndEvent"?(a=O[y.id]?O[y.id]:C+120,_=parseInt(F[t.activities[t.activities.length-1].role].y)+33):(a=200,_=200);const P=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNShape");P.setAttribute("id",`Shape_${y.id}`),P.setAttribute("bpmnElement",y.id);const X=u.createElementNS("http://www.omg.org/spec/DD/20100524/DC","dc:Bounds");X.setAttribute("x",a),X.setAttribute("y",_),X.setAttribute("width","34"),X.setAttribute("height","34"),P.appendChild(X);const U=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNLabel"),$=u.createElementNS("http://www.omg.org/spec/DD/20100524/DC","dc:Bounds");$.setAttribute("x",a-15),$.setAttribute("y",_+40),$.setAttribute("width","64"),$.setAttribute("height","14"),U.appendChild($),P.appendChild(U),I.appendChild(P),b[y.id]={x:a,y:_,width:34,height:34}}),t.sequences&&t.sequences.forEach(y=>{if(!b[y.source]||!b[y.target])return!1;const a=u.createElementNS("http://www.omg.org/spec/BPMN/20100524/DI","bpmndi:BPMNEdge");a.setAttribute("id",`BPMNEdge_${y.source}_${y.target}`),a.setAttribute("bpmnElement","SequenceFlow_"+y.source+"_"+y.target);let _,P,X,U;_=parseInt(b[y.source].x)+parseInt(b[y.source].width),P=parseInt(b[y.source].y)+parseInt(b[y.source].height)/2,X=parseInt(b[y.target].x),U=parseInt(b[y.target].y)+parseInt(b[y.target].height)/2,y.source.includes("gateway")&&y.target.includes("leave")&&(X=parseInt(b[y.target].x)+parseInt(b[y.target].width)/2,U=parseInt(b[y.target].y)-20);const $=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");if($.setAttribute("x",_),$.setAttribute("y",P),a.appendChild($),P===U){const z=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");z.setAttribute("x",X),z.setAttribute("y",U),a.appendChild(z)}else{const z=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");z.setAttribute("x",_+25),z.setAttribute("y",P),a.appendChild(z);const H=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");H.setAttribute("x",_+25),H.setAttribute("y",U),a.appendChild(H);const Y=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");Y.setAttribute("x",X),Y.setAttribute("y",U),a.appendChild(Y);const fe=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");fe.setAttribute("x",X),fe.setAttribute("y",U),a.appendChild(fe)}if(y.source.includes("gateway")&&y.target.includes("leave")){const z=u.createElementNS("http://www.omg.org/spec/DD/20100524/DI","di:waypoint");z.setAttribute("x",X),z.setAttribute("y",U+20),a.appendChild(z)}I.appendChild(a)}),new XMLSerializer().serializeToString(u)},saveDefinition(t){var s=this;s.$try({context:s,action:async()=>{s.loading=!0,await s.setDefinitionInfo(t);const h=Yt();let u=h.getModeler,m,e=0;const r=3,i=1e3;async function f(){try{const E=u.getDefinitions();return E&&(E.name=t.name||"Default Name"),m=await u.saveXML({format:!0,preamble:!0}),!0}catch(E){return console.error("XML    :",E),!1}}for(;e<r&&!await f();)if(e++,e<r)console.log(`XML   ... (${e}/${r})`),await new Promise(E=>setTimeout(E,i));else throw console.error("   . XML  ."),new Error("XML  ");let N;if(m&&m.xml&&window.$mode=="ProcessGPT"){if(window.$jms)N=await s.convertXMLToJSON(m.xml);else{let E=0;for(;E<10&&(u=h.getModeler,m=await u.saveXML({format:!0,preamble:!0}),N=await s.convertXMLToJSON(m.xml),!(N!=null&&(N.data&&N.data.length>0||N.roles&&N.roles.length>0||N.events&&N.events.length>0||N.components&&N.components.length>0||N.gateways&&N.gateways.length>0||N.sequences&&N.sequences.length>0)));)E++,await new Promise(x=>setTimeout(x,500))}s.processDefinition&&(s.processDefinition.roles&&(N.roles=N.roles.map(E=>{const x=s.processDefinition.roles.find(C=>C.name===E.name);return x&&(E.resolutionRule=x.resolutionRule),E})),s.processDefinition.activities&&(N.activities=N.activities.map(E=>{const x=s.processDefinition.activities.find(C=>C.id===E.id);return x&&(E.instruction=x.instruction,E.checkpoints=x.checkpoints),E}))),s.processDefinition=N,t.name&&t.name!=""&&(s.processDefinition.processDefinitionName=t.name),t.definition=s.processDefinition}await s.saveModel(t,m.xml),s.bpmn=m.xml;let D={bpmn:s.bpmn,def:s.processDefinition};this.$emit("modelCreated",D),s.disableChat=!0,s.isViewMode=!0,s.lock=!0,s.definitionChangeCount++,s.loading=!1,await s.toggleVersionDialog(!1)},onFail:h=>{console.log(h),s.loading=!1,s.isChanged=!0},successMsg:this.$t("successMsg.save")})},async convertXMLToJSON(t){try{let i=function(l){return Array.isArray(l)?l:l?[l]:[]};if(!t)return{};t=t.replace(/\$type/g,"_type");const h=await new Ie.Parser({explicitArray:!1,mergeAttrs:!0}).parseStringPromise(t);let u="Unknown",m=null,e=null,r=null;this.fullPath?u=this.fullPath:u=this.$route.params.id,u=="chat"&&(u=this.processDefinition.processDefinitionId);let f=h["bpmn:definitions"]&&h["bpmn:definitions"]["bpmn:process"]?h["bpmn:definitions"]["bpmn:process"]:{};f instanceof Array||(f=[f]);let N=null,D=[],E=[],x=[],C=[],O=[],F=null;const B=h["bpmn:definitions"]&&h["bpmn:definitions"]["bpmn:collaboration"]&&h["bpmn:definitions"]["bpmn:collaboration"]["bpmn:participant"]?h["bpmn:definitions"]["bpmn:collaboration"]["bpmn:participant"]:{};let I=[];for(let l of f){Object.keys(l).forEach(y=>{if(y.includes("Event")){let a=l[y];a instanceof Array?a=a.map(_=>({..._,type:y.replace("bpmn:",""),process:l.id})):a={...a,type:y.replace("bpmn:",""),process:l.id},D=D.concat(a)}else if(y.includes("Task")){let a=l[y];a instanceof Array?a=a.map(_=>({..._,type:y.replace("bpmn:",""),process:l.id})):a={...a,type:y.replace("bpmn:",""),process:l.id},x=x.concat(a)}else if(y.includes("Gateway")){let a=l[y];a instanceof Array?a=a.map(_=>({..._,type:y.replace("bpmn:",""),process:l.id})):a={...a,type:y.replace("bpmn:",""),process:l.id},O=O.concat(a)}});let d=i(l["bpmn:laneSet"]?l["bpmn:laneSet"]["bpmn:lane"]:[]);d=d.map(y=>({...y,process:l.id})),E=E.concat(d);let b=i(l["bpmn:sequenceFlow"]||[]);C=C.concat(b);let S=l["bpmn:extensionElements"]&&l["bpmn:extensionElements"]["uengine:properties"]&&l["bpmn:extensionElements"]["uengine:properties"]["uengine:variable"]?(Array.isArray(l["bpmn:extensionElements"]["uengine:properties"]["uengine:variable"])?l["bpmn:extensionElements"]["uengine:properties"]["uengine:variable"]:[l["bpmn:extensionElements"]["uengine:properties"]["uengine:variable"]]).map(y=>({name:y.name,description:y.name+" description",type:y.type})):[];I=I.concat(S);let L=l["bpmn:extensionElements"]&&l["bpmn:extensionElements"]["uengine:properties"]&&l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"]?JSON.parse(l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"]):null;L&&(F=L.instanceNamePattern?L.instanceNamePattern:null,m=L.definitionName?L.definitionName:null,e=L.version?L.version:null,r=L.shortDescription?L.shortDescription:null)}return N={processDefinitionName:m,processDefinitionId:u,version:e,shortDescription:r,description:"process.description",data:I,roles:E.map(l=>({name:l.name,resolutionRule:l.name==="applicant"?"initiator":"system",process:l.process})),events:[...D.map(l=>{let d=l["bpmn:extensionElements"]&&l["bpmn:extensionElements"]["uengine:properties"],b=Object.keys(l).filter(S=>S.includes("Definition"));return{name:l.name,id:l.id,type:l.type,description:"start event",role:E[0]?E[0].name:"Unknown",process:l.process,definitionType:b?b[0]:null,properties:d?l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"]:"{}"}})],activities:[...x.map(l=>{try{let d={};if(d.name=l.name,d.id=l.id,d.type=l.type,d.description=`${l.name} description`,d.instruction=`${l.name} instruction`,d.process=l.process,d.role=E.find(L=>(Array.isArray(L["bpmn:flowNodeRef"])?L["bpmn:flowNodeRef"]:[L["bpmn:flowNodeRef"]]).includes(l.id))?E.find(L=>(Array.isArray(L["bpmn:flowNodeRef"])?L["bpmn:flowNodeRef"]:[L["bpmn:flowNodeRef"]]).includes(l.id)).name:"Unknown",l["bpmn:extensionElements"]&&l["bpmn:extensionElements"]["uengine:properties"]){let L=JSON.parse(l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"]);d.inputData=L&&L.parameters?L.parameters.filter(y=>y.direction==="IN").map(y=>y.variable.name):[],d.outputData=L&&L.parameters?L.parameters.filter(y=>y.direction==="OUT").map(y=>y.variable.name):[],d.properties=l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"],d.duration=l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"].duration?l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"].duration:5}else d.inputData=[],d.outputData=[];const S=JSON.parse(l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"]);return S&&S.variableForHtmlFormContext&&S.variableForHtmlFormContext.name?d.tool="formHandler:"+S.variableForHtmlFormContext.name:window.$mode=="ProcessGPT"?d.tool="formHandler:"+u+"_"+d.id+"_form":d.tool="",d}catch(d){console.log(d)}})],gateways:[...O.map(l=>({id:l.id||"Gateway",name:l.name||"Gateway",type:l.type,description:l.name+" description",process:l.process,role:E.find(d=>(Array.isArray(d["bpmn:flowNodeRef"])?d["bpmn:flowNodeRef"]:[d["bpmn:flowNodeRef"]]).includes(l.id))?E.find(d=>(Array.isArray(d["bpmn:flowNodeRef"])?d["bpmn:flowNodeRef"]:[d["bpmn:flowNodeRef"]]).includes(l.id)).name:"Unknown",condition:l["bpmn:extensionElements"]&&l["bpmn:extensionElements"]["uengine:properties"]&&JSON.parse(l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"]).condition||"",properties:l["bpmn:extensionElements"]&&l["bpmn:extensionElements"]["uengine:properties"]&&l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"]?l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"]:"{}"}))],sequences:C.map(l=>{let d=null;return window.$mode=="ProcessGPT"?d=l.condition||"":d=l["bpmn:extensionElements"]&&l["bpmn:extensionElements"]["uengine:properties"]?JSON.parse(l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"]).condition||l.condition:"",{id:l.id,source:l.sourceRef,target:l.targetRef,condition:d,properties:l["bpmn:extensionElements"]&&l["bpmn:extensionElements"]["uengine:properties"]&&l["bpmn:extensionElements"]["uengine:properties"]["uengine:json"]||"{}"}}),participants:B,instanceNamePattern:F},N}catch(s){throw console.error("Error parsing XML:",s),s}},async setDefinitionInfo(t){return new Promise(function(s){let u=Yt().getModeler;const m=u.getDefinitions();let e;try{e=u.get("bpmnFactory")}catch(D){console.warn("bpmnFactory not available:",D);return}const r=m.rootElements.find(D=>D.$type==="bpmn:Process");if(!r){console.error("bpmn:Process element not found");return}let i=r.extensionElements;i||(i=e.create("bpmn:ExtensionElements"),r.extensionElements=i);let f;i.values&&(f=i.values.find(D=>D.$type==="uengine:Properties")),f||(f=e.create("uengine:Properties"),i.get("values").push(f));let N;f.json?N=JSON.parse(f.json):N={},N.definitionName=t.name,N.version=t.version,N.shortDescription={text:t.message},f.json=JSON.stringify(N),s()})},async saveModel(t,s){var h=this;h.$try({context:h,action:async()=>{if(window.$mode=="uEngine")console.log(t),await Ce.putRawDefinition(s,t.proc_def_id,t),t.release&&await Ce.releaseVersion(t.releaseName);else{if(h.processDefinition||(h.processDefinition={}),h.processDefinition.processDefinitionId||(h.processDefinition.processDefinitionId=null),h.processDefinition.processDefinitionName||(h.processDefinition.processDefinitionName=null),h.processDefinition.processDefinitionId=t.proc_def_id?t.proc_def_id:prompt("please give a ID for the process definition"),!h.processDefinition.processDefinitionName&&t.name?h.processDefinition.processDefinitionName=t.name:!h.processDefinition.processDefinitionName&&!t.name&&(h.processDefinition.processDefinitionName=prompt("please give a name for the process definition")),h.projectName=h.processDefinition.processDefinitionName,!h.processDefinition.processDefinitionId||!h.processDefinition.processDefinitionName)throw new Error("processDefinitionId or processDefinitionName is missing");await Ce.putRawDefinition(s,t.proc_def_id,t)}if(h.$route.fullPath=="/definitions/chat"&&h.$router.push(`/definitions/${t.proc_def_id}`),h.EventBus.emit("definitions-updated"),t.skipSaveProcMap||await Ce.putProcessDefinitionMap(h.processDefinitionMap),h.$route.query&&h.$route.query.modeling){let u;h.$route.query.id?u=await Ce.getRawDefinition(h.$route.query.id.replace(".bpmn",""),{type:"bpmn"}):u=await Ce.getRawDefinition(t.proc_def_id,{type:"bpmn"}),u&&window.close()}},catch:u=>{console.log(u)}})}}};const kr=At.createBackend(),Xn={name:"ProcessDefinitionVersionManager",mixins:[Rn],components:{Icon:rn,ProcessDefinition:an},props:{open:Boolean,process:Object,type:String},data:()=>({basePath:"proc_def_arcv",isOpen:!1,showXML:!1,key:0,currentIndex:0,lists:[],loading:!1,currentInfo:null}),computed:{beforeXML(){return this.lists.length>0&&this.lists[this.currentIndex-1]?this.lists[this.currentIndex-1].xml:null},currentXML(){return this.lists.length>0&&this.lists[this.currentIndex]?this.lists[this.currentIndex].xml:null},currentVersionName(){return this.currentInfo?this.currentInfo.processDefinitionName:null},currentVersion(){return this.currentInfo?this.currentInfo.version:null},currentVersionMessage(){return this.currentInfo&&this.currentInfo.shortDescription?this.currentInfo.shortDescription.text:null}},watch:{open:function(t){t?(this.currentIndex=0,this.load()):this.isOpen=!1}},created(){},methods:{async load(){var t=this;t.loading=!0;let s=await kr.getDefinitionVersions(t.process.processDefinitionId,{key:"version, message",sort:"asc",orderBy:"timeStamp",type:t.type});t.lists=s.map(h=>({...h,xml:null})),t.lists[0].xml=await t.loadXMLOfVer(t.lists[0].version),t.isOpen=!0,t.loading=!1},async handleBeforeChange(t){var s=this;s.loading=!0,s.lists[t]&&(s.lists[t].xml||(s.lists[t].xml=await s.loadXMLOfVer(s.lists[t].version)),s.loading=!1,s.key++)},changeXML(){this.$emit("changeXML",{id:this.process.processDefinitionId,name:this.currentVersionName,xml:this.currentXML})},downloadXML(){var t=this;if(t.currentXML){const s=new Blob([t.currentXML],{type:"application/xml"}),h=document.createElement("a");h.href=URL.createObjectURL(s),h.download=`${t.currentVersionName}-${t.currentVersion}.xml`,document.body.appendChild(h),h.click(),document.body.removeChild(h)}else alert("  XML  .")},async loadXMLOfVer(t){var s=this;let h=await kr.getDefinitionVersions(s.process.processDefinitionId,{key:"snapshot",sort:"asc",size:1,type:s.type,match:{version:t}}),u=null;return h&&(u=h[0].snapshot,s.currentInfo=await s.convertXMLToJSON(u)),u},copyToClipboard(t){if(navigator.clipboard)navigator.clipboard.writeText(t).then(()=>{alert(" .")},s=>{console.error("  :",s)});else{const s=document.createElement("textarea");s.value=t,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),alert(" .")}},close(){this.$emit("close",!1)}}},kn={class:"text-h5"},Un={key:1,class:"text-body-1 mt-1"},Vn=ve("mdi-close"),jn={class:"d-flex px-5"},qn={class:"mx-2"},$n=ve("  "),Gn=ve("    "),Wn={key:0,style:{height:"100%","overflow-y":"scroll"}},Yn={class:"diff-titles"},zn={key:0,class:"diff-title"},Hn=ve("Previous XML "),Jn=ve("mdi-content-copy"),Kn={class:"diff-title current-xml-title"},Qn=ve("Current XML "),Zn=ve("mdi-content-copy"),ei={key:0},ti={key:1,style:{"margin-top":"15px"}},ri={class:"xml"},ni={key:1,style:{height:"100%"}};function ii(t,s,h,u,m,e){const r=_e("vuediff"),i=_e("process-definition");return te(),xe($r,{modelValue:t.isOpen,"onUpdate:modelValue":s[4]||(s[4]=f=>t.isOpen=f),"max-width":"100%",style:{height:"-webkit-fill-available"},persistent:""},{default:J(()=>[W(Ur,{flat:""},{default:J(()=>[W(Vr,{class:"d-flex"},{default:J(()=>[ae("div",null,[ae("h5",kn,"  ["+pe(e.currentVersionName)+" ("+pe(e.currentVersion)+")]",1),t.loading?(te(),xe(Gr,{key:0,color:"primary",size:25,indeterminate:"",style:{"margin-left":"5px"}})):we("",!0),e.currentVersionMessage?(te(),ce("div",Un," : "+pe(e.currentVersionMessage),1)):we("",!0)]),W(he,{icon:"",class:"ml-auto",variant:"text",onClick:e.close,density:"compact"},{default:J(()=>[W(Ve,null,{default:J(()=>[Vn]),_:1})]),_:1},8,["onClick"])]),_:1}),ae("div",jn,[ae("div",qn,[W(qr,{modelValue:t.showXML,"onUpdate:modelValue":s[0]||(s[0]=f=>t.showXML=f),label:t.showXML?"XML":"BPMN",density:"compact",color:"primary","hide-details":""},null,8,["modelValue","label"])]),W(he,{onClick:e.downloadXML,variant:"text",height:"40",class:"mx-2"},{default:J(()=>[$n]),_:1},8,["onClick"]),W(he,{onClick:e.changeXML,variant:"text",color:"primary",disabled:t.loading,height:"40"},{default:J(()=>[Gn]),_:1},8,["onClick","disabled"])]),W(jr,{style:{height:"500px"}},{default:J(()=>[t.showXML?(te(),ce("div",Wn,[ae("div",Yn,[e.currentXML&&e.beforeXML?(te(),ce("div",zn,[Hn,W(he,{size:"x-small",onClick:s[1]||(s[1]=f=>e.copyToClipboard(e.beforeXML))},{default:J(()=>[W(Ve,{"x-small":""},{default:J(()=>[Jn]),_:1})]),_:1})])):we("",!0),ae("div",Kn,[Qn,W(he,{size:"x-small",onClick:s[2]||(s[2]=f=>e.copyToClipboard(e.currentXML))},{default:J(()=>[W(Ve,{"x-small":""},{default:J(()=>[Zn]),_:1})]),_:1})])]),e.currentXML&&e.beforeXML?(te(),ce("div",ei,[W(r,{prev:e.beforeXML,current:e.currentXML,mode:"split",theme:"light",language:"xml"},null,8,["prev","current"])])):(te(),ce("div",ti,[ae("pre",null,[ae("code",ri,pe(e.currentXML),1)])]))])):(te(),ce("div",ni,[(te(),xe(i,{class:"process-definition-resize",bpmn:e.currentXML,isViewMode:!0,key:t.key},null,8,["bpmn"]))]))]),_:1}),W(nn,null,{default:J(()=>[W(ln,{modelValue:t.currentIndex,"onUpdate:modelValue":s[3]||(s[3]=f=>t.currentIndex=f),step:"1",min:"0",max:t.lists.length-1,"show-ticks":"always","tick-size":"4",onEnd:e.handleBeforeChange,"hide-details":!0,style:{padding:"0","margin-right":"20px","margin-left":"30px"}},null,8,["modelValue","max","onEnd"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const vi=Ct(Xn,[["render",ii],["__scopeId","data-v-b5cc0ea1"]]),oi={props:{modelValue:String,bpmn:String,fullPath:String,lock:Boolean,editUser:String,userInfo:Object,isXmlMode:Boolean},data(){return{processName:""}},created(){this.processName=this.modelValue},watch:{modelValue(t){this.processName=t},processName(t){this.$emit("update:modelValue",t)}},computed:{modelValueStyle(){return!!(this.modelValue&&this.modelValue!==""&&!this.lock&&this.editUser!=""&&this.editUser==this.userInfo.name)}},methods:{executeProcess(){this.$emit("executeProcess")},executeSimulate(){console.log("simulate"),this.$emit("executeSimulate")},triggerFileInput(){this.$refs.fileInput.click()},handleFileChange(t){this.$emit("handleFileChange",t)},toggleLock(){this.$emit("toggleLock")},toggleVerMangerDialog(){this.$emit("toggleVerMangerDialog",!0)},beforeDelete(){this.$emit("beforeDelete")},showXmlMode(){this.$emit("showXmlMode")}}},si={style:{position:"sticky",top:"0px","z-index":"1","background-color":"white"}},ai={key:0,class:"d-flex gap-2 align-center",style:{"max-width":"80%"}},ui={key:1,class:"text-h5 mb-n1"},ci={class:"custom-tools"},li={class:"mr-4 d-flex"},pi={key:0},fi={key:0},hi={key:1},di={key:1},mi={class:"mr-4 d-flex"},gi={class:"mr-4 d-flex"};function yi(t,s,h,u,m,e){const r=_e("TrashIcon"),i=_e("Icons"),f=_e("HistoryIcon");return te(),ce("div",null,[ae("div",si,[ae("div",{class:"align-right gap-3 justify-space-between",style:zt(e.modelValueStyle?"padding: 12px 16px 2px 16px;":"padding: 9px 16px 9px 16px;")},[W(Xe,{class:"ma-0 pa-0"},{default:J(()=>[h.modelValue&&h.modelValue!==""?(te(),ce("div",ai,[!h.lock&&h.editUser!=""&&h.editUser==h.userInfo.name?(te(),xe(Oe,{key:0,modelValue:m.processName,"onUpdate:modelValue":s[0]||(s[0]=N=>m.processName=N),label:" ",variant:"underlined","hide-details":"",class:"pa-0 ma-0",style:{"min-width":"150px",width:"150px"}},null,8,["modelValue"])):(te(),xe(Ee,{key:1,location:"bottom"},{activator:J(({props:N})=>[ae("h5",be(N,{class:"text-h5 mb-n1 process-title-truncate"}),pe(h.modelValue),17)]),default:J(()=>[ae("span",null,pe(h.modelValue),1)]),_:1}))])):(te(),ce("h5",ui,pe(t.$t("processDefinition.title")),1)),W(It),W(Ee,{location:"bottom"},{activator:J(({props:N})=>[W(he,be(N,{icon:"",variant:"text",type:"file",class:"text-medium-emphasis",density:"comfortable",onClick:e.beforeDelete}),{default:J(()=>[W(r,{size:"24",style:{color:"#FB977D"}})]),_:2},1040,["onClick"])]),default:J(()=>[ae("span",null,pe(t.$t("processDefinition.deleteProcess")),1)]),_:1})]),_:1}),ae("div",ci,[W(Xe,{class:"ma-0 pa-0 pt-3",style:zt(e.modelValueStyle?"margin: 5px 0 5.5px 0;":"margin-top: 12px;")},{default:J(()=>[ae("div",li,[W(Ee,{location:"bottom"},{activator:J(({props:N})=>[W(he,be(N,{icon:"",variant:"text",type:"file",class:"text-medium-emphasis",density:"comfortable",onClick:e.triggerFileInput}),{default:J(()=>[W(i,{icon:"upload"})]),_:2},1040,["onClick"])]),default:J(()=>[ae("span",null,pe(t.$t("chat.import")),1)]),_:1}),ae("input",{type:"file",ref:"fileInput",onChange:s[1]||(s[1]=(...N)=>e.handleFileChange&&e.handleFileChange(...N)),accept:".bpmn ,.jsonold",style:{display:"none"}},null,544),h.bpmn||h.fullPath!="chat"?(te(),ce("div",pi,[W(Ee,{location:"bottom"},{activator:J(({props:N})=>[W(he,be(N,{icon:"",variant:"text",type:"file",class:"text-medium-emphasis",density:"comfortable",onClick:e.toggleLock}),{default:J(()=>[W(i,{icon:h.lock?"lock":"unLock"},null,8,["icon"])]),_:2},1040,["onClick"])]),default:J(()=>[h.lock?(te(),ce("span",fi,pe(h.editUser!=""&&h.editUser!=h.userInfo.name?` ${h.editUser}   .    ${h.editUser}      .  ?`:t.$t("chat.unlock")),1)):(te(),ce("span",hi,pe(t.$t("chat.lock")),1))]),_:1})])):(te(),ce("div",di,[W(Ee,{location:"bottom"},{activator:J(({props:N})=>[W(he,be(N,{icon:"",variant:"text",type:"file",class:"text-medium-emphasis",density:"comfortable",onClick:e.toggleLock}),{default:J(()=>[W(i,{icon:"save"})]),_:2},1040,["onClick"])]),default:J(()=>[ae("span",null,pe(t.$t("chat.processDefinitionSave")),1)]),_:1})]))]),ae("div",mi,[h.bpmn&&h.fullPath!="chat"?(te(),xe(Ee,{key:0,location:"bottom"},{activator:J(({props:N})=>[W(he,be(N,{icon:"",variant:"text",type:"file",class:"text-medium-emphasis",density:"comfortable",onClick:e.toggleVerMangerDialog}),{default:J(()=>[W(f,{size:"24"})]),_:2},1040,["onClick"])]),default:J(()=>[ae("span",null,pe(t.$t("chat.history")),1)]),_:1})):we("",!0),W(Ee,{location:"bottom"},{activator:J(({props:N})=>[W(he,be(N,{icon:"",variant:"text",type:"file",class:"text-medium-emphasis",density:"comfortable",onClick:e.showXmlMode}),{default:J(()=>[W(i,{icon:"code-xml",color:h.isXmlMode?"#1976D2":"#666666"},null,8,["color"])]),_:2},1040,["onClick"])]),default:J(()=>[ae("span",null,pe(h.isXmlMode?t.$t("processDefinition.showModeling"):t.$t("processDefinition.showXML")),1)]),_:1})]),ae("div",gi,[W(Ee,{location:"bottom",text:t.$t("processDefinition.simulate")},{activator:J(({props:N})=>[W(he,be(N,{onClick:e.executeSimulate,icon:"",variant:"text",class:"text-medium-emphasis",density:"comfortable"}),{default:J(()=>[W(i,{icon:"bug-play"})]),_:2},1040,["onClick"])]),_:1},8,["text"]),W(Ee,{location:"bottom",text:t.$t("processDefinition.execution")},{activator:J(({props:N})=>[W(he,be(N,{onClick:e.executeProcess,icon:"",variant:"text",class:"text-medium-emphasis",density:"comfortable"}),{default:J(()=>[W(i,{icon:"play"})]),_:2},1040,["onClick"])]),_:1},8,["text"])])]),_:1},8,["style"])])],4),W(on,{class:"ma-0"})])])}const Ti=Ct(oi,[["render",yi]]),Ii={data:()=>({currentSource:"start_event",currentRole:"Initiator",loopSource:null,loopChilds:{},sequenceConditions:{}}),methods:{convertOldJson(t){let s=this;s.currentSource="start_event",s.loopSource=null,s.loopChilds={},s.sequenceConditions={};let h={megaProcessId:"test1",majorProcessId:"test1",processDefinitionName:"test",processDefinitionId:"test",description:"test"};const u=t;h.megaProcessId=u.name.text,h.majorProcessId=u.name.text,h.processDefinitionName=u.name.text,h.processDefinitionId=u.serviceDefinitions[0].name,h.description=u.description.text,h.data=[],h.roles=[],h.sequences=[],h.components=[],s.parseData(u.processVariables[1],h),u.roles[1].forEach(e=>{h.roles.push({name:e.name,resolutionRule:e.name})}),h.components.push({componentType:"Event",id:s.currentSource,name:"Start Event",role:"Initiator",source:null,type:"StartEvent",description:" "}),s.parseComponents(u.childActivities[1],h);const m=h.components[h.components.length-1];return h.components.push({componentType:"Event",id:"end_event",name:"End Event",role:"Initiator",source:m.id,type:"EndEvent",description:" "}),h.sequences.push({id:s.currentSource+"_end_event",source:s.currentSource,target:"end_event"}),h},parseData(t,s){t.forEach(h=>{let u="Text";h.type.indexOf("Number")!=-1&&(u="Number"),s.data.push({name:h.name,description:h.name,type:u})})},getId(t){const s=t._type;let h="";return s.indexOf("HumanActivity")!=-1?h="activity_"+t.tracingTag:h="gateway_"+t.tracingTag,h},parseComponents(t,s,h=null){const u=this;let m="";t.forEach((e,r)=>{const i=e._type;let f=[];if(i.indexOf("HumanActivity")!=-1){const D=e.name.text,E=e.role?e.role.name:"",x=e.description.text?e.description.text:"";m=u.getId(e);const C=e.instruction;e.previousActivities&&(u.currentSource=u.getId(e.previousActivities[1][0])),e.parentId&&(u.currentSource=e.parentId),u.loopSource&&(u.currentSource=""+u.loopSource,u.loopSource=null),h&&(u.loopChilds[h]||(u.loopChilds[h]=[]),u.loopChilds[h].push(e)),s.sequences.push({id:u.currentSource+"_"+m,source:u.currentSource,target:m}),s.components.push({componentType:"Activity",id:m,name:D,type:"UserActivity",source:u.currentSource,description:x,instruction:C,role:E,inputData:[],outputData:[],checkpoints:[]}),u.currentSource=m}else if(i.indexOf("LoopActivity")!=-1)f.push(e);else if(i.indexOf("SwitchActivity")!=-1){const D=e.name.text,x=e.previousActivities[1][0].role.name;m=u.getId(e);const C=e.description.text?e.description.text:"";e.previousActivities&&(u.currentSource=u.getId(e.previousActivities[1][0])),e.parentId&&(u.currentSource=e.parentId),s.sequences.push({id:u.currentSource+"_"+m,source:u.currentSource,target:m}),s.components.push({componentType:"Gateway",id:m,name:D,role:x,source:u.currentSource,type:"ExclusiveGateway",description:C})}else if(i.indexOf("AllActivity")!=-1){const D=e.name.text,x=e.previousActivities[1][0].role.name;m=u.getId(e);const C=e.description.text?e.description.text:"";e.previousActivities&&(u.currentSource=u.getId(e.previousActivities[1][0])),e.parentId&&(u.currentSource=e.parentId),s.sequences.push({id:u.currentSource+"_"+m,source:u.currentSource,target:m}),s.components.push({componentType:"Gateway",id:m,name:D,role:x,source:u.currentSource,type:"ParallelGateway",description:C})}e.childActivities&&(e.childActivities[1].forEach(D=>{D.parentId=m}),i.indexOf("LoopActivity")!=-1&&(h=u.getId(e)),u.parseComponents(e.childActivities[1],s,h)),f.slice().reverse().forEach(D=>{const E=D.name.text,C=D.previousActivities[1][0].role.name;m=u.getId(D);const O=D.description.text?D.description.text:"";let F=u.currentSource;D.childActivities&&D.childActivities[1].forEach(B=>{let I={id:m+"_"+u.getId(B),source:m,target:u.getId(B)};if(D.loopingCondition&&D.loopingCondition.conditions[1]){const T=D.loopingCondition.conditions[1];I.condition=T[0].conditions[1][0]}s.sequences.push(I)}),u.loopChilds[m]&&u.loopChilds[m].forEach(B=>{s.sequences.push({id:u.getId(B)+"_"+m,source:u.getId(B),target:m})}),s.components.push({componentType:"Gateway",id:m,name:E,role:C,source:F,type:"ExclusiveGateway",description:O}),u.loopSource=m})})}}};class Ai extends sn{constructor(s,h){super(s,h);const u=JSON.stringify(s.externalSystems),m=this.getJsonStructure();this.previousMessages=[{role:"system",content:`
                                 BPM     .

            -  :                .

            -   :    Mega Process, Major Process, Sub Process      .    Sub Process  ,     Mega, Major Process              Mega, Major Process    .   Mega, Major Process    Mega, Major Process     .

              :
            {{     }}
            
              :
            {{    }}
            
                 valid  json  . markdown , three backticks  .   :
            checkPoints   Array .
            activity  role roles   .
               JSON    .

              :
            "sequences" and "events" are items that must be created no matter what.
            In "events", "Start Event" and "End Event" must be created.
            "sequences" must include a "Start Event" and an "End Event".
            The "source" of the first object in the "sequences" must be the id of the start event, and the "target" of the last object must be the id of the end event.
            Additionally, when creating each "activity", "gateway", and "event", each "id" must be created with an id that exists in "sequences", and objects with that id must not only exist in "sequences". must be created.
            
            For these four cases, you must to create a "gateway" to handle them.
            1. When there are conditions
            2. When the "source" and "target" of the "sequence" need to be created identically.
            3. When returning to the previous task or branching processing is required according to certain conditions.
            4. When a specific task must be repeated based on conditions.

            Even if the creation result is null, "", or [], an empty value must be generated by mapping it to the corresponding key according to the provided json format.
            When creating a "sequences", it is recommended to create "conditions" if possible.

            data        


                :
            isHorizontal  (true) (false)      
                 
                  
            startEvent   
            endEvent    
            components source        id 
                       
            events, activities, gateways   
             event, activitie, gateway  roles      
            target source       
                  
                events, activities, gateways  
            roles widths components   x 50 
             roles width 
            roles height roles  component roleName role name      y  40,   y  80
             roles    
            \`\`\`
            ${m}             
            \`\`\`

            -  :           :

                :
               1.  {modifications: [..]}    .
               2.  , ,      .
               3.  , ,          ,         .
               4.         .
               5.       id beforeActivity  .
               6.   ,  "role"    "roles"   role   . "roles"    role    .
               7.      .
               8.   ,             .
               9.        
               10.  JSON    .
               11.   ,      Sequence  .
               12. Sequence replace . add  delete .
               13. id    
               14.      isHorizontal false .
            \`\`\`
              { 
                "modifications": [
                  
                  {
                    "action": "replace" | "add" | "delete",
                    "targetJsonPath": "$.activities[?(@.id=='request_vacation')]", // action  add   "$.activities"  . e.g. "$.sequences", action  add    "$.activities[?(@.id=='request_vacation')]"   ,  Path   ("activities", "sequences" ...)  "$.activities"  ,      ("[?(@.id=='request_vacation')]")    .  // e.g. "$.sequences[?(@.source=='leave_request_activity' && @.target=='leave_approval_activity')].condition"
                    "value": {...}, //delete     Sequence id {"id": "  Sequence id"}  , replace   value       value 
                    "beforeActivity": "" //     Activity   Activity id
                  }   
                ]
              }
            \`\`\`

            -   :      API      .    API   .
            
              :
            \`\`\`
            ${u}
            \`\`\`

                Element ServiceTask  .
            ServiceTask   .

            \`\`\`
            {
                "id": "event_id",
                "name": "event name",
                "componentType": "ServiceTask",
                "description": " ,     ",
                "trigger": "   (if applicable)",
                "participants": "  Participant  ",
                "spec": {
                    "systemName": "  ",
                    "method": "   Methods Type   .",
                    "inputPayloadTemplate": {
                        "key": "value"
                    },
                    "uriTemplate": "  API  "
                }
            }
            \`\`\`

            -  :   .          
                 json format   
            
               :
            
            - :     
            -  :       .
            - BPM:   Business Process Management       .
`}]}createPrompt(){return this.client.newMessage}setProcessDefinitionMap(s){this.previousMessages[0].content=this.previousMessages[0].content.replace("{{     }}",JSON.stringify(s))}setProcessDefinition(s){this.previousMessages[0].content=this.previousMessages[0].content.replace("{{    }}",JSON.stringify(s))}getJsonStructure(){return window.$mode==="uEngine"?`
          {
              "megaProcessId": "  Mega Process ",
              "majorProcessId": "  Major Process ",
              "processDefinitionName": " ",
              "processDefinitionId": "String-based unique id of the process definition in Snake case English without spaces",
              "description": "   ",
              "isHorizontal": "true | false", 
              "data": [{
                 "name": "   ",
                 "description": "    ",
                 "type": "Text" | "Number" | "Date" | "Attachment" | "Form"
              }],
              "roles": [{
                 "name": "role name",
                 "resolutionRule": "how to find the actual user mapping for the role"
              }],
              "components" :
              [{
                  "componentType" :"Gateway",
                  "id": "gateway_id",//id  
                  "name": "gateway name",
                  "role": "role name", // You must use the name among the created "roles".,
                  "source": "components id", // 
                  "type": "ExclusiveGateway | ParallelGateway | InclusiveGateway | EventBasedGateway",
                  "description": "       "
                },
                {
                  "componentType" :"Activity",
                  "id": "String-based unique id of the activity not including space",//id  
                  "name": "activity name",
                  "type": "UserActivity" | "EMailActivity" | "ScriptActivity",
                  "source": "components id",  
                  "description": "description of activity",
                  "instruction": "instruction to user",
                  "role": "role name", // You must use the name among the created "roles".
                  "inputData": ["name of data for input"],
                  "outputData": ["name of data for output"],
                  "checkpoints":["checkpoint 1", "checkpoint 2"],
                  "duration": "5"
                 },
                 {
                  "componentType" :"Event",
                  "id": "event_id",//id  
                  "name": "event name",
                  "role": "role name", // You must use the name among the created "roles".,
                  "source": "components id",  ,
                  "type": "StartEvent | EndEvent | IntermediateCatchEvent | MessageEvent | TimerEvent | ErrorEvent | ConditionalEvent | SignalEvent | TerminationEvent | LinkEvent | CompensationEvent | MultipleEvent | ParallelEvent | EscalationEvent | CancelEvent",
                  "description": " ,     ",
                  "trigger": "   (if applicable)"
                }
              ],
              "sequences": [ 
                {
                    "source": "activity id of source activity or gateway id of source gateway", e.g. start_event_id, activity_id, gateway_id ...
                    "target": "activity id of target activity or gateway id of target gateway", e.g. end, activity_id, gateway_id ...
                    "condition": 
                    {
                      "key": "data name",
                      "condition" : " == | != | > | >= | < | <=",
                      "value": "  (    true | false      )"
                    }    "data"     condition  . "data"   condition   "data"  "name"  ." //      ,       .
                }
              ],
              "participants": [
                {
                    "name": "participant name",
                    "type": "Participant" | "ParticipantGroup",
                    "system": "system name",
                    "url": "api url",
                    "spec": ""

                }
              ]
            }
          `:`
          {
              "megaProcessId": "  Mega Process ",
              "majorProcessId": "  Major Process ",
              "processDefinitionName": " ",
              "processDefinitionId": "String-based unique id of the process definition in Snake case English without spaces",
              "description": "   ",
              "isHorizontal": "true | false", 
              "data": [{
                 "name": "   ",
                 "description": "    ",
                 "type": "Text" | "Number" | "Date" | "Attachment"
              }],
              "roles": [{
                 "name": "role name",
                 "resolutionRule": "how to find the actual user mapping for the role"
              }],
              "components" :
              [{
                  "componentType" :"Gateway",
                  "id": "gateway_id",//id  
                  "name": "gateway name",
                  "role": "role name", // You must use the name among the created "roles".,
                  "source": "components id", // 
                  "type": "ExclusiveGateway | ParallelGateway | InclusiveGateway | EventBasedGateway",
                  "description": "       "
                },
                {
                  "componentType" :"Activity",
                  "id": "String-based unique id of the activity not including space",//id  
                  "name": "activity name",
                  "type": "UserActivity" | "EMailActivity" | "ScriptActivity",
                  "source": "components id",  
                  "description": "description of activity",
                  "instruction": "instruction to user",
                  "role": "role name", // You must use the name among the created "roles".
                  "inputData": ["name of data for input"],
                  "outputData": ["name of data for output"],
                  "checkpoints":["checkpoint 1", "checkpoint 2"],
                  "duration": "5"
                 },
                 {
                  "componentType" :"Event",
                  "id": "event_id",//id  , start event  start_event, end event  end_event  
                  "name": "event name",
                  "role": "role name", // You must use the name among the created "roles". start event  end event    Activity  role  ,
                  "source": "components id",  ,
                  "type": "StartEvent | EndEvent | IntermediateCatchEvent | MessageEvent | TimerEvent | ErrorEvent | ConditionalEvent | SignalEvent | TerminationEvent | LinkEvent | CompensationEvent | MultipleEvent | ParallelEvent | EscalationEvent | CancelEvent",
                  "description": " ,     ",
                  "trigger": "   (if applicable)"
                }
              ],
              "sequences": [ 
                {
                    "source": "activity id of source activity or gateway id of source gateway", e.g. start_event_id, activity_id, gateway_id ...
                    "target": "activity id of target activity or gateway id of target gateway", e.g. end, activity_id, gateway_id ...
                    "condition": "Text-based condition based on user input" //       ,    
                }
              ],
              "participants": [
                {
                    "name": "participant name",
                    "type": "Participant" | "ParticipantGroup",
                    "system": "system name",
                    "url": "api url",
                    "spec": ""

                }
              ]
            }
          `}}export{Ai as P,Rn as _,Ii as a,xi as b,vi as c,Ti as d};
